<!DOCTYPE html>
<html lang="en">
<head>
  <meta name="generator" content="HTML Tidy for HTML5 for Linux version 5.8.0">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="../assets/usage.css">
  <title>Thumbnails -- ImageMagick Examples</title>
  <link rel="icon" href="../img_www/favicon.ico" type="image/x-icon">
  <link rel="shortcut" href="../img_www/favicon.ico" type="image/x-icon">
  <link rel="canonical" href="https://imagemagick.org/Usage/thumbnails/">
</head>
<body>
  <main class="container">
    <div class="magick-template">
      <div class="magick-header">
        <h1>ImageMagick Examples --<br>
        <img src="../img_www/space.gif" width="50" height="1"> Creating Thumbnails and Framing</h1>
        <div>
          <table border="0" cellspacing="0" width="100%">
            <tr valign="top">
              <td colspan="3">
                <a href="../"><img src="../img_www/granitesm_left.gif" border="0" width="15" height="15"> ImageMagick Examples Preface and Index</a>
              </td>
            </tr>
            <tr valign="top">
              <td>
                <dl>
                  <dt>
                    <a href="#storage"><img src="../img_www/granitesm_right.gif" border="0" width="15" height="15"> Thumbnail Storage</a>
                  </dt>
                  <dd>
                    <ul>
                      <li>
                        <a href="#formats">Image Format Choice</a>
                      </li>
                      <li>
                        <a href="#profiles">Profiles, and JPEG Images</a>
                      </li>
                    </ul>
                  </dd>
                  <dt>
                    <a href="#creation"><img src="../img_www/granitesm_right.gif" border="0" width="15" height="15"> General Thumbnail Creation</a>
                  </dt>
                  <dd>
                    <ul>
                      <li>
                        <a href="#height"><b>Thumbnails of Specific Height</b></a>
                      </li>
                      <li>
                        <a href="#fit">Resize Thumbnail to Fit</a>
                      </li>
                      <li>
                        <a href="#pad">Pad Out Thumbnail</a>
                      </li>
                      <li>
                        <a href="#cut">Cut the Thumbnail to Fit</a>
                      </li>
                      <li>
                        <a href="#areafit">Area Fit Thumbnail Size</a>
                      </li>
                      <li>
                        <a href="#fit_summery"><b>Fit to a Given Space Summary</b></a>
                      </li>
                      <li>
                        <a href="#square">Square Padding or Cropping</a>
                      </li>
                      <li>
                        <a href="#manual">Manual Cropping</a>
                      </li>
                      <li>
                        <a href="#html">HTML thumbnail pages</a>
                      </li>
                      <li>
                        <a href="#favicon">FavIcon Web Page Link Thumbnail</a>
                      </li>
                    </ul>
                  </dd>
                  <dt>
                    <a href="#non-im"><img src="../img_www/granitesm_right.gif" border="0" width="15" height="15"> Other Non-IM Techniques</a>
                  </dt>
                </dl>
              </td>
              <td>
                <dl>
                  <dt>
                    <a href="#fluff"><img src="../img_www/granitesm_right.gif" border="0" width="15" height="15"> Adding Fluff</a>
                  </dt>
                  <dd>
                    <ul>
                      <li>
                        <a href="#labels">Adding Image Labels</a>
                      </li>
                      <li>
                        <a href="#button">Raised Button</a>
                      </li>
                      <li>
                        <a href="#bubble">Bubble Button</a>
                      </li>
                      <li>
                        <a href="#border">Adding Borders</a>
                      </li>
                      <li>
                        <a href="#frame">Simple Frame</a>
                      </li>
                      <li>
                        <a href="#montage">Montage Framing</a>
                      </li>
                      <li>
                        <a href="#soft_edges">Soft and Blurred Edges</a>
                      </li>
                      <li>
                        <a href="#rounded">Rounded and Shaped Corners</a>
                      </li>
                      <li>
                        <a href="#torn">Torn Paper Edge</a>
                      </li>
                      <li>
                        <a href="#shadow">Adding a Shadow</a>
                      </li>
                      <li>
                        <a href="#thickness">Adding Some Thickness</a>
                      </li>
                      <li>
                        <a href="#polaroid">Polaroid-like Thumbnails</a>
                      </li>
                    </ul>
                  </dd>
                </dl>
              </td>
              <td>
                <dl>
                  <dt>
                    <a href="#framing"><img src="../img_www/granitesm_right.gif" border="0" width="15" height="15"> Framing Techniques</a>
                  </dt>
                  <dd>
                    <ul>
                      <li>
                        <a href="#self_frame"><b>Self Framing</b> (External)</a>
                      </li>
                      <li>
                        <a href="#self_frame_inside">Self Framing (Internal)</a>
                      </li>
                      <li>
                        <a href="#border_overlay"><b>Simple Border Overlay</b></a>
                      </li>
                      <li>
                        <a href="#badge_overlay">Badge using Overlay</a>
                      </li>
                      <li>
                        <a href="#mask_paint"><b>Mask 'n' Paint Technique</b></a>
                      </li>
                      <li>
                        <a href="#rounded_border">Rounded Border</a>
                      </li>
                      <li>
                        <a href="#badge_mask_paint">Badge using Mask 'n' Paint</a>
                      </li>
                      <li>
                        <a href="#paint_mask"><b>Paint 'n' Mask Technique</b></a>
                      </li>
                      <li>
                        <a href="#pagecurl">Page Curl Corners</a>
                      </li>
                      <li>
                        <a href="#fancy">Fancy Corner Overlay</a>
                      </li>
                      <li>
                        <a href="#badge_paint_mask">Badge using Paint 'n' Mask</a>
                      </li>
                      <li>
                        <a href="#lighting_mask"><b>Lighting Mask Technique</b></a>
                      </li>
                      <li>
                        <a href="#glass_bubble">Glass Bubble</a>
                      </li>
                      <li>
                        <a href="#badge_lighting">Badge with Lighting Mask</a>
                      </li>
                    </ul>
                  </dd>
                  <dt>
                    <a href="#frame_edge"><img src="../img_www/granitesm_right.gif" border="0" width="15" height="15">Framing using Edge Images</a>
                  </dt>
                  <dd>
                    <ul>
                      <li>
                        <a href="#frame_append">Over-simplistic Append</a>
                      </li>
                      <li>
                        <a href="#frame_extended">Extended Overlay Framing</a>
                      </li>
                      <li>
                        <a href="#frame_joints">45 degree corner joints</a>
                      </li>
                    </ul>
                  </dd>
                </dl>
              </td>
            </tr>
          </table>One of the biggest uses ImageMagick is put to is the creation of thumbnails for family photo albums, sports and hobby pages, catalogs, and so on. Typically for use on the world wide web or in photo CDs. This page provides examples and techniques used to generate thumbnails.
          <hr>
          <!-- ---------------------------------------------------------------- -->
          <a name="storage" id="storage"></a>
          <h2>Thumbnail Storage</h2>I would like to first start with one very important point. The original image from video cameras and photo scanning should be kept in a safe place in the original format, preferably a non-lossy format (not the JPEG image format), without any modification resizing or other change, except possibly a file name change. Of course a scanned image can be re-scanned, but it is far better to re-use your original source than to re-do it from a already degraded copy later. This is VERY important as any form of modification will mean a loss of some information in the image, and provides a source from which you can re-work your image for other uses. The original image does not have to be your working image, which may be resized or color adjusted for display, just be sure to have your image saved and backed up somewhere safe for future use. The next thing to do, even before you create any thumbnails, is to decide how you want to save your thumbnail relative to your normal sized image format, then stick to that scheme. This is especially important for web pages. Schemes include...
          <ul>
            <li>Save the main photo image in the lossy JPEG format at the size you want or need, then use the same name for the generated thumbnail but using the GIF image format. EG Same filename but a different format and suffix. Main Image: <code>photo_name.jpg</code> <img src="../img_www/space.gif" width="80" height="1"> Thumbnail: <code>photo_name.gif</code></li>
            <li>Store the thumbnails with the same name in a sub-directory called for example "<code>thumbs</code>" or whatever is convenient for you. Main Image: <code>photo_name.jpg</code> <img src="../img_www/space.gif" width="80" height="1"> Thumbnail: <code>thumbs/photo_name.jpg</code></li>
            <li>Use the same format as the original image, but with an extra string added to the file name. Typical string additions include "<code>_tn</code>", "<code>_small</code>", "<code>_thumb</code>", etc... Main Image: <code>photo_name.jpg</code> <img src="../img_www/space.gif" width="80" height="1"> Thumbnail: <code>photo_name_tn.jpg</code></li>
            <li>Some combination of the above. There is no reason why you cannot save thumbnails in different image format, with an extra image suffix appended to the filename, and saved in a subdirectory! Main Image: <code>images/photo_name.jpg</code> <img src="../img_www/space.gif" width="30" height="1"> Thumbnail: <code>thumbs/photo_name.jpg.gif</code> This is actually quite common on the WWW, and I have even seen the the two directories stored on completely separate machines!</li>
          </ul>The first scheme can use "<code>magick mogrify</code>" to generate all your thumbnails, without destroying the original image, by using a "<code><a href="../option_link.cgi?format">-format</a></code>" setting to specify the output image format. As of IM v3.2.0, the second scheme is now also possible to do with "<code>magick mogrify</code>" thanks to the addition of a special "<code><a href="../option_link.cgi?path">-path</a></code>" setting that specifies a different directory in which to save the modified images. For example, this converts JPG images into GIF thumbnails in a "<code>thumbs</code>" sub-directory that was just created.
          <div align="center">
            <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="90%" bgcolor="#F8F8F8">
              <tr>
                <td>
                  <pre class="bg-light text-dark mx-4"><samp>
  mkdir thumbs
  magick mogrify  -format gif -path thumbs -thumbnail 100x100 *.jpg
</samp></pre>
                </td>
              </tr>
            </table>
          </div>The other methods will require you to either, first make a copy of the original image, before running "<code>magick mogrify</code>", create a special script to process the images, or some other DIY method. A number of the simpler non-IM techniques are detailed at the end of the example section for <a href="../basics/#mogrify_not">Batch Processing - Without using "<code>magick mogrify</code>"</a>. Whatever method you choose the important thing is to choose a scheme for thumbnail storage, and then stick with it. By using the same scheme for all your thumbnails you can then write shell or Perl scripts to make thumbnail generation and even generation of the HTML links easy. More on this later. <a name="formats" id="formats"></a>
          <h3>Selection of the Thumbnail format</h3>The format in which you save a thumbnail can make a big difference to its final size on disk and download speed for web pages. In this regard I recommend you study the summary of the various <a href="../formats/#summary">Common File Formats</a>. Specifically you should note...
          <dl>
            <dd><b>JPEG</b> compresses well and is lossy, but is designed for large real world images, not small thumbnails. It also does NOT allow any form of transparency. In summary, the format is good for large images, bad for thumbnails. Watch out for profiles (see next section). While JPG is not recommended for thumbnails, for viewing images on the WWW it is recommended you use smaller 800x600 pixel image, at a much lower "<code><a href="../option_link.cgi?quality">-quality</a></code>" percentage (say 50 or even 30%), though it will not look very good. It has also been suggested that using "<code><a href="../option_link.cgi?sampling-factor">-sampling-factor</a> 2x1</code>" will also produce a smaller JPEG image size. I do not recommend the full original image never be placed directly on the web, unless temporarily (at a referenced location) for a friend to download. Remember do not link to it, (even by directory indexing), and never for more than a day, or it may be Googled.</dd>
            <dd>
              <b>GIF</b> works for simple small images, and compresses okay. It has a color limit of 256, but for small images this is rarely noticeable. It can also do cartoon like animations of images, not that that is needed for thumbnails, unless you really what to get fancy. What is a problem is that the format only has Boolean (on/off) transparency, which makes for horrible looking borders on shaped images. The solutions to that is to design the thumbnail to only use Boolean transparency, or arrange it so it can only be used on a specific background color. For details see the examples on <a href="../formats/#bgnd">GIF's on a background color or pattern</a>.
            </dd>
            <dd>
              <b>PNG</b> is the modern ideal format for thumbnails. It has a good compression, and internal format styles. It is non-lossy, and can display all colors, and these days it is understood by almost all browsers, (though for Microsoft Internet Explorer, before v7, needs some java scripting added to web pages). More importunately this format understands semi-transparent color, making shadows and edges sharp and clear, or faded and blurry as you wish. This format however does not do animations, though the related MNG format does. Very few browsers seem to support that format however. For thumbnails you can reduce the size of the final image by reducing the depth and number of colors, as well as setting a higher "<code>bzip</code>" compression quality (first digit in "<code><a href="../option_link.cgi?quality">-quality</a></code>") for your final thumbnail image. For example, the following is suggested for small PNG thumbnails that does not involve transparency.
              <div align="center">
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="90%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre class="bg-light text-dark mx-4"><samp>
        -strip  -quality 95  PNG8:thumbnail.png
    </samp></pre>
                    </td>
                  </tr>
                </table>
              </div>Which uses a smaller, 8 bit, or 256 color limited, PNG format. You can also re-process the final image though secondary applications (See <a href="../formats/#png_non-im">Non-IM PNG Processing</a>) which can automatically find the best PNG compression for that specific image. There are also programs to do that color reduction to the smaller internal PNG format, while preserving semi-transparent colors. This is something IM currently does not handle. .
            </dd>
          </dl><b>One final word about formats...</b> No matter what format you use for your thumbnails, if you must save an intermediate unfinished image, use a PNG (without any color reduction) or MIFF image format. Doing this will preserve as much color information about the image as possible in the intermediate stage. Only do color reduction, or save to GIF or JPEG formats as an absolute final step. This is important, so I repeat...
          <div align="center">
            <b>Do NOT use JPEG, PNG8, or GIF for intermediate working images!<br>
            Better to use PNG or MIFF.</b>
          </div><a name="profiles" id="profiles"></a>
          <h3>Profiles, Stripping, and JPEG Handling</h3>Many images from digital cameras, scanning software, and some paint programs (photoshop is notorious for this), save extra information about the image in the form of <b>profiles</b>. This includes image formats such a JPEG, PNG, TIFF and as of IM v6.2.4-1 GIF. Of course the IM specific format, MIFF also does this. (See <a href="../formats/#profiles">Image Profiles</a> for more detailed information). These profiles can be up to 60 Kb in size, so can make a big difference to your file size, and by default IM will preserve this profile information. Thumbnails have no need for this data and often not even the main image needs it. You can also remove the profiles from your images with the IM commands...
          <div align="center">
            <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="90%" bgcolor="#F8F8F8">
              <tr>
                <td>
                  <pre class="bg-light text-dark mx-4"><samp>
  magick input.jpg  -strip output.jpg

  magick mogrify -strip  *.jpg
</samp></pre>
                </td>
              </tr>
            </table>
          </div>You can also use the option "<code><a href="../option_link.cgi?profile">-profile</a> '*'</code> " to remove the profiles. It is however recommended you only strip profiles when you modify an image, especially if reducing it in size for web displays, or thumbnail images. Stripping profiles while resizing, particularly for generating smaller thumbnail images, is so common that both "<code><a href="../option_link.cgi?resize">-resize</a></code>" and "<code><a href="../option_link.cgi?strip">-strip</a></code>" were combined into a new operation, just for this very purpose. Naturally enough this resize operation is called "<code><a href="../option_link.cgi?thumbnail">-thumbnail</a></code>". For example...
          <div align="center">
            <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="90%" bgcolor="#F8F8F8">
              <tr>
                <td>
                  <pre class="bg-light text-dark mx-4"><samp>
  magick -define jpeg:size=240x180 image.jpg -thumbnail 120x90 thumbs/image.gif

  magick mogrify -path thumbs -format gif -define jpeg:size=240x180 -thumbnail 120x90 '*.jpg'
</samp></pre>
                </td>
              </tr>
            </table>
          </div>
          <table border="0" cellspacing="0" cellpadding="0" width="90%" align="center">
            <tr valign="top">
              <td><img src="../img_www/warning.gif" width="28" height="28"><img src="../img_www/space.gif" width="12" height="16"></td>
              <td align="justify" width="100%"><font size="-1"><i>Before IM v6.5.4-7 the "<code><a href="../option_link.cgi?thumbnail">-thumbnail</a></code>" would strip ALL profiles from the image, including the ICC color profiles. From this version onward the color profiles will be preserved. If the color profile is not wanted then "<code><a href="../option_link.cgi?strip">-strip</a></code>" all profiles.</i></font></td>
            </tr>
          </table>The "<code><a href="../basics/#mogrify">magick mogrify</a></code>" will of course generate thumbnails for a whole directory of JPEG images, but be careful it does not overwrite any thumbnails you want to keep. For a number of other non-IM methods for looping over a large number of images see the example section for <a href="../basics/#mogrify_not">Batch Processing - Without using Mogrify</a>. For very large images the "<code><a href="../option_link.cgi?thumbnail">-thumbnail</a></code>" resize operator goes further and first scales the image down to 5 times the final thumbnail size first, before doing the actual resize operation. This speeds up the thumbnail generation further. However for thumbnailing JPEG images, an even better method of limiting the initial image size can be used, by just not reading the whole image into memory in the first place. The "<code><a href="../option_link.cgi?define">-define</a> jpeg:size=</code>" setting (as shown in the above example) is a special hint to the JPEG image library to reduce the amount data that is read in from VERY BIG JPEG images. See <a href="../formats/#jpg_read">Reading JPEG Files</a>.
          <table border="0" cellspacing="0" cellpadding="0" width="90%" align="center">
            <tr valign="top">
              <td><img src="../img_www/warning.gif" width="28" height="28"><img src="../img_www/space.gif" width="12" height="16"></td>
              <td align="justify" width="100%"><font size="-1"><i>Before IM v6.5.6-0 this coder setting was extracted from the "<code><a href="../option_link.cgi?size">-size</a></code>" setting. This caused problems when users used "<code><a href="../option_link.cgi?size">-size</a></code>" for image creation but then had JPEG reading produce unexpected results. As such this was changed to be a special coder setting instead.<br>
              <br>
              In older versions of IM you may need to reset the setting using "<code><a href="../option_link.cgi?size">+size</a></code> before reading JPEG images, because of this 'dual' role.</i></font></td>
            </tr>
          </table>From IM version 6.2.6-2, a new <a href="../files/#read_mods">Read Image Modifier</a> was added, which lets you resize the input image immediately after it is read in. This option will work with ANY image format, not just JPEG image. It is however no substitute for using a "<code><a href="../option_link.cgi?define">-define</a> jpeg:size=</code>" setting for JPEG images. As such the recommended way of resizing ANY input image format is now...
          <div align="center">
            <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="90%" bgcolor="#F8F8F8">
              <tr>
                <td>
                  <pre class="bg-light text-dark mx-4"><samp>
  magick -define jpeg:size=240x180 input.img'[120x90]' \
          -strip  output_thumbnail.gif
</samp></pre>
                </td>
              </tr>
            </table>
          </div>Well on with the practical IM thumbnail examples...
          <hr>
          <!-- ---------------------------------------------------------------- -->
          <a name="creation" id="creation"></a>
          <h2>General Thumbnail Creation</h2><a name="height" id="height"></a>
          <h3>Generate Thumbnails in General (specific height)</h3>Lets magick a <a href="../img_photos/hatching_orig.jpg">large sample JPEG image</a> to a GIF thumbnail 90 pixels high with the width automatically adjusted (within the 250 pixel width limit) to preserve the aspect ratio of the image.
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr valign="top">
              <td width="100%" align="justify">
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre class="bg-light text-dark mx-4"><samp>
  magick -define jpeg:size=500x180  hatching_orig.jpg  -auto-orient \
          -thumbnail 250x90   -unsharp 0x.5  thumbnail.gif
</samp></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="thumbnail.gif"><img src="thumbnail.gif" height="90" align="middle" vspace="0" hspace="5" border="1" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>Note that I used the "<code><a href="../option_link.cgi?thumbnail">-thumbnail</a></code>" option above. This not only resizes the image, but strips any and all profile and comment information that may be present in the original JPEG image. Also as it uses the "<code><a href="../option_link.cgi?sample">-sample</a></code>" resize operator for the initial downsizing of the image, it is faster, while producing reasonable results for small thumbnails. I also set a minimum "<code><a href="../option_link.cgi?define">-define</a> jpeg:size=</code>" for the image being read in. This is passed to the JPEG library, which will return an image somewhere between this size and double this size (if possible), rather that the whole very large original image. Basically don't overflow the computers memory with an huge image when it isn't needed. The JPEG size hint I use is at least double that of the final thumbnail so that resize will still generate a reasonable looking result. The "<code><a href="../option_link.cgi?auto-orient">-auto-orient</a></code>" operator ensures that the image, if from a digital camera, is rotated correctly according to the camera's orientation. This is not needed for the 'desktop' image I am using, but I included it in the above for digital camera users. Note however that orientation can still go wrong, especially for photos viewing directly down or up, such as when taking photos of documents.The result is a thumbnail of a specific height, but variable width. I use this thumbnail for my own web pages so that a series of image in a row, will all match up height wise, forming a neat look. The 250 pixel width limit in the above is important. If left unset, (EG: using "<code>-thumbnail x90</code>" ) IM would could have problems when generating thumbnails of very long thin images such as those shown in <a href="http://www.ict.griffith.edu.au/images/FancyLines/Images.html">Web Line Images</a>. The result in that case would be very very long, <i>enlargement</i> of the image, instead of a small thumbnail. Some people (including myself) find that while IM's resize is one of the best implementations (See <a href="../filter/#photoshop">IM Resize vs Other Programs</a>), the result is still a little blurry. As such you can improve the above result by sharpening the image slightly (using "<code><a href="../option_link.cgi?auto-orient">-unsharp</a></code>") after the "<code><a href="../option_link.cgi?thumbnail">-thumbnail</a></code>" resize operation. For more information see <a href="../resize/#resize_unsharp">Sharpen Resized Images -- Photoshop Resize Technique</a>, But really it all comes down to a matter of personal taste.<br>
          The "<code>magick mogrify</code>" version is the same as the "<code>magick</code>" command (with no initial input images), but will but will generate automatic thumbnails of <i>every</i> JPEG image in the current directory. The image argument is quoted so that IM itself will scan the directory, and not the command line shell. This prevents 'line limit overflow errors' on directories containing a huge number of images.
          <div align="center">
            <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="90%" bgcolor="#F8F8F8">
              <tr>
                <td>
                  <pre class="bg-light text-dark mx-4"><samp>
  magick mogrify  -format gif -define jpeg:size=500x180 -auto-orient \
                -thumbnail 250x90 -unsharp 0x.5  '*.jpg'
</samp></pre>
                </td>
              </tr>
            </table>
          </div>
          <table border="0" cellspacing="0" cellpadding="0" width="90%" align="center">
            <tr valign="top">
              <td><img src="../img_www/reminder.gif" width="20" height="16"><img src="../img_www/space.gif" width="20" height="16"></td>
              <td align="justify" width="100%"><font size="-1"><i>Note that "<code>magick mogrify</code>" will blindly create thumbnails, replacing any existing images of the same name. GIF images in this case. Extreme caution is always advised when using this command.<br>
              <br>
              Backup copies are always recommended before doing any processing.</i></font></td>
            </tr>
          </table>
          <table border="0" cellspacing="0" cellpadding="0" width="90%" align="center">
            <tr valign="top">
              <td><img src="../img_www/expert.gif" width="23" height="26"><img src="../img_www/space.gif" width="17" height="16"></td>
              <td align="justify" width="100%"><font size="-1"><i>Instead of specifying a different format (using "<code><a href="../option_link.cgi?format">-format</a></code>") so as to prevent "<code>magick mogrify</code>" from overwriting the original source images, you can use a "<code><a href="../option_link.cgi?path">-path</a></code>" setting to define a separate thumbnail directory. You can use both output options.</i></font></td>
            </tr>
          </table>While "<code>magick mogrify</code>" can output the new images with a different suffix ("<code><a href="../option_link.cgi?format">-format</a></code>") or directory ("<code><a href="../option_link.cgi?path">-path</a></code>"), they are your only options using this command. If you are also wanting to change the name of the image, such as adding a "<code>_tn</code>" or "<code>_sm</code>" to denote thumbnail or small versions of the image, then I recommend you create a shell script to do the job for you, processing them one at a time using "<code>magick</code>". &nbsp; &nbsp; <i>I wrote such a script to do this, while simultaneously generating HTML indexes at the same time.</i><br>
          <a name="fit" id="fit"></a>
          <h3>Resize Thumbnail to Fit</h3>Another form of automatic thumbnail generation is shrink image to fit a fixed sized box, say "<code>100x100</code>" but keeping the images aspect ratio. Well that is the default meaning for a resize geometry setting.
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr valign="bottom">
              <td width="100%" align="justify">
                However I prefer not to enlarge images which already fit such a box. For that you need to add a "<code>&gt;</code>" to the geometry string.
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre class="bg-light text-dark mx-4"><samp>
  magick -define jpeg:size=200x200 hatching_orig.jpg \
          -thumbnail '100x100&gt;' rectangle.gif
</samp></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="rectangle.gif"><img src="rectangle.gif" width="100" align="middle" vspace="0" hspace="5" border="1" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>As before the aspect ratio of the image is preserved, as such the thumbnail is unlikely to be exact 100 pixels square. However at least one of the images dimensions will be 100 pixels. <a name="pad" id="pad"></a>
          <h3>Pad Out the Thumbnail</h3>The next most common request is to generate thumbnails that fill out the image with borders of a specific color (usually '<code>black</code>', or '<code>transparent</code>' but for these examples I will use '<code>skyblue</code>') so the thumbnail is exactly the size you wanted. For example: An image which is 400x300 pixels shrunk to fit a 100x100 pixel box will normal (with the above) have a size of 100x75 pixels. We want to add some padding borders to the top and bottom of the image (and to the sides to be sure) to make the final thumbnail image always 100x100 pixels in size.
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr valign="bottom">
              <td width="100%" align="justify">
                There are a number of ways to do this, and as of IM v6.3.2 the best way is using the <a href="../crop/#extent">Extent Operator</a>.
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre class="bg-light text-dark mx-4"><samp>
  magick -define jpeg:size=200x200 hatching_orig.jpg -thumbnail '100x100&gt;' \
          -background skyblue -gravity center -extent 100x100 pad_extent.gif
</samp></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="pad_extent.gif"><img src="pad_extent.gif" width="100" height="100" align="middle" vspace="0" hspace="5" border="1" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr valign="bottom">
              <td width="100%" align="justify">
                As of IM version 6.2.5, you can also use a <a href="../crop/#crop_viewport">Viewport Crop</a>, and flatten the result onto a background color.
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre class="bg-light text-dark mx-4"><samp>
  magick -define jpeg:size=200x200 hatching_orig.jpg -thumbnail '100x100&gt;' \
          -gravity center  -crop 120x120+0+0\! \
          -background skyblue  -flatten    pad_view.gif
</samp></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="pad_view.gif"><img src="pad_view.gif" width="120" height="120" align="middle" vspace="0" hspace="5" border="1" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr valign="bottom">
              <td width="100%" align="justify">
                The key difference between using<a href="../crop/#extent">Extent</a> and a <a href="../crop/#crop_viewport">Viewport Crop</a> is weather you want a minimal <a href="../basics/#virtual_canvas">Virtual Canvas</a> or have the whole area 'padded out'. Another method to pad out an image is to overlay the thumbnail onto a background image (actual image, solid color or tiled canvas) that is the right size, in this case the 128x128 "<code>granite:</code>" built-in image.
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre class="bg-light text-dark mx-4"><samp>
  magick -define jpeg:size=200x200 hatching_orig.jpg -thumbnail '100x100&gt;' \
          granite: +swap -gravity center -composite pad_compose.gif
</samp></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="pad_compose.gif"><img src="pad_compose.gif" width="128" height="128" align="middle" vspace="0" hspace="5" border="1" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>This method is probably the best method to use with older versions of IM (such as IM v5), though the "<code><a href="../option_link.cgi?composite">-composite</a></code>" operation will need to be done by the separate "<code><a href="../basics/#composite">composite</a></code>" command, rather than the above single command method. However an image processing point of view all the above are actually doing the same thing. <a name="cut" id="cut"></a>
          <h3>Cut the Thumbnail to Fit</h3>An alternative, is rather than pad out the image to fit the specific thumbnail size we want, is to instead cut off the parts of the image that does not fit the final size. Of course this means you actually lose some parts of the original image, particularly the edges of the image, but the result is an enlarged thumbnail of the center part of the image. This is usually (but not always) the main subject of the image, so it is a practical method of thumbnail creation. As of IM v6.3.8-3 the special resize option flag '<code>^</code>' was added to make this easier. We just resize using this flag then crop off the parts of the image that overflows the desired size.
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr>
              <td width="100%" align="justify">
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre class="bg-light text-dark mx-4"><samp>
  magick -define jpeg:size=200x200 hatching_orig.jpg  -thumbnail 100x100^ \
          -gravity center -extent 100x100  cut_to_fit.gif
</samp></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="cut_to_fit.gif"><img src="cut_to_fit.gif" width="100" height="100" align="middle" vspace="0" hspace="5" border="1" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>As you can see the thumbnail of the image is much larger and more detailed, but at a cost of cutting off the sides off the original image. For more information on this option see <a href="../resize/#fill">Resize to Fill Given Area</a>.
          <table border="0" cellspacing="0" cellpadding="0" width="90%" align="center">
            <tr valign="top">
              <td><img src="../img_www/warning.gif" width="28" height="28"><img src="../img_www/space.gif" width="12" height="16"></td>
              <td align="justify" width="100%"><font size="-1"><i>Before IM v6.3.8-3 when this special flag was added, you would have needed some very complex trickiness to achieve the same result. See <a href="../resize/#space_fill">Resizing to Fill a Given Space</a> for details.</i></font></td>
            </tr>
          </table><a name="areafit" id="areafit"></a>
          <h3>Area Fit Thumbnail Size</h3>The last two methods will often make an image very small with a lot of extra padding, or, it will cut off a lot of the image so as to completely fill the space. However by using a different resize flag, it is possible to get a thumbnail that is between these two extremes. For example a 100x100 pixel thumbnail has 10,000 pixels. Now if we ask resize to size out image to something around that many pixels in size (using the <a href="../resize/#pixel">resize '<code>@</code>' flag</a>), you will have an image that will need both a little padding and a little cutting. This maximizes the size of the resulting thumbnail, while not cutting away too much. For example...
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr>
              <td width="100%" align="justify">
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre class="bg-light text-dark mx-4"><samp>
  magick -define jpeg:size=200x200 hatching_orig.jpg  -thumbnail 10000@ \
          -gravity center -background skyblue -extent 100x100  area_fit.gif
</samp></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="area_fit.gif"><img src="area_fit.gif" width="100" height="100" align="middle" vspace="0" hspace="5" border="1" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>As you can see the thumbnail has some padding, and the image has some cropping, but the result is probably about the best fit of image to a given thumbnail space. <a name="fit_summery" id="fit_summery"></a>
          <h3>Fit to a Given Space Summary</h3>In summary, here are the results of the three methods for thumbnailing an image to a specific sized area. All three methods use exactly the same code, with just with a slight change in the resize argument/flag used.
          <table border="0" align="center">
            <tr>
              <td align="middle">
                <a href="pad_extent.gif"><img src="pad_extent.gif" width="100" height="100" align="middle" vspace="0" hspace="20" border="1" alt="[IM Output]"></a><br>
                Padded Fit<br>
                <font size="-2">resize, no flag</font>
              </td>
              <td align="middle">
                <a href="area_fit.gif"><img src="area_fit.gif" width="100" height="100" align="middle" vspace="0" hspace="20" border="1" alt="[IM Output]"></a><br>
                Area Fit<br>
                <font size="-2">resize, '@' flag</font>
              </td>
              <td align="middle">
                <a href="cut_to_fit.gif"><img src="cut_to_fit.gif" width="100" height="100" align="middle" vspace="0" hspace="20" border="1" alt="[IM Output]"></a><br>
                Cut to Fit<br>
                <font size="-2">resize, '^' flag</font>
              </td>
            </tr>
          </table><br>
          <a name="square" id="square"></a>
          <h3>Square Padding and Cropping</h3>The above padding and cropping methods assume you know the final size of the area in which you want the image to fit. But that is not always the case. Sometimes you want to simply 'square an image', either by 'padding' it out (external square), or 'shaving' the edges (internal square). From the IM Discussion Forums on <a href="../forum_link.cgi?f=1&amp;t=20601">Squaring Images</a> a number of methods were developed.
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr valign="bottom">
              <td width="100%" align="justify">
                External Squaring can be done using <a href="../layers/#mosaic">Mosaic</a> to create a larger background canvas using a rotated copy of the image.
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre class="bg-light text-dark mx-4"><samp>
  magick thumbnail.gif \
          \( +clone -rotate 90 +clone -mosaic +level-colors white \) \
          +swap -gravity center -composite    square_padded.gif
</samp></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="square_padded.gif"><img src="square_padded.gif" width="120" height="120" align="middle" vspace="0" hspace="5" border="1" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>Internal Squaring on the other hand is a little harder and requires more work to achieve. This one uses some heavy mask handling to generate a smaller canvas.
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr>
              <td width="100%" align="justify">
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre class="bg-light text-dark mx-4"><samp>
  magick thumbnail.gif \
          \( +clone +level-colors white \
             \( +clone -rotate 90 +level-colors black \) \
             -composite -bordercolor white -border 1 -trim +repage \) \
          +swap -compose Src -gravity center -composite \
          square_cropped.gif
</samp></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="square_cropped.gif"><img src="square_cropped.gif" width="90" height="90" align="middle" vspace="0" hspace="5" border="1" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>An alturnative way is to use a no-op distort using a distort viewport crop/pad the image (See <a href="../distorts/#centered_square">Distort Viewport Centered Square Crop</a>). Essentually it uses a 'percent escapes' to do the calculations needed for an <a href="../crop/#extent">Extent</a> type of operation. External (padding) square...
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr>
              <td width="100%" align="justify">
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre class="bg-light text-dark mx-4"><samp>
  magick thumbnail.gif  -virtual-pixel white -set option:distort:viewport \
     "%[fx:max(w,h)]x%[fx:max(w,h)]-%[fx:max((h-w)/2,0)]-%[fx:max((w-h)/2,0)]" \
     -filter point -distort SRT 0  +repage  square_external.gif
</samp></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="square_external.gif"><img src="square_external.gif" width="120" height="120" align="middle" vspace="0" hspace="5" border="1" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>The <a href="../misc/#virtual">Virtual Pixel</a> setting is used to specify the padding color. Internal (cropped) square...
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr>
              <td width="100%" align="justify">
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre class="bg-light text-dark mx-4"><samp>
  magick thumbnail.gif   -set option:distort:viewport \
     "%[fx:min(w,h)]x%[fx:min(w,h)]+%[fx:max((w-h)/2,0)]+%[fx:max((h-w)/2,0)]" \
     -filter point -distort SRT 0  +repage  square_internal.gif
</samp></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="square_internal.gif"><img src="square_internal.gif" width="90" height="90" align="middle" vspace="0" hspace="5" border="1" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>Curtisy of <a href="http://www.fmwconcepts.com/imagemagick/tidbits/image.php#pad_crop_square">Fred Weinhaus's Tidbits Page</a>. This is a simplier version, but will lose any meta-data (like comment strings or profiles) the image may have.
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr>
              <td width="100%" align="justify">
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre class="bg-light text-dark mx-4"><samp>
  magick thumbnail.gif -set option:size '%[fx:min(w,h)]x%[fx:min(w,h)]' \
          xc:none +swap -gravity center -composite square_internal_2.gif
</samp></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="square_internal_2.gif"><img src="square_internal_2.gif" width="90" height="90" align="middle" vspace="0" hspace="5" border="1" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>
          <table border="0" cellspacing="0" cellpadding="0" width="90%" align="center">
            <tr valign="top">
              <td><img src="../img_www/warning.gif" width="28" height="28"><img src="../img_www/space.gif" width="12" height="16"></td>
              <td align="justify" width="100%"><font size="-1"><i>IMv7 will allow you to do the above mathematics directly as part of a crop or extent argument, which will prevent loss of image meta-data.</i></font></td>
            </tr>
          </table><a name="manual" id="manual"></a>
          <h3>Manual Cropping</h3>The normal way I generate thumbnail images for use on my web pages, is a mix of automatic and manual scripts. The final setup of my images are..
          <ul>
            <li>I use a PNG or TIFF for the original ,VERY large, scan of the photo. OR the original JPEG image downloaded from a digital camera. Basically for the unmodified original source image, for archiving. I also now like to include the string "<code>_orig</code>" in this images filename.</li>
            <li>A smaller JPEG image format for a web viewable image when the thumbnail is clicked or selected. This image is resized to fit a 800x800 pixel box, which is a size suitable for viewing by most web users. I typically add a "<code>_md</code>" for medium sized image, in the filename.</li>
            <li>And lastly a GIF thumbnail resized to a fixed 90 pixel high, and variable width. This allows centered rows of thumbnails on web pages to look reasonable neat and tidy, but which automatically fills the browser windows width, no matter what size browser they are using. Again I typically now include a "<code>_tn</code>" in the images filename, to denote that it is a thumbnail.</li>
          </ul>I first generate the web viewable JPEG images (medium size) using "<code>magick mogrify</code>" from the original scanned image. This is reduces the download time and viewing size of the image to something that is practical for the typical web user (who could be logged in via modem). From these images I generate an initial set of thumbnails, again using "<code>magick mogrify</code>". However I often find in typical photos that the subject of the thumbnails becomes too small to make an effective thumbnail, when viewed. To fix this I examine the automatically generated thumbnails, and in about half the cases manually create my own 'zoomed in on subject' thumbnail. I read in the JPEG image, and crop it down the main subject of the image effectively 'zooming in' on the subject of the photo, and removing bulk of the background context of the image. This is then smoothed and thumbnailed, either using a "<code>magick -thumbnail</code>", or more often in the same graphic program I am viewing and cropping the images with (usually "<code>XV</code>", see below). So instead of a thumbnail where the people in the photo are hardly visible (left), I have manually cropping around the subject, highlighting the main point of the photo (right), before thumbnailing. That allows users to see the image content more clearly and thus better decide if they actually want to download and look at the larger JPEG version of the image. <!-- kiteflyer photos were cropped and resized and stored in "images" -->
          <table align="center">
            <tr>
              <td align="center" colspan="3"><b>Queensland KiteFlyers, Ron and Val Field</b></td>
            </tr>
            <tr>
              <td align="center"><font size="-1"><a href="../img_photos/kiteflyers_orig.jpg"><img src="../img_photos/kiteflyers_auto.gif" align="middle" vspace="0" hspace="0" alt="[IM Output]"></a><br>
              Automatically<br>
              Generated<br>
              Thumbnail</font></td>
              <td><img src="../img_www/space.gif" width="50" height="1"></td>
              <td align="center"><font size="-1"><a href="../img_photos/kiteflyers_orig.jpg"><img src="../img_photos/kiteflyers_man.gif" align="middle" vspace="0" hspace="0" alt="[IM Output]"></a><br>
              Manually Cropped<br>
              and Resized<br>
              Thumbnail</font></td>
            </tr>
            <tr>
              <td align="center" colspan="3"><font size="-1"><b>(Click on either image for original scanned photo)</b></font></td>
            </tr>
          </table>This is of course more manually intensive, but only needs to be done once per image, and only on images that have a lot of space such as in the above example. Also I only do this for images I am putting the web. Of course as "<code>magick mogrify</code>" will overwrite any existing, possibly hand generated thumbnails, you cannot use it again after you perform any manual thumbnail generation. The "<code>magick mogrify</code>" command is useful, but also very dangerous as it overwrites lots of images. Always think before you run "<code>magick mogrify</code>" globally across all your images. <a name="html" id="html"></a>
          <h3>HTML Thumbnail Pages</h3>Once I have all the thumbnail images sorted out in the directory I use a special perl script called "<code>thumblinks</code>" I wrote that look for the images (JPEG photos and GIF thumbnails), and generate HTML links, and even full HTML photo pages. The script will read and include size of the GIF thumbnail size in the HTML, and attach pre-prepared header and footer files around the thumbnail links. The script will also remove any thumbnail links from the list it generates, if it finds an existing link in the header or footer file itself. This may sound complex, but it makes my HTML page generation very fast and flexible, and ensures ALL image thumbnailed images in a directory have been added to that directories index page, while still letting me comment on specific images in the index header. It also makes the page independent of the users window size, automatically adjusting to suit. For a simple example of my "<code>thumblinks</code>" script output see <a href="https://antofthy.gitlab.io/info/art/">Tomb of Castle Artworks</a>. For a quick example and starting point for generating such links look at the examples of using the <a href="../basics/#identify">identify command</a>. <a name="favicon" id="favicon"></a>
          <h3>FavIcon Web Page Link Thumbnail</h3>The "<code>favion.ico</code>" icon often looked for by web browsers on the top level web page of a web site, for that whole site. That image is a special multi-resolution image format and can be created as follows.
          <div align="center">
            <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="90%" bgcolor="#F8F8F8">
              <tr>
                <td>
                  <pre class="bg-light text-dark mx-4"><samp>
  magick image.png -alpha off -resize 256x256 \
          -define icon:auto-resize="256,128,96,64,48,32,16" \
          favicon.ico
</samp></pre>
                </td>
              </tr>
            </table>
          </div>The '<code>image.png</code>' can be anything you like, but should be square. If it isn't that should also be the first step in the above. You can also include larger resolutions such as 128 or 256 pixels, but few browsers would make use of them. The 16 and 32 pixel sizes are much more commonly used in such ICO files so special emphesis on those my be useful. Also remember that many browsers will color reduce the images so are to reduce the space used to store it in an users bookmarks file. This brings us to one other point. As only the smallest of images are typically used, with further color reduction, it is recommented to keep the images as small and as well defined as posible. Here is an example of manually resizing images for an ICO file format.
          <div align="center">
            <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="90%" bgcolor="#F8F8F8">
              <tr>
                <td>
                  <pre class="bg-light text-dark mx-4"><samp>
  magick image.png  -background white \
          \( -clone 0 -resize 16x16 -extent 16x16 \) \
          \( -clone 0 -resize 32x32 -extent 32x32 \) \
          \( -clone 0 -resize 48x48 -extent 48x48 \) \
          \( -clone 0 -resize 64x64 -extent 64x64 \) \
          -delete 0 -alpha off -colors 256 favicon.ico
</samp></pre>
                </td>
              </tr>
            </table>
          </div><br>
          As mentioned only the "<code>favion.ico</code>" image found on the top level directory of a web site is generally used, however you can also specify the location of the link thumbnail image by adding the following HTML tag to the headers of your pages...
          <div align="center">
            <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="90%" bgcolor="#F8F8F8">
              <tr>
                <td>
                  <pre class="bg-light text-dark mx-4"><samp>
  &lt;LINK REL="icon" HREF="/path/to/favicon.ico" type="image/x-icon"&gt;
  &lt;LINK REL="shortcut" HREF="/path/to/favicon.ico" type="image/x-icon"&gt;
</samp></pre>
                </td>
              </tr>
            </table>
          </div>The "<code>/path/to/favicon.ico</code>" can be an absolute or partical URL/URI to the location from which the browser should pick up the web pages thumbnail image. The use of '<code>REL="shortcut"</code>' is specific to Internet Explorer (before IE9), and not offically part of the HTML specification. It is posible to merge the two HTML tags together using '<code>REL="shortcut icon"</code>' however by keeping the tags separate you can make use of a non-ICO image file format (such as SVG) for non-IE browsers, such as firefox. Remember if this html element is not used the "<code>favicon.ico</code>" file found on the top level directory of the web site is used instead (if present). The ICO image format is universally understood by all modern browsers. All except Internet Explorer also can use JPEG, PNG, and GIF image file formats, for the link thumbnail. A few like FireFox can even make use of animated GIF's or SVG image file formats. However as these latter formats can not typically hold multiple images at different resolutions and color counts, it is probably better to stick with the ICO file format for the "<code>favion.ico</code>" image.
          <hr>
          <!-- ---------------------------------------------------------------- -->
          <a name="non-im" id="non-im"></a>
          <h2>Other Non-IM Techniques</h2>The "<code>XV</code>" program I use for manual image processing also generates thumbnail images, in a sub-directory called "<code>.xvpics</code>". The format of the images in this directory is the programs own special thumbnail format (ignoring the filename suffix in that directory). These thumbnails are limited to 80x60 pixels so are a little on the "small" size (unless you hack "<code>xv</code>" to use larger thumbnails -- see link below). IM understands the "<code>xv</code>" thumbnail format (which is based on the "<code>NetPBM</code>" image format), so you can generate all the thumbnails quickly using XV, then magick the XV thumbnails of the JPEG images, into GIF images for further processing...
          <pre>
   xv -vsmap &               # generate thumbs with the "Update" button
   rm .xvpics/*.gif          # delete XV thumbs of existing "gif" thumbnails
   magick mogrify -format gif .xvpics/*.jpg
   mv .xvpics/*.gif .        # move the new "gif" thumbnails to original dir
</pre>If you are sick of the small size of XV thumbnails, particularly with larger modern displays, you can hack the XV code. See my <a href="http://www.ict.griffith.edu.au/anthony/info/graphics/xv_mods.hints">XV modification notes</a>, which allows you to get XV to use a larger thumbnail size. I myself use 120x90 pixel thumbnails.
          <hr>
          <!-- ---------------------------------------------------------------- -->
          <a name="fluff" id="fluff"></a>
          <h2>Further Processing -- Adding Fluff</h2>The above is only the beginning of what you can do to make your thumbnails more interesting. Beyond the basic thumbnail image you can add borders, rotations even with some random selection of style to make your thumbnail gallery that much more interesting. Additions to thumbnails like this, is what I term 'fluff', as in the extra lint you find covering your clothes after you wash your clothes. That is, it adds unnecessary extras to the thumbnail, but which can make web pages and index images that much more interesting. Be warned that many of the following methods and processing is very complex and my require a deeper knowledge of the various image processing options options of ImageMagick. <a name="labels" id="labels"></a>
          <h3>Adding image labels</h3>During your thumbnail creation you can also add labels either above, below or even on top of your thumbnail. This sort of image processing is however covered more thoroughly in <a href="../annotating/#labeling">Annotating Images with Labels</a>. Just remember to use the "<code><a href="../option_link.cgi?thumbnail">-thumbnail</a></code>" or "<code><a href="../option_link.cgi?strip">-strip</a></code>" rather than a "<code><a href="../option_link.cgi?resize">-resize</a></code>" in those examples.For example...
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr>
              <td width="100%" align="justify">
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre class="bg-light text-dark mx-4"><samp>
  magick thumbnail.gif \
          -background Lavender -fill navy -font Candice -pointsize 24 \
          label:Hatching   -gravity South -append \
          labeled.gif
</samp></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="labeled.gif"><img src="labeled.gif" align="middle" vspace="0" hspace="5" border="1" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>With the use of <a href="../fonts/">Compound Fonts</a> you can overlay some very fancy labels onto the image itself. Here for example I used a <a href="../fonts/#denser_soft_outline">Denser Soft Outline Font</a> technique to annotate the thumbnail, darkening the area around the text to ensure it always remains readable.
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr>
              <td width="100%" align="justify">
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre class="bg-light text-dark mx-4"><samp>
  magick -define jpeg:size=400x400  hatching_orig.jpg  -resize '120x200&gt;' \
      \( +clone -sample 1x1\! -alpha transparent -sample 1000x200\! \
         -font SheerBeauty -pointsize 72 -gravity Center \
         -strokewidth 8 -stroke black  -fill black  -annotate 0,0 '%c' \
         -channel RGBA -blur 0x8 \
         -strokewidth 1 -stroke white  -fill white  -annotate 0,0 '%c' \
         -fuzz 1% -trim +repage -resize 115x \
      \) -gravity North -composite           -strip annotated.gif
</samp></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="annotated.gif"><img src="annotated.gif" align="middle" vspace="0" hspace="5" border="1" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>Note how I do not use the pre-generated "<code>thumbnail.gif</code>" image, or use the <a href="../resize/#thumbnail">Thumbnail Resize Operator</a> to strip the profiles and comments from the image. I then used "<code><a href="../option_link.cgi?clone">+clone</a></code>", "<code><a href="../option_link.cgi?sample">+sample</a></code>", and "<code><a href="../option_link.cgi?alpha">-alpha</a></code>", to generate a larger transparent working canvas, which also contains a copy of the original image's meta-data. This lets me use the images 'comment' string with the annotate "<code><a href="../option_link.cgi?annotate">-annotate</a></code>" operator, to supply the text to overlay on the image. Only at the end after I have composed the text overlay do I clean up and "<code><a href="../option_link.cgi?strip">-strip</a></code>" that information. <a name="button" id="button"></a>
          <h3>Raised Button</h3>
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr valign="bottom">
              <td width="100%" align="justify">
                The "<code><a href="../option_link.cgi?raise">-raise</a></code>" operator was basically created with the one purpose of highlighting the edges of rectangular images to form a raised button. It is a simple, fast, and effective thumbnail transformation.
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre class="bg-light text-dark mx-4"><samp>
  magick thumbnail.gif  -raise 8   raised_button.gif
</samp></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="raised_button.gif"><img src="raised_button.gif" align="middle" vspace="0" hspace="5" border="1" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr valign="top">
              <td width="100%" align="justify">
                The same operator has a 'plus' form that can be used to make a sunken highlighting effect.
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre class="bg-light text-dark mx-4"><samp>
  magick thumbnail.gif  +raise 8   sunken_button.gif
</samp></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="sunken_button.gif"><img src="sunken_button.gif" align="middle" vspace="0" hspace="5" border="1" alt="[IM Output]"></a>
              </td>
            </tr>
          </table><a name="bubble" id="bubble"></a>
          <h3>Bubble Button</h3>With some trickiness the "<code><a href="../option_link.cgi?raise">-raise</a></code>" operator can be used to produce a smooth 'bubble-like' raised button.
          <div align="center">
            <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="90%" bgcolor="#F8F8F8">
              <tr>
                <td>
                  <pre class="bg-light text-dark mx-4"><samp>
  magick thumbnail.gif -fill gray50 -colorize 100% \
          -raise 8 -normalize -blur 0x8  bubble_overlay.png
  magick thumbnail.gif bubble_overlay.png \
          -compose hardlight -composite  bubble_button.png
</samp></pre>
                </td>
              </tr>
            </table><a href="thumbnail.gif"><img src="thumbnail.gif" align="middle" vspace="2" hspace="5" border="1" alt="[IM Output]"></a> <img src="../img_www/right.gif" width="20" height="20" align="middle" alt="==&gt;"> <a href="bubble_overlay.png"><img src="bubble_overlay.png" align="middle" vspace="2" hspace="5" border="1" alt="[IM Output]"></a> <img src="../img_www/right.gif" width="20" height="20" align="middle" alt="==&gt;"> <a href="bubble_button.png"><img src="bubble_button.png" align="middle" vspace="2" hspace="5" border="1" alt="[IM Output]"></a>
          </div>See <a href="../compose/#light">Light Composition Methods</a> for more information about this type of technique. For more effects like this see <a href="#self_frame_inside">Self Framing (Internal)</a> below, and to take it to the next level see <a href="#lighting_mask">Lighting Effect Mask</a> below. <a name="border" id="border"></a>
          <h3>Adding Borders</h3>The humble simple "<code><a href="../option_link.cgi?border">-border</a></code>" operator can be used to generate some a complex framework around an images.
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr>
              <td width="100%" align="justify">
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre class="bg-light text-dark mx-4"><samp>
  magick thumbnail.gif \
          -bordercolor black -border 3   -bordercolor white -border 2 \
          \( -background black -fill white -pointsize 24 \
             label:Hatching   -trim +repage \
             -bordercolor black -border 10 \
          \) -gravity South -append \
          -bordercolor black -border 10   -gravity South -chop 0x10 \
          border_framework.gif
</samp></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="border_framework.gif"><img src="border_framework.gif" align="middle" vspace="0" hspace="5" border="1" alt="[IM Output]"></a>
              </td>
            </tr>
          </table><a name="frame" id="frame"></a>
          <h3>Simple Frame</h3>
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr valign="top">
              <td width="100%" align="justify">
                In a similar way the "<code><a href="../option_link.cgi?frame">-frame</a></code>" operator makes it easy to add a frame around the image
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre class="bg-light text-dark mx-4"><samp>
  magick thumbnail.gif   -mattecolor peru  -frame 9x9+3+3  framed.gif
</samp></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="framed.gif"><img src="framed.gif" align="middle" vspace="0" hspace="5" border="1" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>This operator also has a lot more options to create a dozen or so different styles of frames. You can see examples of the possibilities in <a href="../crop/#frame">Frame, adding a 3D-like border</a>. <a name="montage" id="montage"></a>
          <h3>Montage Framing</h3>The montage command provides a much easier way of doing all the above, and much more. It cannot only generate thumbnails (or whole pages of thumbnails), but it can label the thumbnails to include information like filenames, disk size, and dimensions, or an user specified string.
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr valign="top">
              <td width="100%" align="justify">
                Here is a simple use of "<code>magick montage</code>" to generate a framed thumbnail.
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre class="bg-light text-dark mx-4"><samp>
  magick montage -define jpeg:size=240x200  -label '%c'  hatching_orig.jpg \
          -frame 6  -geometry '120x100&gt;'  montage_simple.gif
</samp></pre>
                    </td>
                  </tr>
                </table>The label comes from JPEG image file comment, which was added long ago to the image using the Non-IM command "<code>wrjpgcom</code>". See <a href="../formats/#jpg_non-im">Non-IM JPEG Processing</a> for more details.
              </td>
              <td>
                <a href="montage_simple.gif"><img src="montage_simple.gif" align="middle" vspace="0" hspace="5" border="1" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr valign="bottom">
              <td width="100%" align="justify">
                Even with just "<code>magick montage</code>" you can get really fancy with your thumbnail generation.
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre class="bg-light text-dark mx-4"><samp>
  magick montage -define jpeg:size=400x180  -label '%c' hatching_orig.jpg \
          -thumbnail '200x90&gt;' -geometry '130x100&gt;'  -mattecolor peru \
          -frame 6  -bordercolor skyblue  -font LokiCola  -pointsize 18 \
          montage_fancy.gif
</samp></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="montage_fancy.gif"><img src="montage_fancy.gif" align="middle" vspace="0" hspace="5" border="1" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>See the "<a href="../montage/">Montage, Arrays of Images</a>" for more details. You may be especially interesting in the <a href="../montage/#html">Montage HTML Thumbnail Image Maps</a> example. This creates a HTML index page of thumbnails in which clicking on the thumbnail will bring up the original image, in the same directory. <a name="soft_edges" id="soft_edges"></a>
          <h3>Soft and Blurred Edges</h3>The <a href="../transform/#vignette">Vignette Operator</a> provides a simple means to add a blurry edge around an image.
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr>
              <td width="100%" align="justify">
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre class="bg-light text-dark mx-4"><samp>
  magick thumbnail.gif -alpha set \
          -background none  -vignette 0x4  vignette.png
</samp></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="vignette.png"><img src="vignette.png" align="middle" vspace="0" hspace="5" border="0" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>Of course as this thumbnail uses semi-transparent color so it needs to be saved in the PNG format. The <a href="../morphology/#distance">Morphology Distance</a> method provides a true transparent 'Feathering' of an image's edges.
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr>
              <td width="100%" align="justify">
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre class="bg-light text-dark mx-4"><samp>
  magick thumbnail.gif -alpha set -virtual-pixel transparent -channel A \
          -morphology Distance Euclidean:1,10\! +channel feathered.png
</samp></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="feathered.png"><img src="feathered.png" align="middle" vspace="0" hspace="5" border="0" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>The maximum distance of the transparent area is controled by the special <code>10\!</code>' distance scaling flag. This was only added in IM v6.6.1-6. This has the added advantage of also working for shaped images, though a more complex initialization is needed to correctly preserve and anti-aliased pixels in the distance formula. See <a href="../morphology/#distance_feather">Feathering Shapes using Distance</a> for more details. The feathering here is a pure linear gradient, and can be further adjusted using <a href="../color_mods/#sigmoidal">Sigmoidal Non-linearity Contrast Operator</a> to give it a smoother more tapered look in a number of different ways. You can also <a href="../blur/#feathering">Feather Images using Blur</a>, using the same method of adding a transparent <a href="../misc/#virtual-pixel">Virtual Pixels</a> before bluring just the alpha channel. This generates a more softer feathering to the image, as well as noticeably rounded the corners of the image.
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr>
              <td width="100%" align="justify">
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre class="bg-light text-dark mx-4"><samp>
  magick thumbnail.gif -alpha set -virtual-pixel transparent \
          -channel A -blur 0x8  -level 50%,100% +channel  soft_edge.png
</samp></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="soft_edge.png"><img src="soft_edge.png" align="middle" vspace="0" hspace="5" border="0" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>The extra "<code><a href="../option_link.cgi?level">-level</a></code>" operation (adjusting only the transparency channel) ensures the edge becomes fully transparent, rather than only half transparent. However it does fall sharply toward zero at the actual edge, due to the sigmoidal-like curve that blur generates. It also has an additive effect in the corners, causing them to become rounded, while with a shaped image with a sharp concavity, it can cause fully-transparent pixels to become semi-transparent. As such for shapes you may need to mask the result against the original image (using <a href="../compose/#dstin">Dst-In Composition</a>). For rectangular thumbnails however the result is satisfactory.You can see another example of using this type of feathering in <a href="../layers/#layer_thumbnails">Layered Thumbnails</a>. If instead of doing a level adjustment on the blurred feather, you can <a href="../quantize/#threshold">Threshold</a> the blurred alpha channel at '<code>50%</code>', so as to add psuedo-rounded corners to the above thumbnail image.
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr>
              <td width="100%" align="justify">
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre class="bg-light text-dark mx-4"><samp>
  magick thumbnail.gif -alpha set -virtual-pixel transparent -channel A \
          -blur 0x8  -threshold 50% +channel rounded_corner_blur.gif
</samp></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="rounded_corner_blur.gif"><img src="rounded_corner_blur.gif" align="middle" vspace="0" hspace="5" border="0" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>While very simple, the result is not a really nice way to round off the corners of the image. First the corners are not actually circular, but a 'hyperbolic' curve. Second the result is not a smooth anti-aliased curve, but shows 'jaggies' caused by the aliasing effect of <a href="../quantize/#threshold">Threshold Operation</a>. This image can however be save to a GIF file format. See <a href="../formats/#boolean_trans">GIF Boolean Transparency</a> for details. Also note that the "<code><a href="../option_link.cgi?blur">-blur</a></code>" operation can become very slow when you work with a large argument for generating a larger rounded corner. As such this method of rounding corners on a large scale is not recommended at all. For a more unusual blurred edge effect, you can use a <a href="../blur/#radial-blur">Radial Blur</a> on just the alpha channel.
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr>
              <td width="100%" align="justify">
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre class="bg-light text-dark mx-4"><samp>
  magick thumbnail.gif -alpha set -virtual-pixel transparent \
          -channel A -radial-blur 0x45 +channel  radial_blur_edge.png
</samp></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="radial_blur_edge.png"><img src="radial_blur_edge.png" align="middle" vspace="0" hspace="5" border="0" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>This works better for perfectly square images. As the amount of angled blur becomes larger, you will eventually generate a circular like Vignette edge.
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr>
              <td width="100%" align="justify">
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre class="bg-light text-dark mx-4"><samp>
  magick thumbnail.gif -alpha set -virtual-pixel transparent \
          -channel A -radial-blur 0x100 +channel  radial_blur_vignette.png
</samp></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="radial_blur_vignette.png"><img src="radial_blur_vignette.png" align="middle" vspace="0" hspace="5" border="0" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>The two step-like artifacts that can be seen is caused by the two image size dimensions. No 'step' will be seen for a square image. Adding a little extra normal blur to the last example can also improve the step problem. <a name="rounded" id="rounded"></a>
          <h3>Rounded and Shaped Corners</h3>While thresholding a <a href="#soft_edges">Soft Blurred Edge</a> (see above) will generate a rounded corner suitable for the Boolean transparency of GIF, it does not generate a smooth 'anti-aliased' corner. The proper way to generate an image with rounded corners, or of any other shape is to actually cut out each corner using a mask of the shape wanted. The following method from Leif strand &lt;leif@sitelogic.fi&gt; that multiplys a full image mask to generate the appropriate result.
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr>
              <td width="100%" align="justify">
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre class="bg-light text-dark mx-4"><samp>
  magick thumbnail.gif \
     \( +clone  -alpha extract \
        -draw 'fill black polygon 0,0 0,15 15,0 fill white circle 15,15 15,0' \
        \( +clone -flip \) -compose Multiply -composite \
        \( +clone -flop \) -compose Multiply -composite \
     \) -alpha off -compose CopyOpacity -composite  rounded_corners.png
</samp></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="rounded_corners.png"><img src="rounded_corners.png" align="middle" vspace="0" hspace="5" border="0" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>Basically extracts the white transparency mask from the original image, with just one black rounded corner. This is then flipped and flopped to produce a mask with all four corners rounded. And finally that mask is applied to the original image. For much larger images, you may be better off applying a much smaller mask to each individual corner to reduce the total amount of processing needed. That is more individual processing steps, but overall less processing of the actual pixels. For example, here is the same thing but cutting a simple drawn triangular shape from each corner. This will work with much larger images.
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr>
              <td width="100%" align="justify">
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre class="bg-light text-dark mx-4"><samp>
  magick thumbnail.gif -alpha set  -compose DstOut \
      \( -size 20x15 xc:none -draw "polygon 0,0  0,14 19,0" \
         -write mpr:triangle  +delete \) \
      \( mpr:triangle             \) -gravity northwest -composite \
      \( mpr:triangle -flip       \) -gravity southwest -composite \
      \( mpr:triangle -flop       \) -gravity northeast -composite \
      \( mpr:triangle -rotate 180 \) -gravity southeast -composite \
      corner_cutoff.png
</samp></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="corner_cutoff.png"><img src="corner_cutoff.png" align="middle" vspace="0" hspace="5" border="0" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>If you don't want transparency, but some other color, you can still do the above and then <a href="../masking/#remove">Remove Transparency</a>. This can be important for JPEG images. However an even simpler solution (in terms of complexity and memory usage) has been found in a <a href="../forum_link.cgi?t=17626">IM forum discussion</a>. This overlays colored corners ('<code>Red</code>' in this case) rather than making them transparent.
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr>
              <td width="100%" align="justify">
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre class="bg-light text-dark mx-4"><samp>
  magick thumbnail.gif \
    \( +clone -crop 16x16+0+0  -fill white -colorize 100% \
       -draw 'fill black circle 15,15 15,0' \
       -background Red  -alpha shape \
       \( +clone -flip \) \( +clone -flop \) \( +clone -flip \) \
     \) -flatten  rounded_corners_red.png
</samp></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="rounded_corners_red.png"><img src="rounded_corners_red.png" align="middle" vspace="0" hspace="5" border="0" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>Unfortunately this method can not be used to simply 'erase' the image corners to transparency, due to an interaction with a 'background canvas' of the <a href="../layers/#flatten">Flatten Operation</a>, a future layering operator may solve this.
          <table border="0" cellspacing="0" cellpadding="0" width="90%" align="center">
            <tr valign="top">
              <td><img src="../img_www/warning.gif" width="28" height="28"><img src="../img_www/space.gif" width="12" height="16"></td>
              <td align="justify" width="100%"><font size="-1"><i>The last example will fail for versions of IM before v6.6.6-5 due to both the "<code><a href="../option_link.cgi?flip">-flip</a></code>" and the "<code><a href="../option_link.cgi?flop">-flop</a></code>" operators not handling the virtual canvas offset correctly.</i></font></td>
            </tr>
          </table>Using a <a href="../distorts/#polar_tricks">Polar Cycle Trick</a> we can generate a perfect anti-aliased circle mask for any sized thumbnail. Of course we will only use the distorted image as a mask for the original image, so as to get the best result.
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr>
              <td width="100%" align="justify">
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre class="bg-light text-dark mx-4"><samp>
  magick thumbnail.gif -alpha set \
    \( +clone -distort DePolar 0 \
       -virtual-pixel HorizontalTile -background None -distort Polar 0 \) \
    -compose Dst_In -composite -trim +repage circle_masked.png
</samp></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="circle_masked.png"><img src="circle_masked.png" align="middle" vspace="0" hspace="5" border="0" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>We will take this style of image processing further in <a href="#rounded_border">Border with Rounded Corners</a> below. There we not only cutting out corners, but also overlay appropriate framing images. <a name="torn" id="torn"></a>
          <h3>Torn Paper Edge</h3>Leif strand &lt;leif@sitelogic.fi&gt;, contributed the following IM code to generate an edge that looks like it was torn from a fibrous paper (like newspaper)...
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr>
              <td width="100%" align="justify">
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre><code execute="" random="">
  magick thumbnail.gif \
          \( +clone -alpha extract -virtual-pixel black \
             -spread 10 -blur 0x3 -threshold 50% -spread 1 -blur 0x.7 \) \
          -alpha off -compose Copy_Opacity -composite torn_paper.png
</code></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="torn_paper.png"><img src="torn_paper.png" align="middle" vspace="0" hspace="5" border="0" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>One improvement may be to make it look like you ripped it from a newspaper corner.
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr>
              <td width="100%" align="justify">
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre><code execute="" random="">
  magick thumbnail.gif -bordercolor linen -border 8x8 \
          -background Linen  -gravity SouthEast -splice 10x10+0+0 \
          \( +clone -alpha extract -virtual-pixel black \
             -spread 10 -blur 0x3 -threshold 50% -spread 1 -blur 0x.7 \) \
          -alpha off -compose Copy_Opacity -composite \
          -gravity SouthEast -chop 10x10   torn_paper_corner.png
</code></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="torn_paper_corner.png"><img src="torn_paper_corner.png" align="middle" vspace="0" hspace="5" border="0" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>This could be improved by adding 'paper' colored borders and a curved shaped mask, so that it looks like the image was ripped roughly by hand. Adding a 'soft shadow' (see next) will also 'lift' the resulting image from the background, making it look like it was a separate piece. As always, suggestions and contributions are welcome. <a name="shadow" id="shadow"></a>
          <h3>Adding a Shadow</h3>The "<code><a href="../option_link.cgi?shadow">-shadow</a></code>" operator makes the <a href="../blur/#shadow">Generation of Shadows</a> of any shaped image easy. For example, here an I add a semi-transparent colored shadow, to the thumbnail.
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr>
              <td width="100%" align="justify">
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre class="bg-light text-dark mx-4"><samp>
  magick thumbnail.gif -alpha set \
          \( +clone -background navy -shadow 60x0+4+4 \) +swap \
          -background none -mosaic   shadow_hard.gif
</samp></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="shadow_hard.gif"><img src="shadow_hard.gif" align="middle" vspace="0" hspace="5" border="0" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr valign="bottom">
              <td width="100%" align="justify">
                But you can just as easily create soft fuzzy shadows, too.
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre class="bg-light text-dark mx-4"><samp>
  magick -page +4+4 thumbnail.gif -alpha set \
          \( +clone -background navy -shadow 60x4+4+4 \) +swap \
          -background none -mosaic     shadow_soft.png
</samp></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="shadow_soft.png"><img src="shadow_soft.png" align="middle" vspace="0" hspace="5" border="0" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>Note that I again used a PNG format image for the thumbnails output. That is because the shadowed image will contain a lot of semi-transparent pixels, which GIF cannot handle. (Yes I am repeating myself but it is important). If you do plan to use GIF or JPG format you will need to use a more appropriate "<code><a href="../option_link.cgi?background">-background</a></code>" color for the web page or larger canvas on which you plan to display your thumbnail, as these formats do not handle semi-transparent colors. Warning, while the above works for individual thumbnails, it will generally fail when you want to layer multiple thumbnails over the top of each other. The reason is that shadows do not accumulate together, in the same way that normal images do. To see how to handle shadows from multiple layered images see <a href="../layers/#layer_shadow">Layers of Shadows</a>. <a name="thickness" id="thickness"></a>
          <h3>Adding Some Thickness</h3>Adding a thickness to an image or a shape look a bit like adding a hard shadow (see above), but isn't quite the same, and needs some extra work to get right. This is actually very tricky as we create a colored, mask of the image which is then replicated multiple times and layered under the original image (using '<code>DstOver</code>' composition) with increasing offsets to give the image thickness.
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr>
              <td width="100%" align="justify">
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre class="bg-light text-dark mx-4"><samp>
  magick thumbnail.gif -alpha set \
          \( +clone -fill DarkSlateGrey -colorize 100% -repage +0+1 \) \
          \( +clone -repage +1+2 \) \
          \( +clone -repage +1+3 \) \
          \( +clone -repage +2+4 \) \
          \( +clone -repage +2+5 \) \
          \( +clone -repage +3+6 \) \
          -background none -compose DstOver -mosaic  thickness.gif
</samp></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="thickness.gif"><img src="thickness.gif" align="middle" vspace="0" hspace="5" border="0" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>You get the idea. Each '<code>\( +clone ... \)</code>' line adds one extra pixel to the image in a south by south-easterly direction. Also as no semi-transparent pixels are involved (at least for a rectangular image) you can use the GIF image format for the result. The major problem with this technique is that it is hard to specify a thickness as a variable argument or at different angles, unless you write a specific script to add thickness. Also the edge of the angled parts of the thickness is not anti-aliased, so there is lots of room for improvement. <a name="polaroid" id="polaroid"></a>
          <h3>Polaroid-like Thumbnails</h3>You can make your thumbnail image look like a polaroid photo, give it a shadow, and even rotate it a little so as to appear to be just sitting on a table.
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr>
              <td width="100%" align="justify">
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre class="bg-light text-dark mx-4"><samp>
  magick thumbnail.gif \
          -bordercolor white  -border 6 \
          -bordercolor grey60 -border 1 \
          -background  none   -rotate 6 \
          -background  black  \( +clone -shadow 60x4+4+4 \) +swap \
          -background  none   -flatten \
          poloroid.png
</samp></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="poloroid.png"><img src="poloroid.png" align="middle" vspace="0" hspace="5" border="0" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr>
              <td width="100%" align="justify">
                A more complex version of the above was added to IM v6.3.1-6 as a "<code><a href="../option_link.cgi?polaroid">-polaroid</a></code>" transformation operator. For example...
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre><code execute="" random="">
  magick thumbnail.gif -bordercolor snow -background black +polaroid \
          poloroid_operator.png
</code></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="poloroid_operator.png"><img src="poloroid_operator.png" align="middle" vspace="0" hspace="5" border="0" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>Note that the image not only has the polaroid frame, but the photo has also been given a bit of a 'curl' with appropriate shadow adjustments, giving the resulting image more depth. The plus (+) form uses a randomized angle, while the normal minus (-) form lets you provide the angle of rotation. Special thanks to Timothy Hunter for the idea behind this technique.
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr>
              <td width="100%" align="justify">
                You can even add a "<code><a href="../option_link.cgi?caption">-caption</a></code>", set your own shadow color, specify your own rotation (or none at all).
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre class="bg-light text-dark mx-4"><samp>
  magick -caption '%c' hatching_orig.jpg -thumbnail '120x120&gt;' \
          -font Ravie -gravity center -bordercolor Lavender \
          -background navy  -polaroid -0     poloroid_caption.png
</samp></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="poloroid_caption.png"><img src="poloroid_caption.png" align="middle" vspace="0" hspace="5" border="0" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>For more information on using this operator see <a href="../transform/#polaroid">Complex Polaroid Transformation</a>. For these examples though, I'll continue to use a DIY creation method, as I need finer control of the borders and shadowing effects to demonstrate proper photo 'stacking'. And here we go... By making multiple copies of the photograph, (or using other images), and adding polaroid borders, you can then randomly rotate and stack them up to produce a nice looking pile of photos.
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr>
              <td width="100%" align="justify">
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre><code execute="" random="">
  magick thumbnail.gif \
     -bordercolor white  -border 6 \
     -bordercolor grey60 -border 1 \
     -bordercolor none  -background  none \
     \( -clone 0 -rotate `magick null: -format '%[fx:rand()*30-15]' info:` \) \
     \( -clone 0 -rotate `magick null: -format '%[fx:rand()*30-15]' info:` \) \
     \( -clone 0 -rotate `magick null: -format '%[fx:rand()*30-15]' info:` \) \
     \( -clone 0 -rotate `magick null: -format '%[fx:rand()*30-15]' info:` \) \
     -delete 0  -border 100x80  -gravity center \
     -crop 200x160+0+0  +repage  -flatten  -trim +repage \
     -background black \( +clone -shadow 60x4+4+4 \) +swap \
     -background none  -flatten \
     poloroid_stack.png
</code></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="poloroid_stack.png"><img src="poloroid_stack.png" align="middle" vspace="0" hspace="5" border="0" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>
          <table border="0" cellspacing="0" cellpadding="0" width="90%" align="center">
            <tr valign="top">
              <td><img src="../img_www/reminder.gif" width="20" height="16"><img src="../img_www/space.gif" width="20" height="16"></td>
              <td align="justify" width="100%"><font size="-1"><i>The "&nbsp;<code>`magick ...`</code>&nbsp;" embedded command in the above example generates a random floating point number from -15 to +15. For more infomation on using IM as a mathematical calculator see <a href="../transform/#fx_escapes">FX Expressions</a>. An alturnative is to assign random numbers to shell variables and substitute them into the above command instead.</i></font></td>
            </tr>
          </table>Of course you could substitute a set of different images rather than repeating the same image when creating the stack. Or select a set of rotates angles so they are all reasonably different, or are more pleasing to look at. If you are really good you can even offset the rotated images (jitter their position a little) so they are not all stacked up perfectly centered. But you get the basic idea. If you really want to avoid the use of the PNG format, due to its current problems with <i>some</i> browsers, you can use the GIF image format. To do this you must be willing to accept some color limitations, and know the exact background color on which the image will be displayed. The '<code>LightSteelBlue</code>' color in the case of these pages.
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr>
              <td width="100%" align="justify">
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre class="bg-light text-dark mx-4"><samp>
  magick thumbnail.gif \
          -bordercolor white  -border 6 \
          -bordercolor grey60 -border 1 \
          -background  none   -rotate -9 \
          -background  black  \( +clone -shadow 60x4+4+4 \) +swap \
          -background  LightSteelBlue  -flatten    poloroid.gif
</samp></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="poloroid.gif"><img src="poloroid.gif" align="middle" vspace="0" hspace="5" border="0" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>For details about this technique (and more) see <a href="../formats/#bgnd">GIF images on a solid color background</a>. The above 'stacked polaroid' technique graciously provided by Ally of <a href="http://www.allystrip.com/">Ally's Trip</a> and Stefan Nagtegaal for <a href="http://sempre-crescendo.nl/">Muziekvereniging Sempre Crescendo</a>, both of which use Polaroid-like thumbnails extensively on their web sites. In the <a href="../forum_link.cgi?t=7530">IM User Forum</a>, the user <i><a href="../forum_link.cgi?u=7473">grazzman</a></i> went a little further by overlaying images onto a rotating canvas to create a photo spread.
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr>
              <td width="100%" align="justify">
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre class="bg-light text-dark mx-4"><samp>
  magick -size 150x150 xc:none -background none \
          -fill white -stroke grey60 \
          -draw "rectangle 0,0 130,100" thumbnail.gif \
                -geometry +5+5 -composite -rotate -10 \
          -draw "rectangle 0,0 130,100" thumbnail.gif \
                -geometry +5+5 -composite -rotate -10 \
          -draw "rectangle 0,0 130,100" thumbnail.gif \
                -geometry +5+5 -composite -rotate +10 \
          -trim +repage -background LightSteelBlue -flatten \
          poloroid_spread.gif
</samp></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="poloroid_spread.gif"><img src="poloroid_spread.gif" align="middle" vspace="0" hspace="5" border="0" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>Of course for a photo spread like this you really need to use a set of different photos rather using the same image over and over as I did here. There are a few caveats you may like to consider with this technique.
          <ul>
            <li>The framing has been hardcoded into the above, and depends on the size of the thumbnail image. In a real application the framing may be moved to the thumbnail generation stage rather than in the above photo spread.</li>
            <li>As "<code><a href="../option_link.cgi?rotate">-rotate</a></code>" also expands the size of the canvas the position in which images are added is changing, unless you place them using an offset from "<code><a href="../option_link.cgi?gravity">-gravity</a> center</code>" position.</li>
            <li>And finally, a constantly rotating the background frame is not a good idea in terms of quality. Rotating an already rotated image, adds more pixel level distortions to the result than doing one rotate for each separate image before being overlaid.</li>
          </ul>A similar randomized stacking of photos over a larger area was developed for <a href="http://stason.org/photos/gallery/">Stas Bekman's Photography</a>, but with a different bordering technique. A more generalized method for creating some sort of ordered or programmed layout of photos and images, is shown and described in <a href="../layers/#layer_examples">Examples of Image Layering</a>, as well as in <a href="../photos/#overlap">Overlapping Photos</a>.
          <hr>
          <!-- ---------------------------------------------------------------- -->
          <a name="framing" id="framing"></a>
          <h2>Framing Techniques</h2>Here we will look at some advanced framing techniques that use some very advanced knowledge of how IM works to achieve the desired results. <a name="self_frame" id="self_frame"></a>
          <h3>Self Framing (External)</h3><b>Self Framing</b> is a technique that can be used to frame an image, using the image itself to generate the framing colors and patterns. That is, to say the added frame is not fixed, but varies so as to roughly match the image being framed. You can do this in two ways. Extend the original image so as to create, an <i>External Frame</i>, or use part of the actual image itself to create an <i>Internal Frame</i>. For example, if we enlarge the image and dim it, before overlaying the original image on top, we get a very nice looking frame.
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr valign="top">
              <td width="100%" align="justify">
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre class="bg-light text-dark mx-4"><samp>
  magick thumbnail.gif \
          \( -clone 0 -resize 130% +level 20%x100% \) \
          \( -clone 0 -bordercolor black -border 1x1 \) \
          -delete 0 -gravity center -composite  self_bordered.gif
</samp></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="self_bordered.gif"><img src="self_bordered.gif" align="middle" vspace="0" hspace="5" border="1" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>
          <table border="0" cellspacing="0" cellpadding="0" width="90%" align="center">
            <tr valign="top">
              <td><img src="../img_www/reminder.gif" width="20" height="16"><img src="../img_www/space.gif" width="20" height="16"></td>
              <td align="justify" width="100%"><font size="-1"><i>Instead of using <a href="../color_mods/#level_plus">Level Adjustments</a> to brighten (or darken) the framing image, an alturnative way of making the border a lighter or darker color is to <a href="../color_mods/#colorize">Color Tint</a> the frame using something like...<br>
              "<code>-fill white -colorize 30%</code>"</i></font></td>
            </tr>
          </table>Another way of color tinting the image to generate the frame, you can simply get IM to overlay a semi-transparent <a href="../crop/#frame">Frame</a> on top of the enlarged image. However this requires you to know the size of the thumbnail so as to exactly resize it exactly the right amount to accommodate the generated frame.
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr>
              <td width="100%" align="justify">
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre class="bg-light text-dark mx-4"><samp>
  magick thumbnail.gif \
          \( -clone 0 -resize 140x110\! \) \
          \( -clone 0 -bordercolor black -border 1x1 \
                      -mattecolor '#8884' -frame 9x9+0+9 \) \
          -delete 0 -composite  self_framed.gif
</samp></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="self_framed.gif"><img src="self_framed.gif" align="middle" vspace="0" hspace="5" border="1" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>A variation of the above uses the special <a href="../distorts/#distort_viewport">viewport</a> control and the default <a href="../misc/#edge">Virtual Pixel, Edge</a> setting to extend the edge of a blurred image to generate the extenal frame.
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr>
              <td width="100%" align="justify">
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre class="bg-light text-dark mx-4"><samp>
  magick thumbnail.gif \( +clone \
             -set option:distort:viewport 150x120-15-15 \
             -virtual-pixel Edge    -distort SRT 0  +repage \
             -blur 0x3 +level 20%,100% \) \
          \( -clone 0 -bordercolor white -border 1 \) \
          -delete 0 -gravity center -compose over -composite \
          self_blurred_edge.gif
</samp></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="self_blurred_edge.gif"><img src="self_blurred_edge.gif" align="middle" vspace="0" hspace="5" border="1" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>Just a word of warning. A small edge defect (such as a tree or leaf) can produce some undesirable results in a frame that was generated using only the edge of the image. The viewport does need to know the size of the original image to enlarge and offset that viewport the appropriate amount. However you can use <a href="../transform/#fx_escapes">FX Escape Expressions</a> to calculate the viewport size (see examples below). An alternative is to use a blurred <a href="../misc/#dither">Virtual Pixel, Dither</a> in the above example. This will spread the colors further and be not quite so 'edgy'. But if you add blurs before and after the expansion you use the dither to produce a cloth-like effect.
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr>
              <td width="100%" align="justify">
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre class="bg-light text-dark mx-4"><samp>
  magick thumbnail.gif \( +clone  -blur 0x3 \
             -set option:distort:viewport '%[fx:w+30]x%[fx:h+30]-15-15' \
             -virtual-pixel Dither  -distort SRT 0  +repage \
             -blur 0x0.8  +level 20%,100% \) \
          \( -clone 0 -bordercolor white -border 1 \) \
          -delete 0 -gravity center -compose over -composite \
          self_blurred_dither.gif
</samp></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="self_blurred_dither.gif"><img src="self_blurred_dither.gif" align="middle" vspace="0" hspace="5" border="1" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>The first blur modulates the average color, while the second adjusts how 'pixelated' or smooth the dither pattern is. Here is another example, this time using <a href="../misc/#mirror">Virtual Pixel, Mirror</a>, with a <a href="#soft_edges">Soft Edge</a> (blackened) which turned out to work very well for this specific image.
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr>
              <td width="100%" align="justify">
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre class="bg-light text-dark mx-4"><samp>
  magick thumbnail.gif  \( +clone \
             -set option:distort:viewport '%[fx:w+30]x%[fx:h+30]-15-15' \
             -virtual-pixel Mirror -distort SRT 0 +repage \
             -alpha set -virtual-pixel transparent \
                 -channel A -blur 0x8 +channel \
             -background Black -flatten \) \
          +swap -gravity center -compose over -composite \
          self_mirror.gif
</samp></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="self_mirror.gif"><img src="self_mirror.gif" align="middle" vspace="0" hspace="5" border="1" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>In all the above cases the frames are generated from the same image, which is then combined together to produce a frame based on the colors coming from the original image. The framing border is thus unique and matches each thumbnail image that is framed. Fred Weinhaus has created a script "<code><a href="http://www.fmwconcepts.com/imagemagick/imageborder/">imageborder</a></code>" to make self framing images easier, with borders being generated from blurred magnifications of the original image, or some form of <a href="../misc/#virtual-pixel">Virtual Pixel</a> setting defining the contents. <a name="self_frame_inside" id="self_frame_inside"></a>
          <h3>Self Framing (Internal)</h3>Rather than enlarging the image to add the new border, we can magick parts of the image itself into a border. We have already seen some techniques of adding a frame, inside the image itself. The <a href="#button">Raised Button</a> and <a href="#bubble">Bubble Button</a> techniques do this, using the "<code><a href="../option_link.cgi?raise">-raise</a></code>" operator. Here we generate a lighter blurred version of the original image which is then overlaid using a mask also generated from the original image. A white edge is then added to separate that lighter blured version from the center un-modified part of the image.
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr>
              <td width="100%" align="justify">
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre class="bg-light text-dark mx-4"><samp>
  magick thumbnail.gif \( +clone -blur 0x3 +level 20%,100% \) \
          \( +clone -gamma 0 -shave 10x10 \
             -bordercolor white -border 10x10 \) \
          -composite \
          \( +clone -gamma 0 -shave 10x10 \
             -bordercolor white -border 1x1 \
             -bordercolor black -border 9x9 \) \
          -compose screen -composite \
          self_blurred_border.gif
</samp></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="self_blurred_border.gif"><img src="self_blurred_border.gif" align="middle" vspace="0" hspace="5" border="1" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>You can also use the <a href="../crop/#frame">Frame Operator</a> to achieve something a little different to the previously seen <a href="#button">Button</a> effects. The trick is to first <a href="../crop/#shave">Shave</a> the original image before applying. For example, here I make a copy of the original image, shave and frame it using transparent frame, before overlaying that over the original image.
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr>
              <td width="100%" align="justify">
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre class="bg-light text-dark mx-4"><samp>
  magick thumbnail.gif \( +clone -shave 10x10 \
            -alpha set -mattecolor '#AAA6' -frame 10x10+3+4 \
          \) -composite  inside_frame_trans.gif
</samp></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="inside_frame_trans.gif"><img src="inside_frame_trans.gif" align="middle" vspace="0" hspace="5" border="1" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>The problem with this is that you will always 'lighten' or 'darken' (de-contrast) the flat parts of frame around the original image. To avoid this we can use the same technique as the <a href="#bubble">Bubble Button</a> technqiue. We generate a frame on a perfect grey canvas, and modiy it so as to generate a <a href="../compose/#light">Lighting Effects Composition Mask</a>, to adjust the colors of the original image. For example, here I use a '<code><a href="../compose/#vividlight">VividLight</a></code>' composition with the framed mask image to better preserve primary colors.
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr>
              <td width="100%" align="justify">
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre class="bg-light text-dark mx-4"><samp>
  magick thumbnail.gif \
          \( +clone -shave 10x10 -fill gray50 -colorize 100% \
            -mattecolor gray50 -frame 10x10+3+4 \
          \) -compose VividLight -composite  inside_frame_light.gif
</samp></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="inside_frame_light.gif"><img src="inside_frame_light.gif" align="middle" vspace="0" hspace="5" border="1" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>Like the <a href="#bubble">Bubble Button</a> you can also blur the lighting mask before applying. Here I used more normal '<code><a href="../compose/#hardlight">HardLight</a></code>' compose which does not enhance primary colors, with a blurred frame lighting mask.
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr>
              <td width="100%" align="justify">
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre class="bg-light text-dark mx-4"><samp>
  magick thumbnail.gif \
          \( +clone -shave 10x10 -fill gray50 -colorize 100% \
            -mattecolor gray50 -frame 10x10+3+4 -blur 0x2 \
          \) -compose HardLight -composite  inside_frame_blur.gif
</samp></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="inside_frame_blur.gif"><img src="inside_frame_blur.gif" align="middle" vspace="0" hspace="5" border="1" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>
          <table border="0" cellspacing="0" cellpadding="0" width="90%" align="center">
            <tr valign="top">
              <td><img src="../img_www/warning.gif" width="28" height="28"><img src="../img_www/space.gif" width="12" height="16"></td>
              <td align="justify" width="100%"><font size="-1"><i>Some <a href="../compose/#light">Light Composition Methods</a> may require you to <a href="../basics/#swap">Swap the Images</a> before you compose them to get the correct lighting effect.</i></font></td>
            </tr>
          </table>To take this type of effect even further, producing much more complex results see the advanced <a href="#lighting_mask">Lighting Effect Mask</a>. <a name="border_overlay" id="border_overlay"></a>
          <h3>Simple Border Overlay</h3>One simple type of framing is to create a fancy frame, or shaped image into which you can place your image, under the frame. For example, here we generate a simple frame slightly larger than our image with a fancy shaped hole. The shape was extracted from the '<code>WebDings</code>' font (character '<code>Y</code>'), but there are a lot of possible sources for fancy shapes that could be used for picture framing.
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr>
              <td width="100%" align="justify">
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre class="bg-light text-dark mx-4"><samp>
  magick -size 120x140 -gravity center -font WebDings label:Y \
          -negate -channel A -combine +channel -fill LightCoral -colorize 100% \
          -background none -fill none -stroke firebrick -strokewidth 3 label:Y \
          -flatten +gravity -chop 0x10+0+0 -shave 0x10 +repage border_heart.png
</samp></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="border_heart.png"><img src="border_heart.png" width="120" height="110" align="middle" vspace="0" hspace="5" border="1" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>For other ways of generating an edge on an existing shaped image see the <a href="../transform/#edge">Edge Transform</a>.
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr valign="bottom">
              <td width="100%" align="justify">
                You can also optionally give the frame a little depth by using a <a href="../blur/#shadow">Shadow Effect</a>.
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre class="bg-light text-dark mx-4"><samp>
  magick border_heart.png  \( +clone -background black -shadow 60x3+3+3 \) \
          -background none -compose DstOver -flatten   border_overlay.png
</samp></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="border_overlay.png"><img src="border_overlay.png" width="120" height="110" align="middle" vspace="0" hspace="5" border="1" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr valign="bottom">
              <td width="100%" align="justify">
                Now that we have a simple overlay frame, we can underlay the image in the center, underneath the frame by using a '<code><a href="../compose/dstover">DstOver</a></code>' composition.
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre class="bg-light text-dark mx-4"><samp>
  magick border_overlay.png  thumbnail.gif \
          -gravity center -compose DstOver -composite   border_overlaid.jpg
</samp></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="border_overlaid.jpg"><img src="border_overlaid.jpg" width="120" height="110" align="middle" vspace="0" hspace="5" border="1" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>Now you can generate a library of pre-prepared frames to use with your images, such as this <a href="../images/autumn_leaves.png">Autumn Leaves Image</a>.
          <div align="center">
            <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="90%" bgcolor="#F8F8F8">
              <tr>
                <td>
                  <pre class="bg-light text-dark mx-4"><samp>
    magick thumbnail.gif  autumn_leaves.png +swap \
            -gravity center -compose DstOver -composite \
            border_leaves.gif
</samp></pre>
                </td>
              </tr>
            </table><a href="thumbnail.gif"><img src="thumbnail.gif" width="120" height="90" align="middle" vspace="5" hspace="10" border="1" alt="[IM Text]"></a> <img src="../img_www/plus.gif" width="20" height="20" align="middle" alt=" + "> <a href="../images/autumn_leaves.png"><img src="../images/autumn_leaves.png" width="140" height="105" align="middle" vspace="5" hspace="10" border="1" alt="[IM Text]"></a> <img src="../img_www/right.gif" width="20" height="20" align="middle" alt="==&gt;"> <a href="border_leaves.gif"><img src="border_leaves.gif" width="140" height="105" align="middle" vspace="5" hspace="10" border="1" alt="[IM Text]"></a>
          </div>Note that I swapped the order of the images and used '<code><a href="../compose/#dstover">DstOver</a></code>' to place the second, main image 'under' the frame. That way it is the frame that determines the final size of the image, and not the original image. However doing this would also loose any meta-data the main image has (for the same reason). If you really want to preserve the thumbnails meta-data (such as labels and comments, such as a copyright message), then the best idea is to <a href="#pad">Pad Out the Thumbnail</a> to the same size as the frame, than this use the default '<code><a href="../compose/#over">Over</a></code>' composition to overlay the frame. That way the thumbnail is the 'destination' image and its image meta-data is preserved. <a name="badge_overlay" id="badge_overlay"></a>
          <h3>Badge Overlay Example</h3>Here is another more complex pre-prepared overlay example this time using a correctly sized image (using extent as a crop method), from the IM Forum Discussion <a href="../forum_link.cgi?f=1&amp;t=19116">Composite Overlay and Masking</a>.
          <div align="center">
            <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="90%" bgcolor="#F8F8F8">
              <tr>
                <td>
                  <pre class="bg-light text-dark mx-4"><samp>
    magick thumbnail.gif  -gravity center -extent 90x90 \
            badge_overlay.png -composite     badge.png
</samp></pre>
                </td>
              </tr>
            </table><a href="thumbnail.gif"><img src="thumbnail.gif" width="120" height="90" align="middle" vspace="5" hspace="10" border="1" alt="[IM Text]"></a> <img src="../img_www/plus.gif" width="20" height="20" align="middle" alt=" + "> <a href="../images/badge_overlay.png"><img src="../images/badge_overlay.png" width="90" height="90" align="middle" vspace="5" hspace="10" border="1" alt="[IM Text]"></a> <img src="../img_www/right.gif" width="20" height="20" align="middle" alt="==&gt;"> <a href="badge.png"><img src="badge.png" width="90" height="90" align="middle" vspace="5" hspace="10" border="1" alt="[IM Text]"></a>
          </div>Note that the image itself is not distorted, just lightened and darkened slightly, a circle cut out and shadow added, all in the one overlay image. If this was a real badge, or 'glass bubble' then the image should also be distorted a little too (perhaps using a <a href="../distorts/#barrel">Barrel Distortion</a>), but it works well without needing such distortion. For the next step in the 'badge' example, see <a href="#badge_mask_paint">Badge using Mask and Paint</a>, which adds background transparency around the outside of the badge.<br>
          <a name="mask_paint" id="mask_paint"></a>
          <h3>Mask 'n' Paint Technique</h3>In many cases you don't just want to overlay a square border around an image, but also want to cut out the image edges, to transparency. For this you would typically use at least two images. One is the masked overlay containing the colors, shadows and highlights you want to add to the existing image. And a second image containing the parts you want to remove from the original image. The two images can be applied in two different ways. You can either 'mask' first to remove the unwanted parts from the image, then overlay the frame, <i>or</i> you can overlay a frame, and then mask the unwanted parts of both the original image and overlaid colors to transparency. Which method you use is critical, and the images involved will be designed for a specific technique. You can not use images for one method in the wrong order or things will not work properly. For example lets create more complex shaped border but this time don't worry about setting the background.
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr>
              <td width="100%" align="justify">
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre><code execute="" random="">
  magick -size 120x100 xc:none -fill none -stroke black -strokewidth 3 \
          -draw 'ellipse 60,50 30,45 0,360  ellipse 60,50 55,30 0,360' \
          -strokewidth 3  -draw 'ellipse 60,50 57,47 0,360' \
          -channel RGBA  -blur 2x1    border_ellipse.png
</code></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="border_ellipse.png"><img src="border_ellipse.png" width="120" height="100" align="middle" vspace="0" hspace="5" border="1" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>Now I purposely made this border blurry, to make the edge components much more semi-transparent. Even without that extra fuzziness, a border also contains a lot of semi-transparent anti-aliasing pixels, that make the edge look smoother and less jagged looking. It is vital when image processing that you consider these semi-transparent pixels, so as to preserve and set them correctly.
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr valign="bottom">
              <td width="100%" align="justify">
                To make it more interesting give this 'fuzzy' border a random bit of coloring.
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre><code execute="" random="">
  magick border_ellipse.png \
          \( -size 120x100 plasma:Tomato-FireBrick -alpha set -blur 0x1 \) \
          -compose SrcIn -composite     border_ellipse_red.png
</code></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="border_ellipse_red.png"><img src="border_ellipse_red.png" width="120" height="100" align="middle" vspace="0" hspace="5" border="1" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr valign="bottom">
              <td width="100%" align="justify">
                Okay we have a border, but we still need some way of defining what should represent the outside and inside of the border. Basically we need a mask to define these two areas.
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre class="bg-light text-dark mx-4"><samp>
  magick -size 120x100  xc:none -fill black \
          -draw 'ellipse 60,50 30,45 0,360  ellipse 60,50 55,30 0,360' \
          border_ellipse_mask.png
</samp></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="border_ellipse_mask.png"><img src="border_ellipse_mask.png" width="120" height="100" align="middle" vspace="0" hspace="5" border="1" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>The color of this 'mask' image is not important, just its shape, as it basically defined what parts will be classed as inside and what will be outside. The mask can be a gray-scale mask, or it can be a shape mask such as shown above. Though the later is typically more useful, and can even be a shape of the parts to erase, or the parts to be kept (as above). In this case the images are designed as a "<i>mask 'n' paint</i>" technique, meaning you should first erase the unwanted parts, then overlay the additional border colors (which also has a transparency mask involved). For example...
          <div align="center">
            <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="90%" bgcolor="#F8F8F8">
              <tr>
                <td>
                  <pre class="bg-light text-dark mx-4"><samp>
  magick thumbnail.gif -alpha set  -gravity center -extent 120x100 \
          border_ellipse_mask.png  -compose DstIn -composite \
          border_ellipse_red.png   -compose Over  -composite \
          border_mask_paint.png
</samp></pre>
                </td>
              </tr>
            </table><a href="thumbnail.gif"><img src="thumbnail.gif" width="120" height="90" align="middle" vspace="5" hspace="5" border="1" alt="[IM Output]"></a> <img src="../img_www/plus.gif" width="20" height="20" align="middle" alt=" + "> <a href="border_ellipse_mask.png"><img src="border_ellipse_mask.png" width="120" height="100" align="middle" vspace="5" hspace="5" border="0" alt="[IM Output]"></a> <img src="../img_www/plus.gif" width="20" height="20" align="middle" alt=" + "> <a href="border_ellipse_red.png"><img src="border_ellipse_red.png" width="120" height="100" align="middle" vspace="5" hspace="5" border="0" alt="[IM Output]"></a> <img src="../img_www/right.gif" width="20" height="20" align="middle" alt="==&gt;"> <a href="border_mask_paint.png"><img src="border_mask_paint.png" width="120" height="100" align="middle" vspace="5" hspace="5" border="0" alt="[IM Output]"></a>
          </div>Two <a href="../compose/#duff-porter">Duff-Porter Alpha Composition Operations</a> are always is needed. One to make parts transparent, and another to overlay the additional colors to outline the border or frame. Two images are needed and as such be kept separate. Some formats like MIFF and GIF do allow you to save both images into the same file, for easier storage. Of course you can combine the two images to create a single simple overlay framing image, but only if you want to use a fixed non-transparency color for the outside parts of the result. For example pre-define the outside as a DodgerBlue color...
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr>
              <td width="100%" align="justify">
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre class="bg-light text-dark mx-4"><samp>
  magick border_ellipse_mask.png -alpha extract -negate \
          -background DodgerBlue -alpha shape \
          border_ellipse_red.png   -compose Over -composite \
          border_ellipse_overlay.png
</samp></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="border_ellipse_overlay.png"><img src="border_ellipse_overlay.png" width="120" height="100" align="middle" vspace="0" hspace="5" border="1" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>But in that case you could simply underlay a solid color or some other background image under the previously generated double masked image...
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr>
              <td width="100%" align="justify">
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre><code execute="" random="">
  magick border_double_masked.png \
          \( -size 120x100 plasma:Green-Green -blur 0x1 \) \
          +swap  -compose Over  -composite     border_background.png
</code></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="border_background.png"><img src="border_background.png" width="120" height="100" align="middle" vspace="0" hspace="5" border="1" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>The point is with two images, a 'mask' and 'overlay' image, you have a lot more freedom in how you add the border to the image. You could even define multiple 'mask' images, to define the different 'windows' of the 'overlaid' border image. You can also add optional highlights and shadows, rather than hard coding them into a single overlay framing image. Now for an important caveat. The edges of the masking image <b>must not</b> coincide with the edges of the overlay image. If they match up, you will not get the correct handling of colors along the coinciding edges, or generate other weird 'halo' effects. As such you need to make sure the mask edges fall somewhere within the fully-opaque region of the overlay image. Caution and fore-thought with the two masking operations is needed. <a name="rounded_border" id="rounded_border"></a>
          <h3>Border with Rounded Corners</h3>As you saw above the <a href="#mask_paint">Mask 'n' Paint Technique</a> can be used to both add extra colors or 'fluff' to an image, but also remove parts, so as to shape the final image. This presents us with an alternative way of adding rounded corners to an image. The IM "<code><a href="../option_link.cgi?draw">-draw</a></code>" operator comes with a '<code>roundrectangle</code>' method that can be used to provide an interesting frame around the image. However you need to size the dimensions of this draw method to match the image. IM does provide methods to extract and even do mathematical calculations based on the image size. The coordinates at which to locate the rectangle is for the exact 'center' of the stroke-width used to define the rectangle (it can be a floating point value). Also it is given in terms of 'pixel coordinates' (see <a href="../distorts/#control_coordinates">Pixel vs Image coordinates</a>), which means that a value of 1,1 refers to the second pixel form the top and left edges, but more importantly it refers to the 'center' of the pixel which is in reality 1.5 units from the real top and left edges. Now we will use a stoke width (SW) of 3, that makes the image 3 pixels larger on all sides. It then means the rectangle will be positioned <code>SW/2 - 0.5</code> or 1.0 pixels from the top left, and <code>ImageSize + SW*1.5 - 0.5</code> or Image size + 4 pixels at the bottom right. Here we use IM itself to do these calculations, generating the exact draw command that are need using fancy <a href="../transform/#fx_escapes">FX escapes</a>. This is saved as a <a href="../draw/#mvg_file">Magick Vector Graphics File</a> that can be directly used by draw in later commands.
          <div align="center">
            <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="90%" bgcolor="#F8F8F8">
              <tr>
                <td>
                  <pre><code execute="" txt2gif="">
  magick thumbnail.gif \
          -format 'roundrectangle 1,1 %[fx:w+4],%[fx:h+4] 15,15'\
          info: &gt; rounded_corner.mvg
</code></pre>
                </td>
              </tr>
            </table>
            <table border="0" cellspacing="0" cellpadding="5" width="90%" bgcolor="#F8F8F8">
              <tr>
                <td>
                  <a href="rounded_corner.mvg"><img src="rounded_corner.mvg.gif" align="middle" vspace="0" hspace="0" border="0" alt="[IM Text]"></a>
                </td>
              </tr>
            </table>
          </div>
          <table border="0" cellspacing="0" cellpadding="0" width="90%" align="center">
            <tr valign="top">
              <td><img src="../img_www/reminder.gif" width="20" height="16"><img src="../img_www/space.gif" width="20" height="16"></td>
              <td align="justify" width="100%"><font size="-1"><i>If you can figure out the image size in a different way (using the shell, or other API language wrapper) you can substitute the appropriate draw parameters directly into the next examples, rather then use an FX mathematical expression. Basically the above makes this whole process independent of the actual size of the thumbnail. Any other way, including direct hard coding is also acceptable.</i></font></td>
            </tr>
          </table>Now we can use this to generate overlay and a mask image. As part of this we create a <a href="../canvas/#transparent">Transparent Canvas</a> using the original image (which is first enlarged by the stroke-width), to get the size right.
          <div align="center">
            <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="90%" bgcolor="#F8F8F8">
              <tr>
                <td>
                  <pre class="bg-light text-dark mx-4"><samp>
  magick thumbnail.gif -border 3 -alpha transparent \
          -background none -fill white -stroke none -strokewidth 0 \
          -draw "@rounded_corner.mvg"    rounded_corner_mask.png
  magick thumbnail.gif -border 3 -alpha transparent \
          -background none -fill none -stroke black -strokewidth 3 \
          -draw "@rounded_corner.mvg"    rounded_corner_overlay.png
</samp></pre>
                </td>
              </tr>
            </table><a href="rounded_corner_mask.png"><img src="rounded_corner_mask.png" align="middle" vspace="5" hspace="5" border="1" alt="[IM Text]"></a> <a href="rounded_corner_overlay.png"><img src="rounded_corner_overlay.png" align="middle" vspace="5" hspace="5" border="1" alt="[IM Text]"></a>
          </div>And there we have the overlay border image, and transparency mask image, we need for the double masking technique. Note that the masks are for an image that is stroke width larger than the original image, and that the erasing shape mask (in white) does not cover the whole of the enlarged area, as there is a 1 pixel gap all around it.So lets apply it using the <a href="#double">Double Masking</a> technique...
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr>
              <td width="100%" align="justify">
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre class="bg-light text-dark mx-4"><samp>
  magick thumbnail.gif -alpha set -bordercolor none -border 3  \
          rounded_corner_mask.png -compose DstIn -composite \
          rounded_corner_overlay.png -compose Over -composite \
          rounded_border.png
</samp></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="rounded_border.png"><img src="rounded_border.png" align="middle" vspace="0" hspace="5" border="0" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>And there we have have a bordered our image with rounded corners. The following is how you can do the above all in a single command with a little extra fanciness. However this all-in-one command will still generate a temporary file holding the generated draw commands needed for an image of the size given.
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr>
              <td width="100%" align="justify">
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre class="bg-light text-dark mx-4"><samp>
  magick thumbnail.gif \
      -format 'roundrectangle 1,1 %[fx:w+4],%[fx:h+4] 15,15' \
      -write info:tmp.mvg \
      -alpha set -bordercolor none -border 3 \
      \( +clone -alpha transparent -background none \
         -fill white -stroke none -strokewidth 0 -draw @tmp.mvg \) \
      -compose DstIn -composite \
      \( +clone -alpha transparent -background none \
         -fill none -stroke black -strokewidth 3 -draw @tmp.mvg \
         -fill none -stroke white -strokewidth 1 -draw @tmp.mvg \) \
      -compose Over -composite               rounded_border_in_one.png
  rm -f tmp.mvg      # Cleanup of temporary file
</samp></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="rounded_border_in_one.png"><img src="rounded_border_in_one.png" align="middle" vspace="0" hspace="5" border="0" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>A better way for doing rounded corners, especially with very large images will be to use a separate corner masking image technique, which we will look at below in <a href="#fancy">Fancy Corner Overlays</a>. In many ways this is an extension of the above method, but using separate masking for each corner of the image, so as to keep the working images small in size. <a name="badge_mask_paint" id="badge_mask_paint"></a>
          <h3>Badge using Mask 'n' Paint</h3>Here is a much more complex "mask 'n' paint" example, that was developed from the image used previously in the <a href="#badge_overlay">Badge Overlay</a> example above. The generation of the two images was 'fudged', and was discussed IM forums <a href="../forum_link.cgi?f=1&amp;t=19116">Composite Overlay and Masking</a>. Idealy the two images would have been developed together.
          <div align="center">
            <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="90%" bgcolor="#F8F8F8">
              <tr>
                <td>
                  <pre class="bg-light text-dark mx-4"><samp>
  magick thumbnail.gif -alpha set -gravity center -extent 90x90 \
          badge_mask.png -compose DstIn -composite \
          badge_shading.png -compose Over -composite \
          badge_trans_bg.png
</samp></pre>
                </td>
              </tr>
            </table><a href="thumbnail.gif"><img src="thumbnail.gif" width="120" height="90" align="middle" vspace="5" hspace="10" border="1" alt="[IM Text]"></a> <img src="../img_www/plus.gif" width="20" height="20" align="middle" alt=" + "> <a href="../images/badge_mask.png"><img src="../images/badge_mask.png" width="90" height="90" align="middle" vspace="5" hspace="10" border="0" alt="[IM Text]"></a> <img src="../img_www/plus.gif" width="20" height="20" align="middle" alt=" + "> <a href="../images/badge_shading.png"><img src="../images/badge_shading.png" width="90" height="90" align="middle" vspace="5" hspace="10" border="0" alt="[IM Text]"></a> <img src="../img_www/right.gif" width="20" height="20" align="middle" alt="==&gt;"> <a href="badge_trans_bg.png"><img src="badge_trans_bg.png" width="90" height="90" align="middle" vspace="5" hspace="10" border="0" alt="[IM Text]"></a>
          </div>Note that above I said that the you should avoid trying to align transparency edges and the mask edges. In the above example I did just that, and the edges of the resulting image will not be quite correct. However as the coloring is really only a subtile shading rather that a strong edge, it seems to work okay in this example. Caution however should be exercised. For the next step in the 'badge' examples, see <a href="#badge_paint_mask">Badge using Paint and Mask</a>, which reverses the order of the two composition operations, requiring a different set of images.<br>
          <a name="paint_mask" id="paint_mask"></a>
          <h3>Paint 'n' Mask Technique</h3>Rather than '<i>Mask then Paint</i>' you can use a different set of images and overlay the additional colors first, before masking out the background. That is, you can perform a '<i>Paint then Mask</i>'. That is, you would take your image, and overlay the border which sets not only all of the final border colors, but also masks and colors some or all the parts outside parts the original image. You then use a separate 'outside' or 'clipping' mask to remove all the unwanted parts of the resulting image. Also note that both 'overlay' and 'masking' image defines the inside edge separately to the outside edge of the border. As a result one image does not completely define the whole border in a single image, which can make it a little harder to use. However it can be simpler to implement. For example...
          <div align="center">
            <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="90%" bgcolor="#F8F8F8">
              <tr>
                <td>
                  <pre class="bg-light text-dark mx-4"><samp>
  magick -size 120x90 xc:none -fill black -stroke black -strokewidth 0 \
          -draw 'ellipse 45,45 55,37 0,360' \
          -channel RGBA -negate -blur 0x3  +channel \
          \( granite: -auto-level -blur 0,0.7 \) \
          -compose ATop -composite border_paint.png

  magick -size 120x90 xc:none -fill black -stroke black -strokewidth 5 \
          -draw 'ellipse 59,45 56,40 0,360' border_mask.png

  magick thumbnail.gif -alpha set \
          border_paint.png -compose Over  -composite \
          border_mask.png  -compose DstIn -composite \
          border_paint_mask.png
</samp></pre>
                </td>
              </tr>
            </table><a href="thumbnail.gif"><img src="thumbnail.gif" width="120" height="90" align="middle" vspace="0" hspace="5" border="1" alt="[IM Output]"></a> <img src="../img_www/plus.gif" width="20" height="20" align="middle" alt=" + "> <a href="border_paint.png"><img src="border_paint.png" width="120" height="90" align="middle" vspace="5" hspace="5" border="1" alt="[IM Output]"></a> <img src="../img_www/plus.gif" width="20" height="20" align="middle" alt=" + "> <a href="border_mask.png"><img src="border_mask.png" width="120" height="90" align="middle" vspace="5" hspace="5" border="1" alt="[IM Output]"></a> <img src="../img_www/right.gif" width="20" height="20" align="middle" alt="==&gt;"> <a href="border_paint_mask.png"><img src="border_paint_mask.png" width="120" height="90" align="middle" vspace="5" hspace="5" border="0" alt="[IM Output]"></a>
          </div>Note how some parts of the overlaid colors are removed. This is the key feature of the <i>Paint 'n' Mask</i> technique, allowing you to use a simpler overlay, which is then adjusted by the mask. This method of image masking is what is used in the next <a href="#pagecurl">Page Curl Corners</a> example set, and again later in <a href="#fancy">Fancy Corner Borders</a> below. <a name="pagecurl" id="pagecurl"></a>
          <h3>Page Curl Corners</h3><a href="http://www.fmwconcepts.com/fmw/fmw.html">Fred Weinhaus</a> created a special shell script called <a href="http://www.fmwconcepts.com/imagemagick/pagecurl/index.php">PageCurl</a> which will, add a simple page curl to an existing image, using some very complex mathematics (in shell). For example...
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr>
              <td width="100%" align="justify">
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre class="bg-light text-dark mx-4"><samp>
  pagecurl thumbnail.gif  pagecurl.png
</samp></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="pagecurl.png"><img src="pagecurl.png" width="120" height="90" align="middle" vspace="0" hspace="5" border="0" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>Internally it is actually using the <a href="#paint_mask">Paint 'n' Mask</a> technique. That is, first overlays a slightly too large 'curl overlay', then erases (masks) the rest of the image, including a small amount of the overlay, that will become the transparent corner. However if you want to apply a page curl to a lot of images, using the full script (above) is a rather slow technique. It does after all do a huge amount of mathematical processing (using IM itself as a floating point calculator), to actually calculate and generate the appropriate overlay and masking images. To apply a pagecurl to a lot of images it is better to use the script once so as to generate the overlay and transparency mask image once only. So lets extract those two images for a smaller 64x64 pixel images (using a special '<code>-i "pagecurl"</code> option added to the script for this purpose).
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr>
              <td width="100%" align="justify">
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre><code execute="" image="curl_overlay.png">
  magick -size 64x64 xc: miff:- | pagecurl -e 0.3 -i "pagecurl" - null:
</code></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="pagecurl_overlay.png"><img src="pagecurl_overlay.png" width="64" height="64" align="middle" vspace="0" hspace="5" border="1" alt="[IM Output]"></a> <a href="pagecurl_mask.png"><img src="pagecurl_mask.png" width="64" height="64" align="middle" vspace="0" hspace="0" border="1" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>The above command creates two image files: "<code>pagecurl_overlay.png</code>" and "<code>pagecurl_mask.png</code>" shown. The input image itself does not matter as it is the masking images that we want. The 'page curled' result is just junked using the special "<code><a href="../files/#null">null:</a></code>" image file format.
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr>
              <td width="100%" align="justify">
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre><code execute="" image="curl_overlay.png">
  magick thumbnail.gif -alpha set -gravity SouthEast \
          -define compose:outside-overlay=false \
          pagecurl_overlay.png -composite \
          pagecurl_mask.png  -compose DstIn -composite \
          pagecurl_thumbnail.png
</code></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="pagecurl_thumbnail.png"><img src="pagecurl_thumbnail.png" width="120" height="90" align="middle" vspace="0" hspace="5" border="0" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>Of course these images are not the same size as our thumbnail or probably any image you are wanting to apply it to, but that does not matter, as we can use a couple of extra options to ensure they work as expected. Specifically, the "<code><a href="../option_link.cgi?gravity">-gravity</a></code>" setting ensures that the two overlay images are positioned in the lower right corner. And the special <a href="../basics/#define">Define Setting</a> '<code>compose:outside-overlay=false</code>' will prevent the mask image from erasing the parts of the image not covered by the smaller image. See <a href="../compose/#outside-overlay">Outside-Overlay Setting</a> for a full description. If you like to apply this to a lot of images you can use the "<code>magick mogrify</code>", using a special technique involving using "<code><a href="../option_link.cgi?draw">-draw</a></code>" to do the <a href="../basics/#mogrify_compose">Mogrify Alpha Composition</a>. However this method of composition does not understand the special define setting, so it will only work with images, overlays, and masks that are all the same size.
          <div align="center">
            <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="90%" bgcolor="#F8F8F8">
              <tr>
                <td>
                  <pre class="bg-light text-dark mx-4"><samp>
  pagecurl -e 0.5 -i /tmp/pagecurl  {<i>one image</i>} null:
  magick mogrify {<i>magick mogrify -format and -path options</i>} -alpha set \
          -draw 'image Over 0,0 0,0 "/tmp/pagecurl_overlay.png"' \
          -draw 'image DstIn 0,0 0,0 "/tmp/pagecurl_mask.png"' \
          {<i>all images to be pagecurled</i>}...
</samp></pre>
                </td>
              </tr>
            </table>
          </div><a name="fancy" id="fancy"></a>
          <h3>Fancy Corner Overlay</h3>Here we look a bit deeper into used this 'double masking' technique to modify an image in different ways in different areas, rather than applying a single large mask or frame to the whole image. In this case we will only double mask the corners. The rest of the border (to match) is added separatally. <a href="../images/fancy_orig.gif"><img src="../images/fancy_orig.gif" align="right" vspace="0" hspace="5" border="1" alt="[IM Output]"></a> The corner images I will use was generated from the original source (shown right) which I found in the <a href="http://www.ict.griffith.edu.au/anthony/icons/prog/frames/Icons.html">DIY Frames Section</a> of <a href="http://www.ict.griffith.edu.au/anthony/icons/">Anthony's Icon Library</a>. There are others in this section, so you may like to have a look. If you find something on the net, please let me know as I like to collect interesting corners, and edging techniques. <a href="../images/fancy_sub.gif"><img src="../images/fancy_sub.gif" align="right" vspace="0" hspace="5" border="1" alt="[IM Output]"></a> <a href="../images/fancy_add.gif"><img src="../images/fancy_add.gif" align="right" vspace="0" hspace="5" border="1" alt="[IM Output]"></a> A color overlay and masking image was generated, from that initial image, so that we could use a <a href="#paint_mask">Paint 'n' Mask</a> technique, for overlaying the corner onto the image. Notice that these images, did not actually use any semi-transparent pixels, or even any shading of colors. As such this fancy border can be used to produce clean looking 'GIF' thumbnails for web pages. The complication with using corner masks, is that they only mask the corners of the original image. Because of this the original image first needs to be given the appropriate set of extra border colors. After that the two corner masks, must be composted onto each of the corners of the expanded image.
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr>
              <td width="100%" align="justify">
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre class="bg-light text-dark mx-4"><samp>
  magick thumbnail.gif   -alpha set  -compose Copy \
          -bordercolor Black  -border 2 \
          -bordercolor Sienna -border 3 \
          -bordercolor Black  -border 1 \
          -bordercolor None   -border 2 \
          -bordercolor Black  -border 2 \
          -bordercolor Peru   -border 3 \
          -bordercolor Black  -border 1 \
          \
          -compose Over \
          \( fancy_add.gif             \) -gravity NorthWest -composite \
          \( fancy_add.gif -flip       \) -gravity SouthWest -composite \
          \( fancy_add.gif       -flop \) -gravity NorthEast -composite \
          \( fancy_add.gif -flip -flop \) -gravity SouthEast -composite \
          -compose DstOut \
          \( fancy_sub.gif             \) -gravity NorthWest -composite \
          \( fancy_sub.gif -flip       \) -gravity SouthWest -composite \
          \( fancy_sub.gif       -flop \) -gravity NorthEast -composite \
          \( fancy_sub.gif -flip -flop \) -gravity SouthEast -composite \
          fancy_border.gif
</samp></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="fancy_border.gif"><img src="fancy_border.gif" align="middle" vspace="0" hspace="5" border="0" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>
          <table border="0" cellspacing="0" cellpadding="0" width="90%" align="center">
            <tr valign="top">
              <td><img src="../img_www/reminder.gif" width="20" height="16"><img src="../img_www/space.gif" width="20" height="16"></td>
              <td align="justify" width="100%"><font size="-1"><i>Note that to preserve the transparent border that is being added, you must set "<code><a href="../option_link.cgi?compose">-compose</a></code>" setting to '<code>Copy</code>' rather than the default of '<code>Over</code>'. If you don't then the transparency will be filled by the next border color added, in this case with 'Black'. See the <a href="../crop/#border">Border Operator</a> for details.</i></font></td>
            </tr>
          </table>The beauty of only using corner masks is that any size image can be framed using this technique, as long as it is large enough for the corner masks being added. That is, you are not limited by the size of the framing images you have available. Of course each of the four corner images and the borders is the same all the way around the image, just rotated. That is, the shadow or thickness effect is all 'inward'. To fix this you would need to generate a different corner peice for each and every corner, and the addition of the extra edges around the original image would need to be asymetrical. Basically it becomes much more complex, so as to produce true shadowing effects. A better solution may be to remove the shadow effect from the corner piece, apply it as before, but then add shadow effects globally. Caution is needed. <a name="badge_paint_mask" id="badge_paint_mask"></a>
          <h3>Badge using Paint 'n' Mask</h3>The same badge image processing seen previously in <a href="#badge_overlay">Badge Overlay</a> and <a href="#badge_mask_paint">Badge Mask 'n' Paint</a>, can also be performed by painting then masking. <!-- <CODE EXECUTE>
  # get transparency mask, as a shaped image
  magick badge_mask.png badge_shading.png -composite \
          -evaluate set 0  badge_shape.png
  # get transparency mask, as a gray scale image.
  magick badge_mask.png badge_shading.png -composite \
          -alpha extract  badge_graymask.png

  # generate the paint overlay,
  # However we need to extract all fully transparent colors from shade image
  magick badge_mask.png -channel A -negate -threshold 0 +channel \
          badge_shading.png +swap -channel A -compose Screen -composite \
          badge_paint.png

</CODE>

  # Removing the +swap in the above should produce the same result
  # as -compose Plus is a communicative composition.
  # BUT it produces a negated image!

  magick badge_mask.png -channel A -negate -threshold 0 +channel \
          badge_shading.png -channel A -compose Screen -composite \
          badge_paint.png

-->
          Here we first paint all the colors an shades onto the then mask out the final transparency of the image.
          <div align="center">
            <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="90%" bgcolor="#F8F8F8">
              <tr>
                <td>
                  <pre class="bg-light text-dark mx-4"><samp>
  magick thumbnail.gif -alpha set -gravity center -extent 90x90 \
          badge_paint.png -composite badge_shape.png -compose DstIn -composite \
          badge_paint_mask.png
</samp></pre>
                </td>
              </tr>
            </table><a href="thumbnail.gif"><img src="thumbnail.gif" width="120" height="90" align="middle" vspace="5" hspace="10" border="1" alt="[IM Text]"></a> <img src="../img_www/plus.gif" width="20" height="20" align="middle" alt=" + "> <a href="badge_paint.png"><img src="badge_paint.png" width="90" height="90" align="middle" vspace="5" hspace="10" border="0" alt="[IM Text]"></a> <img src="../img_www/plus.gif" width="20" height="20" align="middle" alt=" + "> <a href="badge_shape.png"><img src="badge_shape.png" width="90" height="90" align="middle" vspace="5" hspace="10" border="0" alt="[IM Text]"></a> <img src="../img_www/right.gif" width="20" height="20" align="middle" alt="==&gt;"> <a href="badge_paint_mask.png"><img src="badge_paint_mask.png" width="90" height="90" align="middle" vspace="5" hspace="10" border="0" alt="[IM Text]"></a>
          </div>If this seems awkward for this specific image, you are right, it is. The reason that that we not only need to shade and highlight the original image, but we also need to fill out any areas that will contain shadow effects with black. Specifically any parts that will become fully transparent (and only pixels that really are fully transparent) will need to be painted with black. On the other hand semi-transparent pixels with shadow effects will have both a partial shade effect and a partial transparency mask. In other words shadows make an otherwise simple paint and mask technique awkward in the division of painting and masking effects. This is why a paint and mask technique is typically not used when dealing with semi-transparent additions to an image, such as when adding shadows or a flare stars. If the image did not contain any transparency-effects, than the paint process does not look so horrible, and can in many case be simplier than other techniques, as you can 'cut off' the painted overalys with the mask when finished. The <a href="#pagecurl">Page Curl</a> example was such a case, as we use the mask to trim the page curl overlay to make a seemless whole.Also note the gap between the hard black region and the shading effects in the paint image. This gap reflects warning I have mentioned before about ensuring that you do not overlap the results of any internal masking with the edges of any paint/overlay external mask. It is only in this specific case that this required gap becomes so obvious. For the next step in the 'badge' examples, see <a href="#badge_lighting">Badge using Lighting Effects</a>, which merges the two masking images into a single mask/shading image.<br>
          <a name="lighting_mask" id="lighting_mask"></a> <a name="glass_bubble" id="glass_bubble"></a>
          <h2>Lighting Mask Technique</h2>
          <h3>Glass Bubble Button</h3>The next level of complexity in thumbnail processing is the application of very complex lighting effects. The trickiness here is not so much the application of a lighting effect to an image, but the generation of the appropriate shading effect. For example using a <a href="../advanced/#aqua_effects">Aqua Effect</a> you can give an thumbnail a very complex shading effect that makes it look like it has been enclosed by a 'bubble' of glass. Also this works better with a thumbnail that has <a href="#rounded">Rounded Corners</a>. For lets generate a rounded corners mask for our thumbnail image, using a pure gray color.
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr>
              <td width="100%" align="justify">
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre><code execute="" script="">
  magick thumbnail.gif -alpha off -fill white -colorize 100% \
     -draw 'fill black polygon 0,0 0,15 15,0 fill white circle 15,15 15,0' \
     \( +clone -flip \) -compose Multiply -composite \
     \( +clone -flop \) -compose Multiply -composite \
     -background Gray50 -alpha Shape    thumbnail_mask.png
</code></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="thumbnail_mask.png"><img src="thumbnail_mask.png" align="middle" vspace="0" hspace="5" border="0" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>Now that we have a pure gray 'shape mask' we want to use, I can apply the <a href="../advanced/#aqua_effects">Aqua Effect</a> effect to generate a lighting overlay, for this shape.
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr>
              <td width="100%" align="justify">
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre><code execute="" script="">
  magick thumbnail_mask.png -bordercolor None -border 1x1 \
          -alpha Extract -blur 0x10  -shade 130x30 -alpha On \
          -background gray50 -alpha background -auto-level \
          -function polynomial  3.5,-5.05,2.05,0.3 \
          \( +clone -alpha extract  -blur 0x2 \) \
          -channel RGB -compose multiply -composite \
          +channel +compose -chop 1x1 \
          thumbnail_lighting.png
</code></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="thumbnail_lighting.png"><img src="thumbnail_lighting.png" align="middle" vspace="0" hspace="5" border="0" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>With a final light/shade overlay image such as the above we can easily apply it to any thumbnail image of the right size.
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr>
              <td width="100%" align="justify">
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre><code execute="" script="">
  magick thumbnail.gif -alpha Set thumbnail_lighting.png \
          \( -clone 0,1 -alpha Opaque -compose Hardlight -composite \) \
          -delete 0 -compose In -composite \
          glass_bubble.png
</code></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="glass_bubble.png"><img src="glass_bubble.png" align="middle" vspace="0" hspace="5" border="0" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>Not only does this add the appropriate shading effects to any thumbnail of this size, but the same lighting image masks the thumbnail into the proper shape. It is important to note that only the color channels are used to apply the lighting effect, the alpha channel is not used in this process. Similarly when masking only the alpha channel is used, not the color channels. Without this seperation of channels for different effects, you will not get the correct result. For a discussion on extracting a lighting effect from images see the IM user forum topic <a href="../forum_link.cgi?f=1&amp;t=19337">Extracting light layer from two images</a>.<br>
          This can be taken much further however in that we can also directly add shadow effects to this lighting mask. The added color however must be pure black, and you need to ensure the lighting effect composition chosen will make an image perfectly black is the lighting mask is black. However this is actually how shadow effects are normally added to an image, as such you can just add shadows to the "lighting effect mask" directly, and all will be well! The same thing is true for adding lighting 'flares', but only using white pixels for the flare overlay. In essence a "lighting effect image" can again actually merge the two <a href="#mask_paint">Mask 'n' Paint</a> images back into a single image. As you will see in the next example. <a name="badge_lighting" id="badge_lighting"></a>
          <h3>Badge using Lighting Effects</h3>Using the images from <a href="#badge_mask_paint">Badge using Mask 'n' Paint</a> technique, I applied them to a pure gray canvas image, so as to quickly generate a "masked lighting effect" image, Actually I could also have used the other style of masking (<a href="#badge_paint_mask">Badge using Paint 'n' Mask</a>) just as easily. I then apply the single masking image to the thumbnail reproducing the desired result.
          <div align="center">
            <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="90%" bgcolor="#F8F8F8">
              <tr>
                <td>
                  <pre class="bg-light text-dark mx-4"><samp>
  # merge "mask 'n' paint" images with a gray image,
  # to create a "lighting mask"
  magick -size 90x90 xc:gray50 -alpha set \
          badge_mask.png -compose DstIn -composite \
          badge_shading.png -compose Over -composite \
          badge_lighting.png

  # Apply the single "lighting mask"
  magick thumbnail.gif -alpha set -gravity center -extent 90x90 \
          badge_lighting.png \
          \( -clone 0,1 -alpha Opaque -compose Hardlight -composite \) \
          -delete 0 -compose In -composite \
          badge_final.png
</samp></pre>
                </td>
              </tr>
            </table><a href="thumbnail.gif"><img src="thumbnail.gif" width="120" height="90" align="middle" vspace="5" hspace="10" border="1" alt="[IM Text]"></a> <img src="../img_www/plus.gif" width="20" height="20" align="middle" alt=" + "> <a href="badge_lighting.png"><img src="badge_lighting.png" width="90" height="90" align="middle" vspace="5" hspace="10" border="0" alt="[IM Text]"></a> <img src="../img_www/right.gif" width="20" height="20" align="middle" alt="==&gt;"> <a href="badge_final.png"><img src="badge_final.png" width="90" height="90" align="middle" vspace="5" hspace="10" border="0" alt="[IM Text]"></a>
          </div>Actually I rather like this form of masking as the mask image itself looks almost identical to the image you are after, just the colors are missing. That is, after all how a lighting mask is created, just apply the effects to a perfect gray image, and you get a "lighting mask" image. Just remember that with this particular technique, the semi-transparent shadow must be pure black for it to work properly. You can not use a gray colored for any pixel that does not contain at least part of the original image. All transparent and semi-transparent areas must be pure white or black in color, with the appropriate level of alpha transparency. <b>Why does only one image work?</b> Previously we needed two images! The answer is that the masking image is limited only to only adding either pure black or white shades of color. By doing this the shading (lighting) effect, and its mask, is essentially merged into the color component of the "<i>Lighting Effect Mask</i>". As a result of this the alpha channel becomes free to hold the previously separate transparency mask for the final image. The limitation of this however is that you can only add white and black shades to the image. You can not add for example a gray color to the image being masked. Note however that it is posible to add some tints of primary and secondary colors of some color space, but only in a limited way, and I have never seen it used. In summery you can not add specific colors or fancy borders to the image, only shades and shadows, highlights and flares, or simple black or white text. However you should not attempt to mix or overlap added white and black effects, as the resulting gray anti-aliasing pixels between the two produces a shaded color from the underlying image, and not the expected gray color. That is, the drawback with this technique!
          <h3>Masking images with distortions...</h3>What is more incredible is that as as the shading colors is just a gray-scale image, you can compress the lighting effects to just one color channel and the alpha channel mask. This can then be used to free two color image channels for other image processing effects! That is, you can store other things into the single 'masking image'. Specifically you can add distortion effects into the same mask image! For more information on this see <a href="../mapping/#distortion_unified">Unified Distortion Image</a> which does exactly this! A sort of ultimate masking image.
          <hr>
          <!-- ---------------------------------------------------------------- -->
          <a name="frame_edge" id="frame_edge"></a>
          <h2>Framing using Edge Images</h2><a href="../images/oak_frame_sample.jpg"><img src="../images/oak_frame_sample.jpg" align="right" vspace="0" hspace="5" border="0" alt="[IM Image]"></a> One common way to add a complex border to an image is to use a pre-prepared framing images, to produce a frame such as the example shown (right). However you also need to be careful with generating frames. If you look at the given example carefully you will notice that it is not quite right. The shading of the generated frame is actually incorrect. The left and bottom frame edges should be swapped to produce a correctly shaded frame for a typical top-left light source. As such before we even begin, I would like to stress the importance of using the correct image, or the correctly modified image for each edge while framing your thumbnail or photo. It is very easy to get wrong, so double check your results when you think you have it right.
          <h3>The Frame Edge Images</h3>There are may types of images that can be used to frame an image. For example, here is 'thin black with gold trim' frame that was modified from images provided by Michael Slate &lt;slatem_AT_posters2prints.com&gt;.
          <div align="center">
            <a href="../images/blackthin_top.gif"><img src="../images/blackthin_top.gif" width="50" height="15" align="middle" vspace="0" hspace="30" border="0" alt="[IM Image]"></a> <a href="../images/blackthin_btm.gif"><img src="../images/blackthin_btm.gif" width="50" height="15" align="middle" vspace="0" hspace="30" border="0" alt="[IM Image]"></a>
          </div>There are two images, to provide two different lighting effects, one for the top and left edges, the other for the bottom and right edges. However the colors along the length of the image does not vary. As such you can either tile or stretch this frame to produce the length needed. A similar set of framing pieces are this 'thin ornate gold' tileable border images.
          <div align="center">
            <a href="../images/goldthin_top.png"><img src="../images/goldthin_top.png" width="34" height="25" align="middle" vspace="0" hspace="30" border="0" alt="[IM Image]"></a> <a href="../images/goldthin_btm.png"><img src="../images/goldthin_btm.png" width="34" height="25" align="middle" vspace="0" hspace="30" border="0" alt="[IM Image]"></a>
          </div>As these images has some fine detail you cannot just simply stretch the image to the desired length. Nor can you just <a href="../warping/#rect_rotate">Rectangular Rotate</a> these pieces to produce the other edge pieces, as doing so will get the shading of the fine detail wrong. A <a href="../warping/#transpose">Diagonal Transpose</a> distortion should however get the correct shading for the other edges. Extra caution is advised when reviewing your results, to be sure the both the overall shading and the fine detail shading is correct on all four sides of the image. Finally a framing image may only consist of a single image that can be used to generate all the framing edges, such as this 'bamboo' tiling frame image.
          <div align="center">
            <a href="../images/bamboo.gif"><img src="../images/bamboo.gif" width="90" height="14" align="middle" vspace="0" hspace="30" border="0" alt="[IM Image]"></a>
          </div>The reason only one image is needed is that the frame has no specific 'inside' or 'outside' to it. Though the frame does have both overall and fine detail lighting effects that requires you to again be careful of how you rotate/flip/transpose the image for the other edges. The bigger problem with this frame is that if you just tile it simply, the macro detail becomes very regular, and as such you may need to randomise the tile offset, or even randomise the lengths of pieces being appended togther so as to give it a more natural look. More on this later. As you can see framing images can come in a variety of styles, and care must be taken to handle the chosen edging images in the correct way (with regard to lighting image), when generating the other missing edging images.
          <h3>Lengthening Framing Pieces</h3>Now in any use of these framing images, we will need to create a longer pieces that will cover the length of the image dimensions. There are only two basic ways in which this can be done. You can simply stretch the frame image using resize (without aspect preservation) so as to get the right lengths. This works for the first set of pieces shown above, which have no internal detail, but is not appropriate for any of the other framing images presented. Basically it will distort the internal detail, and may become a distraction to the look of the final image. However the other lengthening method, tiling, can be used for any framing image that has a repeating pattern or detail, which is the case with all the above images presented. If you are creating your own framing pieces, please be careful that the tiles do match up properly, and to a pixel boundary so as to ensure you have an uniform color and proper cycling of the detail in your framing images. It you don't you can get an artificial looking joint between the tiles, the become obvious because of the repeation of the tiles. In the real world picture framers also have the same problem in joining pieces together to make longer pieces. Basically it is very easy to get two different shades of wood, or very different grain pattern, that when 'dove-tailed' together, makes the joint very obvious. So really your not alone in this problem. The 'bamboo' framing images, will need to be tiled. Though as the detail is restricted to a small area on the image, you can get some interesting random tiling effects, that may need some randomized lengthing and shortening of the peices to remove. I will not go into this however, and will leave it as an exercise for those that are. For our examples, and because it works for just about all framing images I will use a simple constant tiling method to generate the longer edge lengths needed. <a name="frame_append" id="frame_append"></a>
          <h3>Over-simplistic Append</h3>We can just lengthen the simple 'bamboo' frame above, by tiling it to the right length, then <a href="../layers/#append">append</a> the images together. The tiling is done simply by the special <a href="../canvas/#tile">Tiled Canvas</a> image generator "<code><a href="../canvas/#tile">tile:</a></code>" to tile an image that is being read in.
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr>
              <td width="100%" align="justify">
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre class="bg-light text-dark mx-4"><samp>
  magick thumbnail.gif \
          \( -size 90x14  tile:bamboo.gif -transpose \) \
          \( -size 90x14  tile:bamboo.gif -transpose \) -swap 0,1 +append \
          \( -size 148x14 tile:bamboo.gif \) \
          \( -size 148x14 tile:bamboo.gif \) -swap 0,1 -append \
          frame_append.gif
</samp></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="frame_append.gif"><img src="frame_append.gif" width="148" height="118" align="middle" vspace="0" hspace="5" border="0" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>Note that the sizes used in the above two examples were calculated based on the known width (10 pixels) of the framing image, and the size of the image being framed (120x100 pixels). You will need to adjust the resize arguments appropriately for your images. One problem with tiling framing pieces (like bamboo) is that all the edges look like they are exact copies of each other! That is, the framing looks artificial. In real life the frame will have been cut with pretty much random offsets, from longer pieces of real wood, or in this case bamboo. To fix that you will need to also give such tiles a slightly different <a href="../canvas/#tile-offset">Tile Offset</a> for each edge of the image.
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr>
              <td width="100%" align="justify">
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre class="bg-light text-dark mx-4"><samp>
  magick thumbnail.gif \
          \( -size 90x14  -tile-offset +50+0 tile:bamboo.gif -transpose \) \
          \( -size 90x14  -tile-offset +0+0  tile:bamboo.gif -transpose \) \
          -swap 0,1 +append \
          \( -size 148x14 -tile-offset +70+0 tile:bamboo.gif \) \
          \( -size 148x14 -tile-offset +25+0 tile:bamboo.gif \) \
          -swap 0,1 -append       frame_tile_offset.gif
</samp></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="frame_tile_offset.gif"><img src="frame_tile_offset.gif" width="148" height="118" align="middle" vspace="0" hspace="5" border="0" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>This method of framing isn't too bad for this specific type of edge image, though for other types of frames it can look very silly. Basically the corners are not correct, and for most frames you really want to have the edge images meet at a 45 degree angle joint, just as you would have in a real picture frame. One solution to this is to pre-generate by hand appropriate corner images that we can now overlay onto this image to make it correct. This works well for a simple stretchable framing image (like 'black thin' framing image), but it will fail rather badly for a tileable image like 'bamboo' as the corner image will probably not fit the tile image properly. The better way is to generate corner joints directly from the tiled edge images. And I'll be showing you methods of doing this later. <a name="frame_extended" id="frame_extended"></a>
          <h3>Extended Overlay Framing</h3>Also you can make this type of edge framing look even better by extending the frames beyond the bounds of the original image. This is often seen for a 'Home-Sweet-Home' type picture. To do this you will need to first enlarge the original image with lots of extra space into which the longer frame pieces are overlaid.
          <div align="center">
            <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="90%" bgcolor="#F8F8F8">
              <tr>
                <td>
                  <pre class="bg-light text-dark mx-4"><samp>
  magick thumbnail.gif -alpha set -bordercolor none -border 34 \
          \( -size 144x14 -tile-offset +30+0 tile:bamboo.gif -transpose \) \
          -geometry +20+10 -composite \
          \( -size 144x14 -tile-offset +45+0 tile:bamboo.gif -transpose \) \
          -geometry +154+0 -composite \
          \( -size 178x14 -tile-offset +60+0 tile:bamboo.gif \) \
          -geometry +0+20 -composite \
          \( -size 178x14 -tile-offset +0+0  tile:bamboo.gif \) \
          -geometry +10+124 -composite \
          frame_overlaid.gif
</samp></pre>
                </td>
              </tr>
            </table><a href="frame_overlaid.gif"><img src="frame_overlaid.gif" width="188" height="158" align="middle" vspace="5" hspace="5" border="0" alt="[IM Output]"></a>
          </div>Note the measurements and positioning for this type of framing is not simple, and could use some randomization such as I hardcoded into the above example. Also you can improve the look further by rounding of the ends of the lengths of frame, with some additional and appropriate shading. A much better way of framing images in this manner is to generate the framing image as a complete unit, and just overlay it on a fixed size image (see <a href="#border_overlay">Simple Border Overlay</a>). However doing this means you can no longer slightly randomize the lengths and position of each framing piece. <a name="frame_joints" id="frame_joints"></a>
          <h3>45 degree corner joints</h3>The better solution is to somehow add the framing images around the thumbnail in such a way as to actually create a 45 degree joint in each of the corners of the frame. This is not easy, and I went though a number of drawing and masking methods until I re-discovered a magical operator called <a href="../crop/#frame">Frame, 3D like Borders</a>.
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr valign="bottom">
              <td width="100%" align="justify">
                The solution then was simple. Read in the image, and "<code><a href="../option_link.cgi?frame">-frame</a></code>" it, to create a template which of the areas to be framed.
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre class="bg-light text-dark mx-4"><samp>
  magick thumbnail.gif -alpha set -bordercolor none \
          -compose Dst_Out -frame 15x15+15  frame_template.gif
</samp></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="frame_template.gif"><img src="frame_template.gif" width="150" height="120" align="middle" vspace="0" hspace="5" border="0" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>Now note that this template as some interesting features. First it is transparent in the middle, where the main image will sit. Second it has four and only four distinct colors defining each area in which we want to place our framing images. It does not generate 'anti-aliaing' pixels of varing colors in the corners. Note that to make things easier the width of those areas (15 pixels) is width of the framing pieces we will add to the image. if the vertical edges were a different thickness to the horizontal edges, this technique would not work very well. In fact few methods would would well in such a situation. This image is the framing template and by tiling each of our framing pieces into the four differently colored areas using <a href="../draw/#color">Color Fill Primitives</a>, we will get our 45 degree corner joints, very simply and easily.
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr valign="bottom">
              <td width="100%" align="justify">
                For example...
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre class="bg-light text-dark mx-4"><samp>
  magick frame_template.gif \
          -tile blackthin_top.gif -draw 'color 1,0 floodfill' \
          frame_top_filled.gif
</samp></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="frame_top_filled.gif"><img src="frame_top_filled.gif" width="150" height="120" align="middle" vspace="0" hspace="5" border="0" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>You can repeat this process for the other three edges. Using transposes to ensure that the highlights and shaodws of the internal detail remain correct.
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr>
              <td width="100%" align="justify">
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre class="bg-light text-dark mx-4"><samp>
  magick frame_template.gif \
          -tile blackthin_top.gif   -draw 'color 1,0 floodfill' \
          -tile-offset +0+105 -tile blackthin_btm.gif \
                                       -draw 'color 15,105 floodfill' \
          -transpose \
          -tile blackthin_top.gif      -draw 'color 1,0 floodfill' \
          -tile-offset +0+135 -tile blackthin_btm.gif \
                                       -draw 'color 15,135 floodfill' \
          -transpose \
          -gravity center thumbnail.gif -composite frame_filled.gif
</samp></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="frame_filled.gif"><img src="frame_filled.gif" width="150" height="120" align="middle" vspace="0" hspace="5" border="0" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>From an IM forum discussion <a href="../forum_link.cgi?f=1&amp;t=21867">45 degree frame joints</a> a simplier solution, involving pre-rotating the bottom edge was found. Here is the full example using the <a href="../files/#mpr">In Memory Register</a> to save intermediate images.
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr>
              <td width="100%" align="justify">
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre class="bg-light text-dark mx-4"><samp>
  magick thumbnail.gif                -write mpr:image    +delete \
          goldthin_top.png             -write mpr:edge_top +delete \
          goldthin_btm.png -rotate 180 -write mpr:edge_btm +delete \
          \
          mpr:image -alpha set -bordercolor none \
          -compose Dst -frame 25x25+25  -compose over \
          \
          -tile mpr:edge_btm \
          -transverse -draw 'color 1,0 floodfill' \
          -transpose  -draw 'color 1,0 floodfill' \
          -tile mpr:edge_top \
          -transverse -draw 'color 1,0 floodfill' \
          -transpose  -draw 'color 1,0 floodfill' \
          \
          mpr:image -gravity center -composite    frame_gold.png
</samp></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="frame_gold.png"><img src="frame_gold.png" width="170" height="140" align="middle" vspace="0" hspace="5" border="0" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>As you can see we still have a problem, it looks very artifical in the top left and bottom right corner, due to a diagonal mirror effect that results from the tiling. To fix this we need to add a randomised "<code><a href="../option_link.cgi?tile-offset">-tile-offset</a></code>", so as to remove this mirror effect.
          <table border="0" cellspacing="0" cellpadding="0" width="90%" align="center">
            <tr valign="top">
              <td><img src="../img_www/warning.gif" width="28" height="28"><img src="../img_www/space.gif" width="12" height="16"></td>
              <td align="justify" width="100%"><font size="-1"><i><a href="../canvas/#tile-offset">Tile Offset</a> setting was broken before IM version 6.3.9-9 in that the 'X' offset was being used for both 'X' and 'Y' offset values (the given 'Y' value was ignored). This means that the above example will probably incorrectly tile the bottom and right edges, in older releases of IM.</i></font></td>
            </tr>
          </table><b>Scripted Version</b><b>This needs to be re-written using the last example as template</b>You can of course do all the above in a single command. However lets do it in a scripted way. This version uses some in-line code to generate appropriate edging images from the base images provided using <a href="../warping/#rect_rotates">Simple Distorts</a> and some randomized <a href="../warping/#roll">Image Rolls</a> to improve the overall look of the tiled image. These can be adjusted depending on the type of edge framing image that was provided. The processed edging images are then tiled using an <a href="../canvas/#tile_memory">In-Memory Tile Image</a> technique and the frame template (generated) is used to mask those images, as we did above.
          <div align="center">
            <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="90%" bgcolor="#F8F8F8">
              <tr>
                <td>
                  <pre><code execute="" script="" random="" image="framed_script.png">
  image=thumbnail.gif
     image_w=`magick $image -format %w info:`
     image_h=`magick $image -format %h info:`

  top=goldthin_top.png
  btm=goldthin_btm.png

     width=`magick $top -format %h info:`
     length=`magick $top -format %w info:`

  # Size of the new image ( using BASH integer maths)
  new_size=$(($image_w+$width*2))x$(($image_h+$width*2))

  # IM options to read a 'randomly rolled' version for the edge pieces
  lft="( $top -roll +$(($RANDOM % $length))+0  -transpose )"
  rht="( $btm -roll +$(($RANDOM % $length))+0  -transpose )"

  # IM options to 'randomly rolled' the top and bottom pieces
  top="( $top -roll +$(($RANDOM % $length))+0 )"
  btm="( $btm -roll +$(($RANDOM % $length))+0 )"

  # Frame the image in a single IM command....
  magick -page +$width+$width  $image  +page -alpha set \
    \( +clone -compose Dst -bordercolor none -frame ${width}x$width+$width \
       -fill none -draw "matte 0,0 replace" \
          -flip   -draw "matte 0,0 replace"   -flip \) \
    \( $top $btm -append -background none -splice 0x${image_h}+0+$width \
       -write mpr:horz +delete -size $new_size tile:mpr:horz +size \
       -clone 1  -compose DstOut -composite \) \
    \( $lft $rht +append -background none -splice ${image_w}x0+$width+0 \
       -write mpr:vert +delete -size $new_size tile:mpr:vert +size \
       -clone 1  -compose DstIn -composite \) \
    -delete 1  -compose Over  -mosaic   framed_script.png
</code></pre>
                </td>
              </tr>
            </table><a href="framed_script.png"><img src="framed_script.png" width="170" height="140" align="middle" vspace="5" hspace="5" border="0" alt="[IM Output]"></a>
          </div>And there we have a perfectly framed image with 45 degree corner joints, with randomized tiling offsets. Yes it is a complex example. But that is to allow the use of <a href="../canvas/#tile_memory">In-Memory Tile Images</a> so we can pre-process the framing images, all in the one command. This makes it more complex but also more versatile. The above code has been built into a shell script, which you can download ("<code><a href="../scripts/frame_edges.tar.gz">frame_edges.tar.gz</a></code>" from the <a href="../scripts/">IM Example Scripts</a> directory). This tar file includes the script and a set of framing images, that the script understands how to process and use. It also adds a 'cardboard' border between the frame and the image proper.
          <h4>Future example</h4>Using tiling edges with matching corner peices. The edge images will need to match up to pre-prepared corner pieces, but also tile neatly across the fixed length of the image. That means that the whole tiled edge may need some stretching or compression so as to align the edge tiles with its corner pieces. To work properly teh edge tiles must repeat at least 3 or 4 times across the smallest image edge. An example of this type of tiled edge/corner is the implementation of a border of 'leaves' or 'fleur' effects.
        </div>
        <hr>
        <!-- ---------------------------------------------------------------- -->
      </div>
    </div>
  </main>
  <footer class="magick-footer">
    <div class="container-fluid">
      Created: 8 February 2004<br>
      Updated: 18 July 2014<br>
      Author: <a href="https://antofthy.gitlab.io/anthony.html">Anthony Thyssen</a>, &lt;Anthony.Thyssen@gmail.com&gt;<br>
      Examples Generated with: <img src="version.gif" align="absmiddle" alt="[version image]"><br>
      URL: <code>https://imagemagick.org/Usage/thumbnails/</code>
    </div>
  </footer>
</body>
</html>
