<HTML><HEAD>
<meta charset="utf-8" >
<meta name="viewport" content="width=device-width" >
<link rel="stylesheet" href="../assets/usage.css">
<TITLE>Text Handling -- ImageMagick Examples</TITLE>
<LINK REL="icon" HREF="../img_www/favicon.ico" type="image/x-icon">
<LINK REL="shortcut" HREF="../img_www/favicon.ico" type="image/x-icon">
<LINK REL="canonical" HREF="https://imagemagick.org/Usage/text/">
</HEAD><body><main class="container"><div class="magick-template"><div class="magick-header">

<H1>ImageMagick Examples -- <BR>
    <IMG SRC="../img_www/space.gif" width=50 height=1>
    Text to Image Handling</H1>

<div>

<B>Index</B><BR>
<TABLE CELLSPACING=0 width="100%">
<TR valign="top"><TD COLSPAN=2>
<A HREF="../"
   ><IMG SRC="../img_www/granitesm_left.gif" BORDER=0 WIDTH=15 HEIGHT=15
   > ImageMagick Examples Preface and Index</A>
</TD></TR>
<TR valign="top"><TD><DL>

<DD><A HREF="#text_operators"
    ><IMG SRC="../img_www/granitesm_right.gif" BORDER=0 WIDTH=15 HEIGHT=15
    > Text Operators in ImageMagick</A>
    <IMG SRC="../img_www/space.gif" WIDTH=20 HEIGHT=1>
<DD><A HREF="#label"
    ><IMG SRC="../img_www/granitesm_right.gif" BORDER=0 WIDTH=15 HEIGHT=15
    >Label</A>
    <IMG SRC="../img_www/space.gif" WIDTH=20 HEIGHT=1>
    <FONT SIZE=-1> - Simple Text Label</FONT>
    <UL>
    <LI><A HREF="#label"             >Basic Labels</A>
    <LI><A HREF="#label_bestfit"     >Best Fit Labels</A>
    <LI><A HREF="#label_lines"       >Labels over Multiple Lines</A>
    <LI><A HREF="#label_vertical"    >Vertical Labels</A>
    </UL>
<DD><A HREF="#caption"
    ><IMG SRC="../img_www/granitesm_right.gif" BORDER=0 WIDTH=15 HEIGHT=15
    >Caption</A>
    <IMG SRC="../img_www/space.gif" WIDTH=20 HEIGHT=1>
    <FONT SIZE=-1> - Word Wrapped Labels</FONT>
    <UL>
    <LI><A HREF="#caption"            >Basic Caption</A>
    <LI><A HREF="#caption_bestfit"    >Best Fit Captions</A>
    <LI><A HREF="#caption_paragraphs" >Captions with Paragraphs</A>
    </UL>
<DD>&nbsp;
<DD><A HREF="#attributes"
    ><IMG SRC="../img_www/granitesm_right.gif" BORDER=0 WIDTH=15 HEIGHT=15
    >Text Attributes and Settings</A>
    <UL>
    <LI><A HREF="#attributes"        >Text Attributes</A>
    <LI><A HREF="#pointsize"         >Pointsize and Density</A>
    <LI><A HREF="#bounds"            >Label Image Bounds</A>
    <LI><A HREF="#unicode"           >Unicode labels</A>
    <LI><A HREF="#symbol"            >Symbol Fonts</A>
    <LI><A HREF="#kerning"           >Inter-Character Kerning</A>
    <LI><A HREF="#interword-spacing" >Inter-Word Spacing</A>
    <LI><A HREF="#interline-spacing" >Inter-Line Spacing</A>
    </UL>
<DD><A HREF="#escape_chars"
    ><IMG SRC="../img_www/granitesm_right.gif" BORDER=0 WIDTH=15 HEIGHT=15
    >Special Escape Characters in Text Arguments</A>
    <UL>
    <LI><A HREF="#escape_chars"     >Handling Escape Characters</A>
    <LI><A HREF="#user_escapes"     >User defined option escapes</A>
    <LI><A HREF="#escaping_escapes" >Escaping Escapes</A>
    </UL>

</DL></TD>
<TD><DL>

<DD><A HREF="#pango"
    ><IMG SRC="../img_www/granitesm_right.gif" BORDER=0 WIDTH=15 HEIGHT=15
    >Pango</A>
    <IMG SRC="../img_www/space.gif" WIDTH=20 HEIGHT=1>
    <FONT SIZE=-1> - Basic Formatted Text</FONT>
    <UL>
    <LI><A HREF="#pango"         >Pango with Plain Text</A>
    <LI><A HREF="#pango_markup"  >Pango Markup Language</A>
    <LI><A HREF="#pango_notes"   >Pango Notes and Problems</A>
    </UL>
<DD><A HREF="#text"
    ><IMG SRC="../img_www/granitesm_right.gif" BORDER=0 WIDTH=15 HEIGHT=15
    >Text</A>
    <IMG SRC="../img_www/space.gif" WIDTH=20 HEIGHT=1>
    <FONT SIZE=-1> - Pages of Plain Text</FONT>
    <UL>
    <LI><A HREF="#text"               >Plain Text</A>
    <LI><A HREF="#text_trim"          >Trimming Text Page</A>
    </UL>
<DD><A HREF="#postscript"
    ><IMG SRC="../img_www/granitesm_right.gif" BORDER=0 WIDTH=15 HEIGHT=15
    >Postscript/PDF</A>
    <IMG SRC="../img_www/space.gif" WIDTH=20 HEIGHT=1>
    <FONT SIZE=-1> - documents to images</FONT>
    <UL>
    <LI><A HREF="#ghostscript"        >Using Ghostscript Directly</A>
    </UL>
<DD>&nbsp;
<DD><A HREF="#draw"
    ><IMG SRC="../img_www/granitesm_right.gif" BORDER=0 WIDTH=15 HEIGHT=15
    >Draw</A>
    <IMG SRC="../img_www/space.gif" WIDTH=20 HEIGHT=1>
    <FONT SIZE=-1> - Draw Text on Existing Canvas</FONT>
    <UL>
    <LI><A HREF="#box"       >Undercolor Box</A>, &nbsp; &nbsp;
    <LI><A HREF="#overflow"  >Bounding Box Overflow</A>
    </UL>
<DD><A HREF="#annotate"
    ><IMG SRC="../img_www/granitesm_right.gif" BORDER=0 WIDTH=15 HEIGHT=15
    >Annotate</A>
    <IMG SRC="../img_www/space.gif" WIDTH=20 HEIGHT=1>
    <FONT SIZE=-1> - Better Text Drawing</FONT>
    <UL>
    <LI><A HREF="#annotate_size" >Automatically Sized Annotated Text Canvas</A>
    <LI><A HREF="#autosize_box"  >Autosizing using an Undercolor Box</A>
    <LI><A HREF="#coloring_text" >Coloring a Gray-scale Text Image</A>
    </UL>
<DD>&nbsp;
<DD><A HREF="#font"
    ><IMG SRC="../img_www/granitesm_right.gif" BORDER=0 WIDTH=15 HEIGHT=15
    >Fonts Paths</A> (under development)
    <IMG SRC="../img_www/space.gif" WIDTH=20 HEIGHT=1>
    <FONT SIZE=-1></FONT>
<DD><A HREF="#font_info"
    ><IMG SRC="../img_www/granitesm_right.gif" BORDER=0 WIDTH=15 HEIGHT=15
    >Determining Font Metrics</A>
    <IMG SRC="../img_www/space.gif" WIDTH=20 HEIGHT=1>
    <FONT SIZE=-1></FONT>
<DD><A HREF="#mixed_font_lines"
    ><IMG SRC="../img_www/granitesm_right.gif" BORDER=0 WIDTH=15 HEIGHT=15
    >Creating Lines of Mixed Font Styles</A>
    <IMG SRC="../img_www/space.gif" WIDTH=20 HEIGHT=1>
    <FONT SIZE=-1></FONT>
<DD><A HREF="#form_filling"
    ><IMG SRC="../img_www/granitesm_right.gif" BORDER=0 WIDTH=15 HEIGHT=15
    >Form Filling</A>
    <IMG SRC="../img_www/space.gif" WIDTH=20 HEIGHT=1>
    <FONT SIZE=-1> - layered text fields on images</FONT>
<DD><A HREF="#tex"
    ><IMG SRC="../img_www/granitesm_right.gif" BORDER=0 WIDTH=15 HEIGHT=15
    >Text Processing Alternatives</A>
    <IMG SRC="../img_www/space.gif" WIDTH=20 HEIGHT=1>
    <FONT SIZE=-1></FONT>

</DL>
</TD></TR></TABLE></P>

Creating text labels, or adding text to images is probably one of the most
basic and common operations for which ImageMagick is used.  It is also one of
the most simplest, but with scope for some very fancy results.  As such this
is a good place to start our exploration of IM's capabilities. </P>

<HR><!-- ---------------------------------------------------------------- -->

<A NAME="text_operators"></A>
<H2>Text Operators in ImageMagick</H2>

ImageMagick has a lot of different ways in which you can draw text within an
image, highlighting the versatility of the image processing library. This
page details specific methods and styles of drawing text. </P>

What you have to keep in mind as you study these examples is that ImageMagick
is primarily an image converter and modifier.  As such each of methods provided
are simple text drawing operators, such as adding labels and copyright
messages to images. See <A HREF="../annotating/" >Annotating Images</A>. </P>

All the text operators also understand and use a set of standard text
processing settings such as, the "<CODE><A HREF="../option_link.cgi?font"
>-font</A></CODE>", "<CODE><A HREF="../option_link.cgi?pointsize"
>-pointsize</A></CODE>" to use.  Also the "<CODE><A
HREF="../option_link.cgi?fill" >-fill</A></CODE>" color setting and for more
complex text drawing the "<CODE><A HREF="../option_link.cgi?strokewidth"
>-strokewidth</A></CODE>", "<CODE><A HREF="../option_link.cgi?stroke"
>-stroke</A></CODE>" and "<CODE><A HREF="../option_link.cgi?undercolor"
>-undercolor</A></CODE>" colors.  In cases where you actually create a new
image, such as label and captions, the "<CODE><A
HREF="../option_link.cgi?background" >-background</A></CODE>" color setting is
also used.  </P>

And finally the newer "<CODE><A HREF="../option_link.cgi?kerning"
>-kerning</A></CODE>" and "<CODE><A
HREF="../option_link.cgi?interword-spacing" >-interword-spacing</A></CODE>"
modifiers. </P>

What ImageMagick is <I>not</I>, is a full formatted text and document
processor.  If you want heavy text processing, you are better off using a full
interactive word-processor, or batch text formatter like "<CODE>TeX</CODE>"
(or or one of its flavors (see <A HREF="#tex" >A Complete Text Processing
System</A> below).  The output of these programs (generally postscript format)
can then be converted into an image and further modified by ImageMagick. That
is, use the right tool for the right job. </P>

That said some mixed font handling can be done. For a starting point look at
<A HREF="#mixed_font_lines" >Creating Lines of Mixed Font Styles</A>, near the
bottom of this page. </P>

Now, lets now look at the basic ways you can magick text into images. Later
in the next section (<A HREF="../fonts/" >Compound Fonts</A> we'll look at
generating some interesting font effects. </P>

<HR><!-- ---------------------------------------------------------------- -->
<A NAME="label"></A>
<H2>Label - Simple Text Label</H2>

<H3>Basic Labels</H3>

Creating a font image using a "<CODE>label:</CODE>" image, is the more typical
way of drawing a font quickly in ImageMagick.  The biggest advantage is that
generates its own canvas according the current "<CODE><A
HREF="../option_link.cgi?background" >-background</A></CODE>" and "<CODE><A
HREF="../option_link.cgi?fill" >-fill</A></CODE>" color settings, which is
sized to match the drawn text. </P>

For example here is a typical generated label.

<DIV ALIGN=center>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="90%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  magick -background lightblue -fill blue \
          -font Candice -pointsize 72 label:Anthony \
          label.gif
</samp></pre></TD></TR></TABLE>
  <A HREF="label.gif"
     ><IMG SRC="label.gif"
           ALIGN=middle VSPACE=5 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</DIV></P>

The above is probably the most typical usage of label, with a font selection
and "<CODE><A HREF="../option_link.cgi?pointsize" >-pointsize</A></CODE>"
defining the results.  But it by far the least interesting way of generating
text labels. </P>

<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH=90% ALIGN=center>
<TR valign="top">
<TD><IMG SRC="../img_www/reminder.gif" WIDTH=20 HEIGHT=16
    ><IMG SRC="../img_www/space.gif"   WIDTH=17 HEIGHT=16></TD>
<TD ALIGN=justify width="100%"><FONT SIZE=-1><I>
  The '<CODE>label:</CODE>' image generated will also have the
  '<CODE>label</CODE>' <A HREF="../basics/#set" >Image Property</A> meta-data
  set to the same string.  Some file formats, such as MIFF and PNG, will save
  that specific property and can be used in later image processing programs.
  For and example of using 'label' meta-data, see <A
  HREF="../montage/#metadata" >Montage using Saved Meta-Data</A> for examples.

</I></FONT></TD></TR></TABLE></P>


If you also specify a "<CODE><A HREF="../option_link.cgi?size"
>-size</A></CODE>" then the generated label image will be created at that
size.

<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 width="100%">
<TR><TD width="100%" ALIGN=justify>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="100%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  magick -background lightblue -fill blue  -font Candice \
          -size 165x70 -pointsize 24 label:Anthony     label_size.gif
</samp></pre></TD></TR></TABLE></TD><TD>
  <A HREF="label_size.gif"
     ><IMG SRC="label_size.gif"
           ALIGN=middle VSPACE=0 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</TD></TR></TABLE></P>

You can also use "<CODE><A HREF="../option_link.cgi?gravity"
>-gravity</A></CODE>" to set the position of the label within that larger box.

<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 width="100%">
<TR><TD width="100%" ALIGN=justify>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="100%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  magick -background lightblue -fill blue  -font Candice \
          -size 165x70  -pointsize 24  -gravity center \
          label:Anthony     label_gravity.gif
</samp></pre></TD></TR></TABLE></TD><TD>
  <A HREF="label_gravity.gif"
     ><IMG SRC="label_gravity.gif"
           ALIGN=middle VSPACE=0 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</TD></TR></TABLE></P>

Of course if you do not set a "<CODE><A HREF="../option_link.cgi?size"
>-size</A></CODE>" for the label, no extra space will be available in the
generated "<CODE>label:</CODE>" for "<CODE><A HREF="../option_link.cgi?gravity"
>-gravity</A></CODE>" to use, making it rather useless. </P>

The problem with using BOTH "<CODE><A HREF="../option_link.cgi?size"
>-size</A></CODE>" and "<CODE><A HREF="../option_link.cgi?pointsize"
>-pointsize</A></CODE>" together is that the text could 'overflow' the
specified image size.

<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 width="100%">
<TR><TD width="100%" ALIGN=justify>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="100%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  magick -background lightblue -fill blue  -font Candice \
          -size 165x70  -pointsize 72  -gravity center \
          label:Anthony     label_overflow.gif
</samp></pre></TD></TR></TABLE></TD><TD>
  <A HREF="label_overflow.gif"
     ><IMG SRC="label_overflow.gif"
           ALIGN=middle VSPACE=0 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</TD></TR></TABLE></P>

<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH=90% ALIGN=center>
<TR valign="top">
<TD><IMG SRC="../img_www/warning.gif"  WIDTH=28 HEIGHT=28
    ><IMG SRC="../img_www/space.gif"   WIDTH=12 HEIGHT=16></TD>
<TD ALIGN=justify width="100%"><FONT SIZE=-1><I>
  Before version 6.5.2-4, IM would completely ignore the "<CODE><A
  HREF="../option_link.cgi?pointsize" >-pointsize</A></CODE>" setting if
  a "<CODE><A HREF="../option_link.cgi?size" >-size</A></CODE>" setting is
  also given.  This causes the text in the above images to be auto-sized
  according to the 'best fit' handling (see next set of examples).

</I></FONT></TD></TR></TABLE></P>


<A NAME="label_bestfit"></A>
<A NAME="best_fit"></A><!-- depreciate 20 July 2009 -->
<H3>Best Fit to Image</H3>

The biggest trick to using labels to generate images of a specific "<CODE><A
HREF="../option_link.cgi?size" >-size</A></CODE>" is NOT to specify a
"<CODE><A HREF="../option_link.cgi?pointsize" >-pointsize</A></CODE>" for the
label.  When this happens IM will have the freedom to try and select a font
size that <I>best fits</I> the image size requested.  That is the drawn text
will be adjusted to fit the given size!

<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 width="100%">
<TR><TD width="100%" ALIGN=justify>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="100%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  magick -background lightblue -fill blue  -font Candice \
          -size 165x70  label:Anthony     label_size_fit.gif
</samp></pre></TD></TR></TABLE></TD><TD>
  <A HREF="label_size_fit.gif"
     ><IMG SRC="label_size_fit.gif"
           ALIGN=middle VSPACE=0 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</TD></TR></TABLE></P>

As you can see by setting a "<CODE><A HREF="../option_link.cgi?size"
>-size</A></CODE>" setting, you could end up with some extra space to the
right or below the image. </P>

<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH=90% ALIGN=center>
<TR valign="top">
<TD><IMG SRC="../img_www/reminder.gif" WIDTH=20 HEIGHT=16
    ><IMG SRC="../img_www/space.gif"   WIDTH=17 HEIGHT=16></TD>
<TD ALIGN=justify width="100%"><FONT SIZE=-1><I>
   When IM creates a 'bestfit' label, the actual pointsize it used is also
   saved into the '<CODE>label:pointsize</CODE>' <A HREF="../basics/#set"
   >Image Property</A>, allowing you you use that information later.  This
   was added to IM v6.6.2-7, during the forum discussion <A
   HREF="../forum_link.cgi?t=16449" >Pointsize Reporting</A>

</I></FONT></TD></TR></TABLE></P>

You can still adjust the position of the label in
that extra space by adjusting the "<CODE><A HREF="../option_link.cgi?gravity"
>-gravity</A></CODE>" setting.

<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 width="100%">
<TR><TD width="100%" ALIGN=justify>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="100%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  magick -background lightblue -fill blue  -font Candice \
          -size 165x70 -gravity center label:Anthony     label_size_gravity.gif
</samp></pre></TD></TR></TABLE></TD><TD>
  <A HREF="label_size_gravity.gif"
     ><IMG SRC="label_size_gravity.gif"
           ALIGN=middle VSPACE=0 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</TD></TR></TABLE></P>

Of course if you do not set a "<CODE><A HREF="../option_link.cgi?size"
>-size</A></CODE>" for the label, no extra space will be available in the
generated "<CODE>label:</CODE>" for "<CODE><A HREF="../option_link.cgi?gravity"
>-gravity</A></CODE>" to use, so it only makes sense when you ask for the
image to be a specific size. </P>

Now for the best news. If the "<CODE><A HREF="../option_link.cgi?size"
>-size</A></CODE>" setting you give only contains just width or the height for
the label, the font will be adjusted to best fit that given dimension. The
other dimension not specified will then be auto-adjusted to fit that text!

<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 width="100%">
<TR><TD width="100%" ALIGN=justify>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="100%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  magick -background lightblue -fill blue -font Candice \
          -size 160x  label:Anthony     label_size_width.gif
</samp></pre></TD></TR></TABLE></TD><TD>
  <A HREF="label_size_width.gif"
     ><IMG SRC="label_size_width.gif"
           ALIGN=middle VSPACE=5 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</TD></TR></TABLE></P>

Basically that means the above "<CODE>label:</CODE>" will always be 160 pixels
wide, with the largest font size for that width. The height of the label will
then be adjusted to suit. </P>

The same thing will be done if the height is specified but not the width.

<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 width="100%">
<TR><TD width="100%" ALIGN=justify>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="100%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  magick -background lightblue -fill blue -font Candice \
          -size x40  label:Anthony     label_size_height.gif
</samp></pre></TD></TR></TABLE></TD><TD>
  <A HREF="label_size_height.gif"
     ><IMG SRC="label_size_height.gif"
           ALIGN=middle VSPACE=5 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</TD></TR></TABLE></P>

This label is 40 pixels high, the undefined pointsize of the text was adjusted
to fit that height, and then the undefined width was set to fit the drawn
text.  Exacly as you would expect. </P>

Of course in this case there will again be little if no extra space for any
"<CODE><A HREF="../option_link.cgi?gravity" >-gravity</A></CODE>" setting to
play with.  </P>


<A NAME="label_lines"></A>
<A NAME="multi-lines"></A><!-- depreciate 20 July 2009 -->
<H3>Labels over Multiple Lines</H3>

The "<CODE>label:</CODE>" generator can (as of IM version 6.2.5)
generate multi-line labels.

<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 width="100%">
<TR><TD width="100%" ALIGN=justify>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="100%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  magick -background lightblue  -fill blue  -font Ravie -pointsize 20 \
          label:'ImageMagick\nRules - OK!'     label_multiline.gif
</samp></pre></TD></TR></TABLE></TD><TD>
   <A HREF="label_multiline.gif"
      ><IMG SRC="label_multiline.gif"
            ALIGN=middle VSPACE=5 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</TD></TR></TABLE></P>

As you can see "<CODE>label:</CODE>" understands the use of '<CODE>\n</CODE>'
as representing newlines.  This means you may have to pre-process your input
text to ensure that any special characters are escaped when placing the data
on the command line.  See <A HREF="#escape_chars" >Special Escape Characters
in Text Arguments</A> below for more details. </P>

As "<CODE><A HREF="../option_link.cgi?gravity" >-gravity</A></CODE>" also
effects "<CODE>label:</CODE>" generation (as of IM version 6.2.6), you can use
it to 'justify' multi-line labels.

<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 width="100%">
<TR><TD width="100%" ALIGN=justify>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="100%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  magick -background lightblue -fill blue -font Corsiva -pointsize 24 \
          -gravity center    label:'ImageMagick\nExamples\nby Anthony' \
          label_centered.gif
</samp></pre></TD></TR></TABLE></TD><TD>
  <A HREF="label_centered.gif"
     ><IMG SRC="label_centered.gif"
           ALIGN=middle VSPACE=5 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</TD></TR></TABLE></P>

One important feature of IM is that it can read the text data to use from a
file.  This is done by prefixing the filename with an 'at' character
'<CODE>@</CODE>', and using this as the string argument. </P>

For example, here we create a label from my workstations 'message of the day'
file...

<DIV ALIGN=center>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="90%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
<r>  magick -background lightblue  -fill blue \
          label:@/etc/motd   label_file.gif
</samp></pre></TD></TR></TABLE>
   <A HREF="label_file.gif"
      ><IMG SRC="label_file.gif"
            ALIGN=middle VSPACE=5 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</DIV></P>

You can also read the text for a label from the standard input pipeline.  For
example here I magick the output of a quote generator to a multi-line label.

<DIV ALIGN=center>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="90%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  mesgs ImageResolution |\
    magick -background lightblue  -fill blue \
            label:@-   label_file_multiline.gif
</samp></pre></TD></TR></TABLE>
   <A HREF="label_file_multiline.gif"
      ><IMG SRC="label_file_multiline.gif"
            ALIGN=middle VSPACE=5 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</DIV></P>

Notice that the filename I used was just a '<CODE>-</CODE>' character.  This
means that the file is to be read from standard input.  Remember you can use
the '<CODE>@<I>filename</I></CODE>' to read ANY command line string arguments
into IM. This includes all the other text input methods given below. However
it can only be used to replace the whole string argument, not a part of a
string argument. </P>

Note also that in the above examples, an extra blank line was added to the
label image.  This blank line is caused by a final newline in the input text
file.  Unless you somehow strip the final newline from the input file (see <A
HREF="#caption" >caption:</A> example below for method to fix this),
"<CODE>label:</CODE>" will always have this blank line from input text files.
</P>

<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH=90% ALIGN=center>
<TR valign="top">
<TD><IMG SRC="../img_www/warning.gif"  WIDTH=28 HEIGHT=28
    ><IMG SRC="../img_www/space.gif"   WIDTH=12 HEIGHT=16></TD>
<TD ALIGN=justify width="100%"><FONT SIZE=-1><I>
  Most older versions of IM (before v6.2.5), do not handle multiple line
  labels.  In these versions the lines would have been appended together to
  form a single, very very long line.
</I></FONT></TD></TR></TABLE></P>


<A NAME="label_vertical"></A>
<H3>Vertical Labels</H3>

Of course you can also add newlines to the input text too.  For example here I
take a simple word and add a newline between each and every letter, to create
some centered vertical text.

<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 width="100%">
<TR valign="top"><TD width="100%" ALIGN=justify>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="100%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  echo -n "Vertical" | sed 's/./&@/g; s/@$//' | tr '@' '\012' |\
    magick -background lightblue -fill blue -font Ravie -pointsize 24 \
            -gravity center    label:@-   label_vertical.gif
</samp></pre></TD></TR></TABLE></P>

Note that the "<CODE>sed</CODE>" command adds a '@' character after every
character, except at the end of the string.  The "<CODE>tr</CODE>" then
replaces the '@' characters with newlines.  It also assumes the input text
does not end with a newline, which would cause an extra blank space to be added
at the bottom of the resulting image. </P>

</TD><TD>
  <A HREF="label_vertical.gif"
     ><IMG SRC="label_vertical.gif"
           ALIGN=middle VSPACE=0 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</TD></TR></TABLE></P>

Users running linux, and thus using the GNU version of the "<CODE>sed</CODE>"
command can remove the "<CODE>tr</CODE>", and replace the '<CODE>@</CODE>'
with '<CODE>\n</CODE>' in the sed command, so it directly inserts the
newlines between each character. </P>

See also the special attribute <A HREF="#interline-spacing" >Inter-Line
Spacing</A> which can be used to adjust the space between the characters. </P>

<HR><!-- ---------------------------------------------------------------- -->

<A NAME="caption"></A>
<H2>Caption - Word Wrapped Label</H2>

The "<CODE>caption:</CODE>" image from text input generator, is in most
respects exactly like "<CODE><A HREF="#label" >label:</A></CODE>" except that
instead of expanding the size of the text to fit a specified "<CODE><A
HREF="../option_link.cgi?size" >-size</A></CODE>" setting, it word wraps any
long lines that do not fit into the specified "<CODE><A
HREF="../option_link.cgi?size" >-size</A></CODE>" width.  </P>

The "<CODE><A HREF="../option_link.cgi?size" >-size</A></CODE>" setting is not
optional however and must at least specify a maximum width in pixels.  </P>

For example here is a caption of a long line that will not fit into the width
specified.

<DIV ALIGN=center>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="90%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  magick -background lightblue  -fill blue  -font Corsiva -pointsize 36 \
          -size 320x   caption:'This is a very long caption line.' \
          caption.gif
</samp></pre></TD></TR></TABLE>
  <A HREF="caption.gif"
     ><IMG SRC="caption.gif"             WIDTH=320
           ALIGN=middle VSPACE=5 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</DIV></P>

<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH=90% ALIGN=center>
<TR valign="top">
<TD><IMG SRC="../img_www/reminder.gif" WIDTH=20 HEIGHT=16
    ><IMG SRC="../img_www/space.gif"   WIDTH=17 HEIGHT=16></TD>
<TD ALIGN=justify width="100%"><FONT SIZE=-1><I>
  The '<CODE>caption:</CODE>' image generated will also have the
  "<CODE>caption</CODE>" <A HREF="../basics/#set" >Image Property</A>
  meta-data 'set' to the same string, allowing you to re-use that information
  later.  All the common image file formats will save this information with
  the image.  See <A HREF="../montage/#metadata" >Montage using Saved
  Meta-Data</A> for examples.

</I></FONT></TD></TR></TABLE></P>

By default the text is all left justified, however as of IM version 6.2.0,
"<CODE>caption:</CODE>" respects "<CODE><A HREF="../option_link.cgi?gravity"
>-gravity</A></CODE>" for text justification purposes.

<DIV ALIGN=center>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="90%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  magick -background lightblue  -fill blue  -font Candice -pointsize 40 \
          -size 320x  -gravity Center  caption:'ImageMagick Rules OK!' \
          caption_centered.gif
</samp></pre></TD></TR></TABLE>
  <A HREF="caption_centered.gif"
     ><IMG SRC="caption_centered.gif"             WIDTH=320
           ALIGN=middle VSPACE=5 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</DIV></P>

If you do provide a height as well as a width to the "<CODE><A
HREF="../option_link.cgi?size" >-size</A></CODE>" setting, then the image
height will be set to that height as well.  You can then also use the
"<CODE><A HREF="../option_link.cgi?gravity" >-gravity</A></CODE>" setting, to
position the text vertically.

<DIV ALIGN=center>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="90%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  magick -background lightblue  -fill blue  -font Gecko -pointsize 32 \
          -size 320x100  -gravity South caption:'Captions at their height!' \
          caption_height.gif
</samp></pre></TD></TR></TABLE>
  <A HREF="caption_height.gif"
     ><IMG SRC="caption_height.gif"             WIDTH=320  HEIGHT=100
           ALIGN=middle VSPACE=5 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</DIV></P>

Please note however that if the text will not fit (height-wise) into the
"<CODE><A HREF="../option_link.cgi?size" >-size</A></CODE>" you specified with
the given "<CODE><A HREF="../option_link.cgi?pointsize" >-pointsize</A></CODE>",
then the text will overflow the box.  The current "<CODE><A
HREF="../option_link.cgi?gravity" >-gravity</A></CODE>" setting will naturally
determine what part of the text is cut off. </P>

For example this is exactly the same as the previous example, but with an
image "<CODE><A HREF="../option_link.cgi?size" >-size</A></CODE>" that is too
small for the result.

<DIV ALIGN=center>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="90%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  magick -background lightblue  -fill blue  -font Gecko -pointsize 32 \
          -size 320x60  -gravity South caption:'Captions at their height!' \
          caption_height_toosmall.gif
</samp></pre></TD></TR></TABLE>
  <A HREF="caption_height_toosmall.gif"
     ><IMG SRC="caption_height_toosmall.gif"      WIDTH=320  HEIGHT=60
           ALIGN=middle VSPACE=5 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</DIV></P>

<A NAME="caption_bestfit"></A>
<H3>Best Fit Caption</H3>

As of IM v6.3.2, if you provide both the width and the height of the final
image, but do not define the "<CODE><A HREF="../option_link.cgi?pointsize"
>-pointsize</A></CODE>" of the font  (or turn off the pointsize with "<CODE><A
HREF="../option_link.cgi?pointsize" >+pointsize</A></CODE>"), IM will attempt to
automatically adjust the size of the font so as to best fill the "<CODE><A
HREF="../option_link.cgi?size" >-size</A></CODE>" of the image you requested.
</P>

For example, here I ask ImageMagick to fill a fairly large area...

<DIV ALIGN=center>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="90%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  magick -background lightblue -fill blue -font Candice -size 320x140 \
          caption:'This text is resized to best fill the space given.' \
          caption_filled.gif
</samp></pre></TD></TR></TABLE>
  <A HREF="caption_filled.gif"
     ><IMG SRC="caption_filled.gif"             WIDTH=320  HEIGHT=140
           ALIGN=middle VSPACE=5 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</DIV>

<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 width="100%">
<TR VALIGN=bottom><TD width="100%" ALIGN=justify>

And now a much smaller thinner area, for the same font and text string.

<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="100%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  magick -background lightblue -fill blue -font Candice -size 80x110 \
          caption:'This text is resized to best fill the space given.' \
          caption_filled_sm.gif
</samp></pre></TD></TR></TABLE></TD><TD>
  <A HREF="caption_filled_sm.gif"
     ><IMG SRC="caption_filled_sm.gif"           WIDTH=80  HEIGHT=110
           ALIGN=middle VSPACE=0 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</TD></TR></TABLE></P>

Note that the ONLY difference between the last two examples is the "<CODE><A
HREF="../option_link.cgi?size" >-size</A></CODE>" of the image generated. IM
fitted the text and word wrapping so as to try and best fill the image size
specified. </P>

This is extremely useful for fitting an unknown bit of text into a given space,
without it overflowing the area bounds. However internally it is equivalent to
running caption multiple times as IM searches for the right point size to use
to best fill the given space. In other words it can often be 10 times or more
slower than if you supplied a specific "<CODE><A
HREF="../option_link.cgi?pointsize" >-pointsize</A></CODE>" to use. </P>

<A NAME="caption_paragraphs"></A>
<H3>Captions with Paragraphs</H3>

The "<CODE>caption:</CODE>" image operator (as of IM v6.2.5) understands the
use of the '<CODE>\n</CODE>' shell escape (and thus you need to double
backslash '<CODE>\\</CODE>' to escape backslashes), as meaning a new line or
paragraph.  Before this version separate paragraphs would have to be processed
by separate "<CODE>caption:</CODE>" operations.

<DIV ALIGN=center>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="90%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  magick -background lightblue -fill blue \
          -font Ravie -pointsize 24 -size 360x \
          caption:"Here I use caption to wordwrap.\nTwo separate lines." \
          caption_multi_line.gif
</samp></pre></TD></TR></TABLE>
  <A HREF="caption_multi_line.gif"
     ><IMG SRC="caption_multi_line.gif"       WIDTH=360
           ALIGN=middle VSPACE=5 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</DIV></P>

You can read the text to be drawn from a file, or standard input (from a
previous pipeline command), using the '<CODE>@</CODE>' filename prefix, just
as as we can with "<CODE><A HREF="#label" >label:</A></CODE>".

<DIV ALIGN=center>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="90%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  mesgs FilePrivate |\
    magick -background  lightblue  -fill blue  -pointsize 12 \
            -size 320x  caption:@-  caption_file.gif
</samp></pre></TD></TR></TABLE>
  <A HREF="caption_file.gif"
     ><IMG SRC="caption_file.gif"       WIDTH=320
           ALIGN=middle VSPACE=5 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</DIV></P>

As you can see newlines in the input text will (as of IM v6.2.5) will be
treated as paragraph separators.  This includes any final newlines in the
input file. Of course "<CODE><A HREF="#label" >label:</A></CODE>" will not
word wrap the lines, but preserve them. </P>

If you really want a file to be treated as a single paragraph, then you will
need to replace the newline characters with a space character, so your text is
all on one line.  For example, here we take the same text, but replace the line
feeds with spaces, then replace any multiple spaces between the words, with a
single space...

<DIV ALIGN=center>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="90%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  mesgs FilePrivate |      tr '\012' ' ' | sed 's/  */ /g' |\
    magick -background  lightblue  -fill blue  -pointsize 12 \
            -size 320x  caption:@-  caption_one_line.gif
</samp></pre></TD></TR></TABLE>
  <A HREF="caption_one_line.gif"
     ><IMG SRC="caption_one_line.gif"       WIDTH=320
           ALIGN=middle VSPACE=5 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</DIV></P>

As you can see this works a lot better. </P>

However often what you want is to treat a blank line as a paragraph break.
That means you need to remove all newlines, except those involved with blank
lines.  Here is a special "<CODE>sed</CODE>" command to magick such text
into the format needed by "<CODE>caption:</CODE>".  In this case the text is
the first page of the "<code>magick</code>" manpage.

<DIV ALIGN=center>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="90%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  man magick | col -b | expand | \
    sed '/^$/d; :loop y/\n/ /; N; /\n$/! b loop;  s/   */ /g; s/^ //' |\
      head -n 7 |    magick -size 400x  caption:@-  caption_manual.gif
</samp></pre></TD></TR></TABLE>
  <A HREF="caption_manual.gif"
     ><IMG SRC="caption_manual.gif"       WIDTH=400
           ALIGN=middle VSPACE=5 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</DIV></P>

<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH=90% ALIGN=center>
<TR valign="top">
<TD><IMG SRC="../img_www/reminder.gif" WIDTH=20 HEIGHT=16
    ><IMG SRC="../img_www/space.gif"   WIDTH=20 HEIGHT=16></TD>
<TD ALIGN=justify width="100%"><FONT SIZE=-1><I>
  There is no 'justified' text option to caption.  But the <A HREF="#pango"
  >pango:</A> text formatter (using an external library), does have that
  feature, and a lot more.
</I></FONT></TD></TR></TABLE></P>


<HR><!-- ---------------------------------------------------------------- -->

<A NAME="attributes"></A>
<H2>Text Attributes</H2>

Orignal the settings that effect text handling included: "<CODE><A
HREF="../option_link.cgi?font" >-font</A></CODE>", "<CODE><A
HREF="../option_link.cgi?fill" >-fill</A></CODE>", "<CODE><A
HREF="../option_link.cgi?pointsize" >-pointsize</A></CODE>", "<CODE><A
HREF="../option_link.cgi?size" >-size</A></CODE>", and "<CODE><A
HREF="../option_link.cgi?gravity" >-gravity</A></CODE>".  We have already
introduced many of these attribute controls above.  But there are other
attribute controls that are not used as often, and originally did not effect
"<CODE>label:</CODE>" or "<CODE>caption:</CODE>" text image generation. </P>

As of IM v6.3.2 you can also use the "<CODE><A
HREF="../option_link.cgi?stroke" >-stroke</A></CODE>", "<CODE><A
HREF="../option_link.cgi?strokewidth" >-strokewidth</A></CODE>", and "<CODE><A
HREF="../option_link.cgi?undercolor" >-undercolor</A></CODE>".
"<CODE>label:</CODE>" or "<CODE>caption:</CODE>".


For example here I make use of a lot of different settings to control the
attributes of the IM text image rendering...

<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 width="100%">
<TR><TD width="100%" ALIGN=justify>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="100%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
   magick -background white -fill dodgerblue  -font Candice \
           -strokewidth 2  -stroke blue   -undercolor lightblue \
           -size 165x70 -gravity center label:Anthony     label_color.gif
</samp></pre></TD></TR></TABLE></TD><TD>
   <A HREF="label_color.gif"
      ><IMG SRC="label_color.gif"
            ALIGN=middle VSPACE=5 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</TD></TR></TABLE></P>

For more details on these settings see <A HREF="#box" >Undercolor Box</A>
below, and <A HREF="../draw/#stroke" >Stroke, StrokeWidth</A> in the drawing
section. </P>

<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH=90% ALIGN=center>
<TR valign="top">
<TD><IMG SRC="../img_www/reminder.gif" WIDTH=20 HEIGHT=16
    ><IMG SRC="../img_www/space.gif"   WIDTH=20 HEIGHT=16></TD>
<TD ALIGN=justify width="100%"><FONT SIZE=-1><I>
  At this time, you can not use tiling images defined using "<CODE><A
  HREF="../option_link.cgi?tile" >-tile</A></CODE>", "<CODE><A
  HREF="../option_link.cgi?fill" >-fill</A></CODE>", "<CODE><A
  HREF="../option_link.cgi?background" >-background</A></CODE>", and "<CODE><A
  HREF="../option_link.cgi?origin" >-origin</A></CODE>", with either
  "<CODE>label:</CODE>" or "<CODE>caption:</CODE>". Only solid colors can be
  used.  Attempting to so will just produce an undefined (black) color.
</I></FONT></TD></TR></TABLE></P>

<!--

<A NAME="fonts"></A>
<H3>Fonts</H3>

Introduction to fonts.

<PRE>FUTURE: Info on use of other font options wanted...
   -family    -weight   -stretch

I do not think these are used very often in IM, particularly with the now near
universal use of imported True Type fonts.
</PRE>

-->

<A NAME="pointsize"></A>
<A NAME="density"></A>
<H3>Pointsize, Density and the Actual Font Size</H3>

Pixels are dots on the display or in an image, and that is what IM works in.
</P>

On the other hand, images are printed at a specific resolution (specified as
'dots per inch' (dpi) or pixels per inch (ppi)).  As such an images resolution
effects how other programs will size an image onto a specific media.  EG: It
effects the images physical size in the real world. </P>

The resolution (density or dpi) of an image is irrelevant to the pixel size of
an image, and the amount of space an image takes in memory or on disk. It is
also, in general, irrelevant to most IM image operations.  As such, to
ImageMagick, the resolution is just a set of numbers stored with the image,
and is normally ignored.  The only time the resolution or density of an image
becomes relevant is for fonts and for converting vector formats like
postscript, pdf, MWF, to the raster image formats IM handles. </P>

The "<CODE><A HREF="../option_link.cgi?density" >-density</A></CODE>" setting
tells IM how many pixels (dots) per inch (ppi) is present on the output
device, which it can then use to adjust the image generation and font sizes to
match.  </P>

For example by default IM works with a "<CODE><A
HREF="../option_link.cgi?density" >-density</A></CODE>" setting of 72 ppi, which
is a typical setting for displaying images on a monitor or webpage.  As a
fonts size is specified in 'points' (using "<CODE><A
HREF="../option_link.cgi?pointsize" >-pointsize</A></CODE>" and by definition 1
point is 1/72 inches, then a 72 point font should produce text sized to be
roughly 1 inch high...

<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 width="100%">
<TR><TD width="100%" ALIGN=justify>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="100%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  magick -pointsize 72 label:Hello  pointsize.gif
</samp></pre></TD></TR></TABLE></TD><TD>
  <A HREF="pointsize.gif"
     ><IMG SRC="pointsize.gif"
           ALIGN=middle VSPACE=0 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</TD></TR></TABLE></P>

<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 width="100%">
<TR VALIGN=bottom><TD width="100%" ALIGN=justify>

However most modern displays have a better resolution than this, typically
somewhere between 90 to 120 pixels per inch (ppi). As such...

<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="100%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  magick -density 90 -pointsize 72 label:Hello  density.gif
</samp></pre></TD></TR></TABLE></TD><TD>
  <A HREF="density.gif"
     ><IMG SRC="density.gif"
           ALIGN=middle VSPACE=0 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</TD></TR></TABLE></P>

Should produce a label that is 1 inch high on a 90 dpi display.  It is on my
display! You can measure the height of these images on your screen, to check
on your displays resolution. </P>

As the number of pixels per inch is larger, the drawn font is also naturally
larger in terms of the number of pixels in the image, and thus producing a
larger image.  Different image programs often have a different default
density, and this may cause fonts to appear differentially when drawn by
different programs, even at the same point size. </P>

Note that "<CODE><A HREF="../option_link.cgi?pointsize"
>-pointsize</A></CODE>" actually means the <B>line separation</B> of a font
(actually its drawing area height), and does NOT refer to the actual height of
the drawn letters!  As such one font can appear larger or smaller than another
font, at the same pointsize and density. Only the line spacing of the fonts
will actually be the same, anything else is dependant on the font and the
font's designer. </P>

As such with a default "<CODE><A HREF="../option_link.cgi?density"
>-density</A></CODE>" of 72dpi (at which 1 point = 1 pixel) a 12 point font
should have 12 pixels separation between the baselines to two lines of text.
</P>

<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH=90% ALIGN=center>
<TR valign="top">
<TD><IMG SRC="../img_www/expert.gif"   WIDTH=23 HEIGHT=26
    ><IMG SRC="../img_www/space.gif"   WIDTH=17 HEIGHT=16></TD>
<TD ALIGN=justify width="100%"><FONT SIZE=-1><I>
  Note that the height of a generated "<CODE><A HREF="#label"
  >label:</A></CODE>" image is based on the images drawing area or bounding
  box, which is often, the fonts line spacing and pointsize.  This is not
  always the case, as such just appending lines of text vertically is actually
  incorrect font handling!

</I></FONT></TD></TR></TABLE></P>

Some fonts may even extend well beyond the normal line separation boundaries,
extending well above or more commonly below the line spacing.  This is
especially true of hand script fonts. </P>

The <B>look</B> of a font is also effected by the fonts "<CODE><A
HREF="../option_link.cgi?pointsize" >-pointsize</A></CODE>" and "<CODE><A
HREF="../option_link.cgi?density" >-density</A></CODE>". </P>

Doubling a fonts pointsize ("<CODE>-pointsize 24</CODE>") will also produce a
font that looks about the same size as one with doubled density or resolution.
However because a font is designed to look a particular way, the thickness of
lines in a font may not change much at a larger point size.  That is the
larger font size is slightly different.</P>

But if you just double the density ("<CODE>-density 144</CODE>"), a 12 point
font will be drawn with its dimensions doubled, should still look like the
original 12 point font, just drawn at a larger scale with better smoothing of
the edges. </P>

However at very low resolutions the physical size limitations of the pixels
may also effect the look of a font.  This means thin lines may be thickened at
lower densities due to the large pixel size the density is defining.  The
relationship between 'density' and 'pointsize' is all a very complex issue,
and one that only a professional font graphic designer can understand fully,
and design their fonts to handle correctly.  </P>

According to <I><A HREF="../forum_link.cgi?u=11042" >Lithium</A></I> from the
<A HREF="../forum_link.cgi?f=1" >IM Forums</A>...

<BLOCKQUOTE><I>
I think it is a feature of TrueType font renderer. TrueType glyph is not only
a set of curves, it may contain multiple levels of detail and instructions
that adjust point coordinates according to output size in pixels, which is
more visible for small size in pixels. Because of that, small text looks
different (and more clear, one can notice) than shrunk large text.
</I></BLOCKQUOTE> </P>

<CODE>FUTURE Example: difference between font at same 'pixel' size, but
different density and point size. </CODE> </P>

Basically increasing one of these factors while decreasing the other by the
same amount may <I>not</I> produce the same result.  Particularly with regard
to line thickness and overall 'style' of the font. You are better off
adjusting the right factor for what you are doing.  Use "<CODE><A
HREF="../option_link.cgi?density" >-density</A></CODE>" when scaling a font
for an output device, or later resizing of the font, and use "<CODE><A
HREF="../option_link.cgi?pointsize" >-pointsize</A></CODE>" for normal font
size changes. </P>

If you would like to know more about fonts, then have a look at the document
<A HREF="http://www.microsoft.com/typography/otspec/TTCH01.htm" >TrueType
Fundamentals (PDF)</A>, which I found very interesting.


<A NAME="bounds" ></A>
<H3>Label Image Bounds</H3>

When using some exotic fonts, the font may use extended characters, and in the
past IM had lots of trouble creating labels for these fonts.  That is the text
overflows the provided canvas. </P>

For example here are two capital letters in a '<CODE>LokiCola</CODE>' font
reminiscent of a certain famous softdrink.

<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 width="100%">
<TR><TD width="100%" ALIGN=justify>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="100%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  magick -background lightblue -fill blue -font LokiCola -pointsize 64 \
          label:HC  label_overflow_font.gif
</samp></pre></TD></TR></TABLE></TD><TD>
  <A HREF="label_overflow_font.gif"
     ><IMG SRC="label_overflow_font.gif"
           ALIGN=middle VSPACE=5 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</TD></TR></TABLE></P>

As you can see IM manages to contain this font in a label without cutting of
the fonts leader or trailing graphics. </P>

<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH=90% ALIGN=center>
<TR valign="top">
<TD><IMG SRC="../img_www/warning.gif"  WIDTH=28 HEIGHT=28
    ><IMG SRC="../img_www/space.gif"   WIDTH=12 HEIGHT=16></TD>
<TD ALIGN=justify width="100%"><FONT SIZE=-1><I>
   Before IM v6.3.2, "<CODE><A HREF="#label" >label:</A></CODE>" would have
   chopped of the 'H' lead-in and parts of the tails from both characters, in
   the above example.
</I></FONT></TD></TR></TABLE></P>

The reason this problem existed is because the fonts 'glyphs' or character
description draw outside the fonts defined boundaries for specific
letters, allowing them to overlap (generally either above or below) the other
characters within the font. </P>

This is a problem with the way the font itself is designed and defined, and
was not the fault of IM, though IM now handles these odd situations in the
best interests of the users. In other situations it could still be a problem,
and one that can not be solved simply due to multi-line text interactions.
For more information see <A HREF="#overflow" >Bounding Box Overflow</A>
examples below, for a more precise description.  </P>


<A NAME="unicode"></A>
<A NAME="chinese"></A>
<A NAME="label_utf8"></A>
<H3>Unicode or UTF8 Format Text</H3>

This method of supplying string arguments to IM is very important as it allows
you to do things which ordinarily could be very difficult to do from the
command line. Specifically handling 'unicode text', or selecting specific
characters using character codes. </P>

Now if you can type unicode characters into commands or scripts you can use
them directly..

<DIV ALIGN=center>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="90%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  magick -background lightblue -fill blue -pointsize 32 \
          label:'                x  '    label_i8n.gif
</samp></pre></TD></TR></TABLE>
  <A HREF="label_i8n.gif"
     ><IMG SRC="label_i8n.gif"
           ALIGN=middle VSPACE=5 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</DIV></P>

However few people have keyboards or editors properly set up to handle <A
HREF="http://www.cl.cam.ac.uk/~mgk25/unicode.html#input" >unicode character
input</A>.  Even if you can not directly type unicode characters, one simple
solution is to just 'copy-n-paste' the desired characters from some existing
UTF-8 text file, or web page. I do! </P>

If the UTF-8 text you wanting to draw has already been generated you can read
it directly from a file using '<CODE>@filename</CODE>'.  For example
here I create a Chinese label from a <A HREF="chinese_words.utf8" >UTF-8
encoded Chinese text file</A> (without a final newline in the file).

<!-- <CODE EXECUTE NOIMAGE OUT=chinese_words.utf8>
  env LC_CTYPE=en_AU.utf8 printf '\u6d4b\u8bd5\u7528\u7684\u6c49\u5b57'
</CODE> -->
<DIV ALIGN=center>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="90%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  magick -background lightblue -fill blue -pointsize 48 \
          -font ZenKaiUni label:@chinese_words.utf8   label_utf8.gif
</samp></pre></TD></TR></TABLE>
  <A HREF="label_utf8.gif"
     ><IMG SRC="label_utf8.gif"
           ALIGN=middle VSPACE=5 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</DIV></P>

<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH=90% ALIGN=center>
<TR valign="top">
<TD><IMG SRC="../img_www/reminder.gif" WIDTH=20 HEIGHT=16
    ><IMG SRC="../img_www/space.gif"   WIDTH=20 HEIGHT=16></TD>
<TD ALIGN=justify width="100%"><FONT SIZE=-1><I>
  The font used in the above example is a special one, with the full set of
  Chinese Glyphs defined, such as the fedora linux fonts '<CODE>SimSun</CODE>'
  (or in the font file "<CODE>gkai00mp.ttf</CODE>"), "<CODE>ZenKaiUni</CODE>"
  (in the file "<CODE>ukai.ttf</CODE>") or "<CODE>ShanHeiSunUni</CODE>" (in
  any of the files "<CODE>uming.ttf</CODE>" or "<CODE>zysong.ttf</CODE>" or
  "<CODE>bsmi00lp.ttf</CODE>"). </P>

  Note that the windows font '<CODE>Mincho</CODE>' (used in a later example)
  also defines many of the Chienese Glyphs but incompletely.  If you use it
  with the above you will get some question marks for undefined glyphs. </P>

  The special script "<CODE><A HREF="../scripts/imagick_type_gen"
  >imagick_type_gen</A></CODE>" was used to find, extract the fonts proper
  name, and add the font into an ImageMagick</A> "<CODE>type.xml</CODE>"
  configuration file. </P>

</I></FONT></TD></TR></TABLE></P>

We can also generate UTF-8 strings from unicode character codes using the
'GNU' "<CODE>printf</CODE>" program (on linux systems) to magick unicode
numbers to the specific UTF-8 encoded string, in this case proper typeset
opening and closing quotes (again no final newline in the UTF-8 input). </P>

Here for example I generate the UTF-8 text using unicode character codes, and
feed it using a command pipeline (read from 'stdin' using "<CODE>@-</CODE>"),
rather than from an actual file.

<DIV ALIGN=center>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="90%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  env LC_CTYPE=en_AU.utf8 \
    printf "\u2018single\u2019 - \u201Cdouble\u201D" | \
      magick -background lightblue -fill blue -pointsize 36 \
              label:@-  label_quotes.gif
</samp></pre></TD></TR></TABLE>
  <A HREF="label_quotes.gif"
     ><IMG SRC="label_quotes.gif"
           ALIGN=middle VSPACE=5 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</DIV></P>

On other systems (like Mac OSX and Windows) you can use the perl
"<CODE>printf</CODE>" to output an UTF-8 encoded character string from unicode
character codes.

<DIV ALIGN=center>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="90%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  perl -e 'binmode(STDOUT, ":utf8"); \
    print "\x{201C}Unicode \x{2018}\x{263A}\x{2019} Please\x{201D}";' |\
      magick -background lightblue -fill blue -pointsize 36 \
              label:@-  label_unifun.gif
</samp></pre></TD></TR></TABLE>
  <A HREF="label_unifun.gif"
     ><IMG SRC="label_unifun.gif"
           ALIGN=middle VSPACE=5 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</DIV></P>

For more information and to look up the unicode character codes for various
languages and symbols see <A HREF="http://www.unicode.org/charts/" >Unicode
Character Code Charts</A>. </P>

Not only can unicode characters contain international characters, but with the
right font you can also use special 'symbol' sets it defines.  The most famous
these is the 'DingBats' symbol font. This font has become so common that it is
now part of the standard Unicode fontset.  </P>

For example here I extract the first 24 characters of the 'DingBats' unicode
symbol area using a special "<CODE><B><A HREF="../scripts/graphics_utf"
>graphics_utf</A></B></CODE>" shell script I wrote to generate a 'block' of
unicode characters as UTF-8 text.

<DIV ALIGN=center>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="90%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  graphics_utf -N 2701 2718 |\
    magick -font Mincho -pointsize 32 label:@-   label_dingbats.gif
</samp></pre></TD></TR></TABLE>
  <A HREF="label_dingbats.gif"
     ><IMG SRC="label_dingbats.gif"
           ALIGN=middle VSPACE=5 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</DIV></P>

The question marks in the above are specific characters which were not defined
by either unicode, or in the windows '<CODE>Mincho</CODE>' font. More
specifically the symbol that was part of the original 'dingbat' font is
present in unicode, but using another unicode character code, than the
expected dingbat code.  See <A
HREF="http://www.unicode.org/charts/PDF/U2700.pdf" >Dingbats Unicode
Specification Chart</A> for more detail, and its referal to the correct
unicode character to use for the 'missing' dingbat characters. </P>

Rather than a question mark, many fonts would just print a box or a blank
character for such undefined characters. If you see too many such characters,
or missing characters in your output, you probably should be using a different
font.  </P>

Other symbol sets also available as part of the enormous unicode character
font include: Tolkan runic symbols, mathematical symbols, roman numerals,
arrows, Braile and technical symbols. It is a large set to explore, and the
"<CODE><B><A HREF="../scripts/graphics_utf" >graphics_utf</A></B></CODE>"
shell script can help you explore it. </P>

Here is another example of unicode characters which the Microsoft 'Mincho'
font can render.  In this case from the "<A
HREF="http://www.unicode.org/charts/PDF/U2600.pdf" >Miscellaneous Symbols</A>"
section...

<DIV ALIGN=center>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="90%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  graphics_utf -N 2620 2630 |\
    magick -font Mincho   -pointsize 40 label:@- label_misc.gif
</samp></pre></TD></TR></TABLE>
  <A HREF="label_misc.gif"
     ><IMG SRC="label_misc.gif"
           ALIGN=middle VSPACE=0 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</DIV></P>

Using unicode within DOS scripts is must harder than under UNIX and LINUX.
Special notes on using unicode from that environment has been provided by
Wolfgang Hugemann, in <A HREF="../windows/#character_encoding" >Windows
Character Encoding</A>. </P>


<A NAME="symbol"></A>
<H3>Symbol Fonts</H3>

More commonly used by people looking for special text images, are special
'symbol fonts'.  These are much smaller than the full large Unicode font, as
they replace only the normal standard ASCII characters (letters and numbers)
with a different set of specific shapes and images, though sometimes (rarely)
they also have more symbols in the Latin meta-characters area. </P>

The 'DingBat' font symbols started out in this way, but as mentioned above
they are now part of the Unicode character set. </P>

For example, one symbol I rather like to use comes from the font "WebDings".
It is a rather nice 'curvy heart' symbol, which is replaces the normal
'<CODE>Y</CODE>' character in that fonts defintion...

<DIV ALIGN=center>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="90%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  magick -size 20x20 -gravity center -font WebDings label:Y label_heart_20.gif
  magick -size 40x40 -gravity center -font WebDings label:Y label_heart_40.gif
  magick -size 60x60 -gravity center -font WebDings label:Y label_heart_60.gif
  magick -size 80x80 -gravity center -font WebDings label:Y label_heart_80.gif
</samp></pre></TD></TR></TABLE></TD><TD>
  <A HREF="label_heart_20.gif"
     ><IMG SRC="label_heart_20.gif"       WIDTH=20  HEIGHT=20
           ALIGN=middle VSPACE=2 HSPACE=20 BORDER=1 ALT="[IM Output]"></A>
  <A HREF="label_heart_40.gif"
     ><IMG SRC="label_heart_40.gif"       WIDTH=40  HEIGHT=40
           ALIGN=middle VSPACE=2 HSPACE=20 BORDER=1 ALT="[IM Output]"></A>
  <A HREF="label_heart_60.gif"
     ><IMG SRC="label_heart_60.gif"       WIDTH=60  HEIGHT=60
           ALIGN=middle VSPACE=2 HSPACE=20 BORDER=1 ALT="[IM Output]"></A>
  <A HREF="label_heart_80.gif"
     ><IMG SRC="label_heart_80.gif"       WIDTH=80  HEIGHT=80
           ALIGN=middle VSPACE=2 HSPACE=20 BORDER=1 ALT="[IM Output]"></A>
</DIV></P>

The important thing to remember is that all truetype fonts are actually
a special type of <A HREF="../formats/#vector" >Vector Image Format</A>.  With
multiple images (one for each character) in the font.  As they are vector
images, it means the font should allow you 'draw' a character, shape or symbol
at any just about any size (scale), using the controls provided by "<CODE><A
HREF="../option_link.cgi?size" >-size</A></CODE>", "<CODE><A
HREF="../option_link.cgi?pointsize" >-pointsize</A></CODE>", and "<CODE><A
HREF="../option_link.cgi?density" >-density</A></CODE>".</P>

As you can see above, the 'curvy heart' can be 'rendered' at pretty much any
size I desire. </P>

Some fonts are very specialized.  For example you can get a font file from <A
HREF="http://www.idautomation.com/fonts/free/" >IDAutomation</A> called
"<CODE>IDAutomationHC39M.ttf</CODE>" that can be used to generate barcodes.
For example...

<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 width="100%">
<TR><TD width="100%" ALIGN=justify>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="100%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  magick -font IDAutomationHC39M -pointsize 16 label:'*314-76*' \
          -bordercolor white -border 5x5  label_barcode.gif
</samp></pre></TD></TR></TABLE></TD><TD>
  <A HREF="label_barcode.gif"
     ><IMG SRC="label_barcode.gif"
           ALIGN=middle VSPACE=0 HSPACE=2 BORDER=1 ALT="[IM Output]"></A>
</TD></TR></TABLE></P>

Here is some other interesting symbols I have found in various symbol fonts
I have collected for one reason or another...

<DIV ALIGN=center>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="90%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  magick -pointsize 48 -font WebDings label:' " _ ~ ) - '  label_webdings.gif
  magick -pointsize 48 -font LittleGidding label:' x o w ' label_ltgidding.gif
  magick -pointsize 48 -font WingDings2      label:'ab'    label_wingdings2.gif
  magick -pointsize 48 -font Zymbols  label:' ? , - I Z '  label_zymbols.gif
  magick -pointsize 48 -font TattoEF  label:' B Y D I H '  label_tatooef.gif
  magick -pointsize 48 -font SoundFX  label:' V 3 t f 9 '  label_soundfx.gif
</samp></pre></TD></TR></TABLE></TD><TD>
  <A HREF="label_webdings.gif"
     ><IMG SRC="label_webdings.gif"
           ALIGN=middle VSPACE=2 HSPACE=15 BORDER=1 ALT="[IM Output]"></A>
  <A HREF="label_ltgidding.gif"
     ><IMG SRC="label_ltgidding.gif"
           ALIGN=middle VSPACE=2 HSPACE=15 BORDER=1 ALT="[IM Output]"></A>
  <A HREF="label_wingdings2.gif"
     ><IMG SRC="label_wingdings2.gif"
           ALIGN=middle VSPACE=2 HSPACE=15 BORDER=1 ALT="[IM Output]"></A>
  <A HREF="label_zymbols.gif"
     ><IMG SRC="label_zymbols.gif"
           ALIGN=middle VSPACE=2 HSPACE=15 BORDER=1 ALT="[IM Output]"></A>
  <A HREF="label_tatooef.gif"
     ><IMG SRC="label_tatooef.gif"
           ALIGN=middle VSPACE=2 HSPACE=15 BORDER=1 ALT="[IM Output]"></A>
  <A HREF="label_soundfx.gif"
     ><IMG SRC="label_soundfx.gif"
           ALIGN=middle VSPACE=2 HSPACE=15 BORDER=1 ALT="[IM Output]"></A>
</DIV></P>

This is only a small sample of what is available.  Huge libraries of just
about every symbol, shape, or image, imaginable is available on the
WWW for you to browse and download. </P>

<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH=90% ALIGN=center>
<TR valign="top">
<TD><IMG SRC="../img_www/reminder.gif" WIDTH=20 HEIGHT=16
    ><IMG SRC="../img_www/space.gif"   WIDTH=20 HEIGHT=16></TD>
<TD ALIGN=justify width="100%"><FONT SIZE=-1><I>
  Remember that each drawn character has two separate parts that can be drawn:
  the 'filled' area (which I showed above), and the 'stroke' or outline, which
  can look very different to the filled area.  Each of these areas can be
  drawn separately, or in different colors, so it may be a good idea to
  examine a promising symbol or shape more closely, in a number of ways. You
  may get a very surprising result.  See <A HREF="../fonts/#stroke" >Compound
  Fonts, Stroke</A> for some examples of doing this.

</I></FONT></TD></TR></TABLE></P>


<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH=90% ALIGN=center>
<TR valign="top">
<TD><IMG SRC="../img_www/warning.gif"  WIDTH=28 HEIGHT=28
    ><IMG SRC="../img_www/space.gif"   WIDTH=12 HEIGHT=16></TD>
<TD ALIGN=justify width="100%"><FONT SIZE=-1><I>
  Many creators of symbol fonts generate the shapes using a simple scanner and
  bitmap to vector converter, without any proper design or cleaning of the
  image or shape.  Caution is recommended when looking at such 'scanned'
  fonts. </P>

  The last font shown above is one such example of a 'scanned' font, giving
  it a poor looking 'dotty' quality, when compared to the other more properly
  designed fonts.

</I></FONT></TD></TR></TABLE></P>


<A NAME="kerning"></A>
<H3>Inter-character Kerning</H3>

As of IM v6.4.7-8 you can use "<CODE><A HREF="../option_link.cgi?kerning"
>-kerning</A></CODE>" to insert extra inter-character space between each
letter in text strings. For example

<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 width="100%">
<TR><TD width="100%" ALIGN=justify>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="100%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  magick -pointsize 12               label:Anthony   label_kerning_0.gif
  magick -pointsize 12 -kerning 1    label:Anthony   label_kerning_1.gif
  magick -pointsize 12 -kerning 2.5  label:Anthony   label_kerning_2.gif
  magick -pointsize 12 -kerning 5    label:Anthony   label_kerning_5.gif
  magick -pointsize 12 -kerning -1   label:Anthony   label_kerning-1.gif
</samp></pre></TD></TR></TABLE></TD><TD>
  <A HREF="label_kerning_0.gif"
     ><IMG SRC="label_kerning_0.gif"
           ALIGN=middle VSPACE=1 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
  <A HREF="label_kerning_1.gif"
     ><IMG SRC="label_kerning_1.gif"
           ALIGN=middle VSPACE=1 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
  <A HREF="label_kerning_2.gif"
     ><IMG SRC="label_kerning_2.gif"
           ALIGN=middle VSPACE=1 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
  <A HREF="label_kerning_5.gif"
     ><IMG SRC="label_kerning_5.gif"
           ALIGN=middle VSPACE=1 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
  <A HREF="label_kerning-1.gif"
     ><IMG SRC="label_kerning-1.gif"
           ALIGN=middle VSPACE=1 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</TD></TR></TABLE></P>

Note that the actual kerning value can be a floating point value, or even a
negative value. </P>

For another example of using a negative "<CODE><A
HREF="../option_link.cgi?kerning" >-kerning</A></CODE>" value see the <A
HREF="../fonts/#joined" >Joined Compound Font</A> example. </P>


<A NAME="interword-spacing"></A>
<H3>Inter-Word Spacing</H3>

Also as of IM v 6.4.8-0 the option "<CODE><A
HREF="../option_link.cgi?interword-spacing" >-interword-spacing</A></CODE>"
can be used to modify the size of a space character used between words.  For
example

<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 width="100%">
<TR><TD width="100%" ALIGN=justify>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="100%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  magick                       label:'I Love IM!'  label_wspace_off.gif
  magick -interword-spacing 1   label:'I Love IM!'  label_wspace_1.gif
  magick -interword-spacing 10  label:'I Love IM!'  label_wspace_10.gif
  magick -interword-spacing 25  label:'I Love IM!'  label_wspace_25.gif
</samp></pre></TD></TR></TABLE></TD><TD>
  <A HREF="label_wspace_off.gif"
     ><IMG SRC="label_wspace_off.gif"
           ALIGN=middle VSPACE=1 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
  <A HREF="label_wspace_1.gif"
     ><IMG SRC="label_wspace_1.gif"
           ALIGN=middle VSPACE=1 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
  <A HREF="label_wspace_10.gif"
     ><IMG SRC="label_wspace_10.gif"
           ALIGN=middle VSPACE=1 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
  <A HREF="label_wspace_25.gif"
     ><IMG SRC="label_wspace_25.gif"
           ALIGN=middle VSPACE=1 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</TD></TR></TABLE></P>

Note how you can not only increase the size of a space character between the
words but also decrease the default size. </P>

Note however that spaces will cause the words to be re-aligned to pixel
boundaries (unlike <A HREF="#kerning" >Inter-character Kerning</A> above) so
the output of a label with spaces set to zero will still be different to a
label that does not contain any spaces at all. </P>

Both the <A HREF="#kerning" >Inter-character Kerning</A> and the <A
HREF="#interword-spacing" >Inter-word Spacing</A> will also effect the results
of IM's ability to automatically fit a text string to a specific sized image.

<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 width="100%">
<TR><TD width="100%" ALIGN=justify>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="100%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  magick -size 150x                       label:'I Love IM!' label_wsize_of.gif
  magick -size 150x -interword-spacing 25 label:'I Love IM!' label_wsize_25.gif
  magick -size 150x -interword-spacing 50 label:'I Love IM!' label_wsize_50.gif
</samp></pre></TD></TR></TABLE></TD><TD>
  <A HREF="label_wsize_of.gif"
     ><IMG SRC="label_wsize_of.gif"
           ALIGN=middle VSPACE=1 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
  <A HREF="label_wsize_25.gif"
     ><IMG SRC="label_wsize_25.gif"
           ALIGN=middle VSPACE=1 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
  <A HREF="label_wsize_50.gif"
     ><IMG SRC="label_wsize_50.gif"
           ALIGN=middle VSPACE=1 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</TD></TR></TABLE></P>

What is happening is that by setting the "<CODE><A
HREF="../option_link.cgi?interword-spacing" >-interword-spacing</A></CODE>"
the 'space' character size no longer changes with the rest of the text size.
Thus as IM trys to work out the best "<CODE><A
HREF="../option_link.cgi?pointsize" >-pointsize</A></CODE>" the amount of
space between each word is fixed, and thus play no part in the fitting of the
text into the given fixed width.  As a consequence the larger the "<CODE><A
HREF="../option_link.cgi?interword-spacing" >-interword-spacing</A></CODE>"
the smaller sized font that is needed to actually to fit the line of text into
the same specified image width. </P>

A negative value can be used, and can in fact to make words overlap, or
produce unusual effects using specific characters and fonts.  But make it too
negative and undefined behaviours can creep in. Caution is advised if you try
this. </P>

While the above is not an example of text justification (though it looks like
it), you can use these options as a starting point to providing proper text
justification. </P>

If you really need that level of text formating and justification, then you
may be better off looking at other methods of generating pre-formated text or
<A HREF="#postscript" >Postscript</A>, such as the command line basied "TeX"
or "LaTeX" software.  Better still you could use <A HREF="../draw/#svg"
>SVG</A> (rsvg library version), or <A HREF="#pango" >Pango Markup
Language</A> (see below), to generate justified text. </P>


<A NAME="interline-spacing"></A>
<H3>Inter-Line Spacing</H3>

As of IM v6.5.5-8 an another option was added "<CODE><A
HREF="../option_link.cgi?interword-spacing" >-interline-spacing</A></CODE>".
This was heavilly requested by users in light of the previous settings, and in
many ways is much more useful. </P>

Basically it will add or subtract this many pixels between the individual
lines of text.  That is you can use it to expand or squash together the
individual lines of text. </P>

For example....

<DIV ALIGN=center>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="90%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  magick                        label:'First\nSecond'  label_lspace_off.gif
  magick -interline-spacing  5   label:'First\nSecond'  label_lspace_5.gif
  magick -interline-spacing 10   label:'First\nSecond'  label_lspace_10.gif
  magick -interline-spacing 20   label:'First\nSecond'  label_lspace_20.gif
  magick -interline-spacing -5   label:'First\nSecond'  label_lspace-5.gif
  magick -interline-spacing -10  label:'First\nSecond'  label_lspace-10.gif
</samp></pre></TD></TR></TABLE>
  <A HREF="label_lspace_off.gif"
     ><IMG SRC="label_lspace_off.gif"
           ALIGN=middle VSPACE=1 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
  <A HREF="label_lspace_5.gif"
     ><IMG SRC="label_lspace_5.gif"
           ALIGN=middle VSPACE=1 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
  <A HREF="label_lspace_10.gif"
     ><IMG SRC="label_lspace_10.gif"
           ALIGN=middle VSPACE=1 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
  <A HREF="label_lspace_20.gif"
     ><IMG SRC="label_lspace_20.gif"
           ALIGN=middle VSPACE=1 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
  <A HREF="label_lspace-5.gif"
     ><IMG SRC="label_lspace-5.gif"
           ALIGN=middle VSPACE=1 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
  <A HREF="label_lspace-10.gif"
     ><IMG SRC="label_lspace-10.gif"
           ALIGN=middle VSPACE=1 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</DIV></P>

To make best use of this setting you need to be able to calculate the normal
line spacing for a specific font. This is the actual definition of "<CODE><A
HREF="../option_link.cgi?pointsize" >-pointsize</A></CODE>", which with the
current resolution or "<CODE><A HREF="../option_link.cgi?density"
>-density</A></CODE>" setting defines the line spaceing of  a font.  It does
not actually define the fonts actual height or line thickness, though it
effects these aspects of a particular font. </P>

So taking a "<CODE><A HREF="../option_link.cgi?density" >-density</A></CODE>"
of '<CODE>72</CODE>' dots per inch, and knowning that by defintion there are
72 'points' per inch. you can calculate that a 12 point font will have a line
spacing of 12 pixels. </P>

With that information you can 'double-space' your 12 point text lines by using
a setting of "<CODE>-interline-spacing 12</CODE>". This will add 12 extra
pixels between lines.

<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 width="100%">
<TR><TD width="100%" ALIGN=justify>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="100%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  magick -density 72 -pointsize 12 -interline-spacing 12  -font Arial \
          label:'First\nSecond\nThird'  label_lspace_double.gif
</samp></pre></TD></TR></TABLE></TD><TD>
  <A HREF="label_lspace_double.gif"
     ><IMG SRC="label_lspace_double.gif"
           ALIGN=middle VSPACE=1 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</TD></TR></TABLE></P>

Of course as previously seen for interword size, adding a constant number of
pixels between text elements will tend to make the text smaller when
automatic pointsize handling is used.  That is a final image "<CODE><A
HREF="../option_link.cgi?size" >-size</A></CODE>" is provided without
a "<CODE><A HREF="../option_link.cgi?pointsize" >-pointsize</A></CODE>"
setting.

<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 width="100%">
<TR><TD width="100%" ALIGN=justify>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="100%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  magick -size x70  -interline-spacing 18  -font Arial \
          label:'First\nSecond\nThird'  label_lspace_size.gif
</samp></pre></TD></TR></TABLE></TD><TD>
  <A HREF="label_lspace_size.gif"
     ><IMG SRC="label_lspace_size.gif"
           ALIGN=middle VSPACE=1 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</TD></TR></TABLE></P>


Using a negtive interline spacing can also be used as a rough and ready method
of vertically 'bolding' a line, simply by repeating that line, and subtracting
1 more pixel than the baseline separation.

<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 width="100%">
<TR><TD width="100%" ALIGN=justify>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="100%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  magick -density 72 -pointsize 12 -interline-spacing -13 -font Arial \
          label:'Bolded Word\nBolded'  label_lspace_vbold.gif
</samp></pre></TD></TR></TABLE></TD><TD>
  <A HREF="label_lspace_vbold.gif"
     ><IMG SRC="label_lspace_vbold.gif"
           ALIGN=middle VSPACE=0 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</TD></TR></TABLE></P>

Of course this will not work if you really want two lines, and not just
bolding text.  It also works better with a fixed width font. </P>

<HR><!-- ---------------------------------------------------------------- -->

<A NAME="label_escapes"></A>
<A NAME="escapes_chars"></A>
<A NAME="escape_chars"></A>
<H2>Special Escape Characters in Text Arguments</H2>

We have already introduced the special escape characters used in various text
arguments, above.  Specifically you can escape special characters like
newlines using backslash '<CODE>\</CODE>', or you can insert extra information
into the string using percent '<CODE>%</CODE>' escapes, as defined on the <A
HREF="https://imagemagick.org/script/escape.php" >Image Properties</A>
page. </P>

Also there is a special '<CODE>@</CODE>' escape that if used at the start
of a line will use the rest of the text argument as a filename to read the
data from the file specified (or STDIN in '<CODE>-</CODE>' is used). </P>

<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH=90% ALIGN=center>
<TR valign="top">
<TD><IMG SRC="../img_www/warning.gif"  WIDTH=28 HEIGHT=28
    ><IMG SRC="../img_www/space.gif"   WIDTH=12 HEIGHT=16></TD>
<TD ALIGN=justify width="100%"><FONT SIZE=-1><I>
  Some system (like ubuntu) disable the use of the '@{file}' escape using
  security policy.  Type <CODE>magick -list policy</CODE> to see what
  policies and where they are set from are present on your system.
</I></FONT></TD></TR></TABLE></P>

Not only do these escape characters effect "<CODE><A
HREF="../option_link.cgi?format" >-format</A></CODE>", for use by the
"<code>magick identify</code>" (as well as "<CODE><A
HREF="../option_link.cgi?identify" >-identify</A></CODE>" and the "<CODE><A
HREF="../files/#info" >info:</A></CODE>"), but they also effect "<CODE><A
HREF="#label" >label:</A></CODE>", and "<CODE><A HREF="#caption"
>caption:</A></CODE>" text to image generators, and control the image
meta-data setting options "<CODE><A HREF="../option_link.cgi?label"
>-label</A></CODE>", "<CODE><A HREF="../option_link.cgi?comment"
>-comment</A></CODE>", "<CODE><A HREF="../option_link.cgi?caption"
>-caption</A></CODE>".   And finally they are also used by "<CODE><A
HREF="../option_link.cgi?annotate" >-annotate</A></CODE>".  </P>

<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH=90% ALIGN=center>
<TR valign="top">
<TD><IMG SRC="../img_www/reminder.gif" WIDTH=20 HEIGHT=16
    ><IMG SRC="../img_www/space.gif"   WIDTH=20 HEIGHT=16></TD>
<TD ALIGN=justify width="100%"><FONT SIZE=-1><I>
  While backslash '<CODE>\</CODE>' is used by the "<CODE><A
  HREF="../option_link.cgi?draw" >-draw</A></CODE>" '<CODE>text</CODE>'
  method, the percent '<CODE>%</CODE>' escapes are <B>not</B> as it
  interferes with ImageMagick's SVG image handling.  This was one of the
  reasons the "<CODE><A HREF="../option_link.cgi?annotate"
  >-annotate</A></CODE>" operator was created for IM version 6. </P>

</I></FONT></TD></TR></TABLE></P>

The other important point about escape characters is that while they are used
for command line text arguments.  At no time do they apply within the data
being read from a text file (usually read in using the '<CODE>@</CODE>'
escape). </P>

This means you do not need to worry about escaping 'escapes' for text file
data, but it also means you have to process file data yourself outside of IM
if you need to insert information into the text. </P>

<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH=90% ALIGN=center>
<TR valign="top">
<TD><IMG SRC="../img_www/warning.gif"  WIDTH=28 HEIGHT=28
    ><IMG SRC="../img_www/space.gif"   WIDTH=12 HEIGHT=16></TD>
<TD ALIGN=justify width="100%"><FONT SIZE=-1><I>
  Protecting input text file from escape handling was finalised in
  IM version 6.3.3.
</I></FONT></TD></TR></TABLE></P>


For example here I set and the report an images 'label' and 'comment' meta-data
using the two methods to set that information from a source text file.
The "<CODE>info.txt</CODE>" file contains the string
<!-- <CODE EXECUTE>
  printf '@ \\n %%wx%%h' > info.txt
</CODE>-->
  <A HREF="info.txt"
     ><IMG SRC="info.txt.gif"
           ALIGN=absmiddle VSPACE=0 HSPACE=0 BORDER=0 ALT="[IM Text]"></A>,
(no final newline).

<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 width="100%">
<TR><TD width="100%" ALIGN=justify>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="100%" bgcolor="#f8f8f8">
<TR><TD><PRE><CODE EXECUTE OUT=file.txt>
  magick -label   @info.txt  rose:     -format '%l label'   info:
  magick -comment @info.txt  rose:     -format '%c set "'   info:
  magick rose: -set label   @info.txt  -format '%l caption' info:
  magick rose: -set comment @info.txt  -format '%c set "'   info:
</samp></pre></TD></TR></TABLE></TD><TD>
<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=5 bgcolor="#f8f8f8">
<TR><TD>
  <A HREF="file.txt"
     ><IMG SRC="file.txt.gif"
           ALIGN=middle VSPACE=0 HSPACE=0 BORDER=0 ALT="[IM Text]"></A>
</TD></TR></TABLE>
</TD></TR></TABLE></P>

Notice that IM did <I>not</I> expand any of the escape character sequences
that it read in using the '<CODE>@</CODE>' file read escape.   This is
important as it means that any time IM reads text from a file, it will
<I>never</I> handle any special characters that was present in that file. </P>

<DIV ALIGN=center><B>
   IM reads text files, as literal text, without any escapes
</B></DIV></P>

Unfortunately this also includes any final newline that may be present in the
file (or stream) that is being read!  This can result in an extra 'blank' line
in the resulting image, when the input text has a newline on the end (a very
common practice).  For example...

<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 width="100%">
<TR><TD width="100%" ALIGN=justify>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="100%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  echo "Anthony" | magick label:@-  label_stdin.gif
</samp></pre></TD></TR></TABLE></TD><TD>
  <A HREF="label_stdin.gif"
     ><IMG SRC="label_stdin.gif"
           ALIGN=middle VSPACE=5 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</TD></TR></TABLE></P>

As you can see the label not only contained the input string but also an extra
blank line due to the newline character that the "<CODE>echo</CODE>" command
added on the end. </P>

If you don't want that final newline, you will need to remove it yourself.
This however could be a tricky matter, depending on where and how the text is
sourced or created, and what API, you are running IM from. </P>

The best way is to try not to generate that final newline to begin with.  For
example using a '<CODE>-n</CODE>' flag to "<CODE>echo</CODE>".

<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 width="100%">
<TR><TD width="100%" ALIGN=justify>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="100%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  echo -n "Anthony" | magick label:@-  label_stdin_2.gif
</samp></pre></TD></TR></TABLE></TD><TD>
  <A HREF="label_stdin_2.gif"
     ><IMG SRC="label_stdin_2.gif"
           ALIGN=middle VSPACE=5 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</TD></TR></TABLE>

Or using something that does not add extra newlines unless you specifically
request it.

<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 width="100%">
<TR><TD width="100%" ALIGN=justify>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="100%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  printf "Anthony" | magick label:@-  label_stdin_3.gif
</samp></pre></TD></TR></TABLE></TD><TD>
  <A HREF="label_stdin_3.gif"
     ><IMG SRC="label_stdin_3.gif"
           ALIGN=middle VSPACE=5 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</TD></TR></TABLE>

Or you can 'junk' that final newline using a tricky little perl one-liner...

<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 width="100%">
<TR><TD width="100%" ALIGN=justify>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="100%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  echo "Anthony" | perl -0777 -pe 's/\n$//' |\
     magick label:@-  label_stdin_4.gif
</samp></pre></TD></TR></TABLE></TD><TD>
  <A HREF="label_stdin_4.gif"
     ><IMG SRC="label_stdin_4.gif"
           ALIGN=middle VSPACE=5 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</TD></TR></TABLE></P>

In other API's you can look for that final newline before feeding the text to
an IM command via a 'piped open'. </P>


<A NAME="user_escapes"></A>
<H3>User defined option escapes</H3>

A major problem is trying to use escaped information from one image, in some
other image, such as when generating a separate "<CODE><A HREF="#label"
>label:</A></CODE>", or "<CODE><A HREF="#caption" >caption:</A></CODE>" image.
</P>

This is a very difficult problem, and the current solution, (for a single
image) is to create a special 'user option', that is attached to an image
being processed.  This 'setting' can then be looked up by the "<CODE><A
HREF="#label" >label:</A></CODE>", "<CODE><A HREF="#caption"
>caption:</A></CODE>", or "<CODE><A HREF="../option_link.cgi?annotate"
>-annotate</A></CODE>", as a percent escape sequence, when needed. </P>

For example here I create a completely new label image using information from
the built-in rose image. That information source image is then deleted, though
I could just as easily append the new label to the original image.

<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 width="100%">
<TR><TD width="100%" ALIGN=justify>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="100%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  magick rose: \
          -set option:roseinfo 'rose image\nsize = %w x %h\nwith %k colors' \
          label:'%[roseinfo]'  -delete 0   label_escape.gif
</samp></pre></TD></TR></TABLE></TD><TD>
  <A HREF="label_escape.gif"
     ><IMG SRC="label_escape.gif"
           ALIGN=middle VSPACE=0 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</TD></TR></TABLE></P>

Yes the above is tricky, but that due to some internal IM core library
limitations that are involved.  See <A HREF="../transform/#fx_other"
>Accessing Data from other images</A> for more details. </P>


<A NAME="escaping_escapes"></A>
<H3>Escaping Escapes</H3>

If you must feed a string as an argument to IM (especially as an API call), but
don't want IM to expand escapes, you can simply 'escape' all three escapes
using an extra backslash '<CODE>\</CODE>'.

Note the '<CODE>@</CODE>' only needs to be 'escaped' if it is the first
character, and for backward compatibility, percent escapes can also be escaped
by doubling it.  That is '<CODE>%%</CODE>' will produce a single percent.

For example...
<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 width="100%">
<TR><TD width="100%" ALIGN=justify>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="100%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  magick -background lightblue -fill blue -font Candice -pointsize 48 \
          label:'\@ \\n \% 5%% '    label_escapes.gif
</samp></pre></TD></TR></TABLE></TD><TD>
  <A HREF="label_escapes.gif"
      ><IMG SRC="label_escapes.gif"
            ALIGN=middle VSPACE=5 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</TD></TR></TABLE></P>

<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH=90% ALIGN=center>
<TR valign="top">
<TD><IMG SRC="../img_www/warning.gif"  WIDTH=28 HEIGHT=28
    ><IMG SRC="../img_www/space.gif"   WIDTH=12 HEIGHT=16></TD>
<TD ALIGN=justify width="100%"><FONT SIZE=-1><I>
  Before IM version 6.3.2, you could not use a backslash to escape an
  initial '<CODE>@</CODE>' to turn off the 'read from a file' function.  In
  that case the only way to escape an initial '<CODE>@</CODE>' was to read
  it from a file.   This was not very practical in API's.
</I></FONT></TD></TR></TABLE></P>

Here is a similar 'escape the escapes' example for "<CODE><A
HREF="../option_link.cgi?annotate" >-annotate</A></CODE>"...

<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 width="100%">
<TR><TD width="100%" ALIGN=justify>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="100%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  magick rose: -fill white -stroke black  -font Candice  -pointsize 20 \
          -gravity center   -annotate 0 '\@ \\n 5%%'  annotate_escapes.gif
</samp></pre></TD></TR></TABLE></TD><TD>
  <A HREF="annotate_escapes.gif"
     ><IMG SRC="annotate_escapes.gif"
           ALIGN=middle VSPACE=5 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</TD></TR></TABLE></P>

Of course as previously shown, reading the text from a file (using the
'<CODE>@</CODE>' escape), will always be treated as literal, without any
special meaning.  This avoids the need for any pre-processing of the text,
just watch out for any final newlines.

<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 width="100%">
<TR><TD width="100%" ALIGN=justify>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="100%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  echo -n '@ \n 5%' |\
    magick rose: -fill white -stroke black  -font Candice  -pointsize 20 \
            -gravity center    -annotate 0 '@-'   annotate_escapes_file.gif
</samp></pre></TD></TR></TABLE></TD><TD>
  <A HREF="annotate_escapes_file.gif"
     ><IMG SRC="annotate_escapes_file.gif"
           ALIGN=middle VSPACE=5 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</TD></TR></TABLE></P>

In other words when reading from a file you don't have to worry about escaping
things, but can just write exactly the text you want IM to use. </P>


<H3>Escapes on Older versions of IM</H3>

The above definitions were only finalised in IM version 6.3.3.  Before this
escapes were sometimes handled in some options, and sometimes not, according
to any requests, problems, and complaints, sent by IM users. </P>

This was especially the case with regards to the percent escapes with
"<CODE><A HREF="#label" >label:</A></CODE>" and "<CODE><A HREF="#caption"
>caption:</A></CODE>", which was for a period deemed as 'non-sensible'. </P>

For example whether you see a '<CODE>%c</CODE>' in the following label image
is very version dependant (at least before IM v6.3.3).
<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 width="100%">
<TR><TD width="100%" ALIGN=justify>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="100%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  magick -background lightblue -fill blue -font Candice -pointsize 48 \
          label:'ab%cde'    label_percent.gif
</samp></pre></TD></TR></TABLE></TD><TD>
  <A HREF="label_percent.gif"
     ><IMG SRC="label_percent.gif"
           ALIGN=middle VSPACE=5 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</TD></TR></TABLE></P>

If you see a '<CODE>abde</CODE>' (percent escape applied) or
'<CODE>ab%cde</CODE>' (percent not applied) depends on exactly what version
of IM you are using. </P>

<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH=90% ALIGN=center>
<TR valign="top">
<TD><IMG SRC="../img_www/warning.gif"  WIDTH=28 HEIGHT=28
    ><IMG SRC="../img_www/space.gif"   WIDTH=12 HEIGHT=16></TD>
<TD ALIGN=justify width="100%"><FONT SIZE=-1><I>
  IM v6.2.4, percent escapes were removed from "<CODE><A
  HREF="#label" >label:</A></CODE>" and "<CODE><A HREF="#caption"
  >caption:</A></CODE>" as being non-sensible. </P>

  However they returned in IM v6.3.2, as a new '<CODE>%[fx:...]</CODE>
  construct, which can reference any image, made percent escapes in text to
  image generators useful again.  See <A HREF="../transform/#fx_escapes" >FX
  Expression Escapes</A>.

</I></FONT></TD></TR></TABLE></P>

This 'what is escaped' was also a problem with regard to the handling of
escapes from files.  Before IM v6.3.3, the following would have produced two
lines, rather than a single line.

<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 width="100%">
<TR><TD width="100%" ALIGN=justify>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="100%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  echo -n ' Love \n/ Hate ' |\
    magick -background lightblue -fill blue -font Ravie -pointsize 18 \
            label:@-    label_escapes_file.gif
</samp></pre></TD></TR></TABLE></TD><TD>
  <A HREF="label_escapes_file.gif"
     ><IMG SRC="label_escapes_file.gif"
           ALIGN=middle VSPACE=5 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</TD></TR></TABLE></P>

As the results of escape handling vary greatly from version to version, in
IM's older than v6.3.3, I recommend that scripts test its escape handling,
adjust themselves if it is important to the programs correct working. </P>

<I>If anyone like to create an automatic test for IM scripts, please
contribute. Or if you find such as test, please let me know.</I> </P>


<HR><!-- ------------------------------------------------------------------ -->

<A NAME="pango"></A>
<H2>Pango - Basic Formatted Text </H2>

The "<CODE>pango:</CODE>" text coder (fully working as of IM v6.7.6-3) works
in much the same way as the <A HREF="#label" >Label</A> and <A HREF="#caption"
>Caption</A> coders.  It provides a limited text formatting language on
systems in which "Pango" is installed. On Linux and MacOSX systems pango is
standard, on Windows it is optional. </P>

Here is a simple example without using any special pango formatting...

<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 width="100%">
<TR><TD width="100%" ALIGN=justify>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="100%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  magick -background lightblue pango:"Anthony Thyssen" pango.gif
</samp></pre></TD></TR></TABLE></TD><TD>
  <A HREF="pango.gif"
     ><IMG SRC="pango.gif"
           ALIGN=middle VSPACE=0 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</TD></TR></TABLE></P>

However you should note that some of the previous <A HREF="#attributes" >Text
Attributes</A> will not work with pango, basically due to its text formatting
requirements.  For example while you can set a "<CODE><A
HREF="../option_link.cgi?background" >-background</A></CODE>" color, you can
not set the default fill, or undercolor, nor the specific font to use. This is
because these attributes are selectable via the Pango Markup Language instead
(see below).</P>

It is recommended that you use "<CODE><A HREF="../option_link.cgi?size"
>-size</A></CODE>" to define width and height limits to the output image, to
which pango will automatically word wrap (or character wrap, for chinese) the
input text.

<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 width="100%">
<TR><TD width="100%" ALIGN=justify>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="100%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  magick -background lightblue -size 150 \
          pango:"Anthony Thyssen is the main author of IM Examples" \
          pango_size.gif
</samp></pre></TD></TR></TABLE></TD><TD>
  <A HREF="pango_size.gif"
     ><IMG SRC="pango_size.gif"
           ALIGN=middle VSPACE=0 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</TD></TR></TABLE></P>

And you can even have Pango 'justify' the text properly using the <A
HREF="../basics/#define" >Define</A>, "<CODE>pango:justify</CODE>"...

<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 width="100%">
<TR><TD width="100%" ALIGN=justify>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="100%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  magick -background lightblue -size 150  -define pango:justify=true \
          pango:"Contributions to IM Examples are welcome via the IM Forum." \
          pango_justify.gif
</samp></pre></TD></TR></TABLE></TD><TD>
  <A HREF="pango_justify.gif"
     ><IMG SRC="pango_justify.gif"
           ALIGN=middle VSPACE=0 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</TD></TR></TABLE></P>

Note however that while text can be justified, spaces and newlines are still
taken into account by the text formatted. </P>

Also pango understands the use of TAB's (unlike label and caption).

<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 width="100%">
<TR><TD width="100%" ALIGN=justify>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="100%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  printf "col1\tcol2\nabc\txyz\n123\t789" |\
     magick -background lightblue  pango:@-  pango_tabs.gif
</samp></pre></TD></TR></TABLE></TD><TD>
  <A HREF="pango_tabs.gif"
     ><IMG SRC="pango_tabs.gif"
           ALIGN=middle VSPACE=0 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</TD></TR></TABLE></P>

<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH=90% ALIGN=center>
<TR valign="top">
<TD><IMG SRC="../img_www/reminder.gif" WIDTH=20 HEIGHT=16
    ><IMG SRC="../img_www/space.gif"   WIDTH=20 HEIGHT=16></TD>
<TD ALIGN=justify width="100%"><FONT SIZE=-1><I>
  Note that while the "<CODE>printf</CODE>" command above can generate tab
  characters, using the '<CODE>\t</CODE>' escape,  IM does not understand the
  use of such an escape.  It does however understand the '<CODE>\n</CODE>'
  escape sequence in strings.
</I></FONT></TD></TR></TABLE></P>

However generating columns using TAB's does not work very well as you can't
easily define the 'tab-stops' outside the API. As such using TAB's in this
way is <I>not recommended</I>, except as line and paragraph indentation . </P>


<A NAME="pango_markup"></A>
<H3>Pango Markup language</H3>

The real power of pango however is in the "Pango Markup" language, which is
enabled by default.  You can turn off pango markup using "<CODE>-define
pango:markup=false</CODE>",  but then you may as well be using <A
HREF="#caption" >Caption</A> instead. </P>

The "Pango Markup" is much like HTML, in that you use a set of
"<CODE>&lt;...&gt;</CODE>" markup tags hidden in the text, and which is used
to control how the text is to be formatted.  </P>

Here are some guides on the Markup Language (without the API junk)

<UL>
<LI><A HREF="https://developer.gnome.org/pygtk/stable/pango-markup-language.html"
    >The Pango Markup Language</A></LI>
<LI><A HREF="https://developer.gnome.org/pango/stable/PangoMarkupFormat.html"
    >Pango Text Attribute Markup Language</A></LI> (from Gnome)
<LI><A HREF="https://www.gtk.org/api/2.6/pango/PangoMarkupFormat.html"
    >Pango Text Attribute Markup Language</A></LI> (From GTK)
<LI><A HREF="http://www.pango.org/ScriptGallery"
    >Pango Script Gallery</A> (examples) </P>
</UL></P>

For example..
<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 width="100%">
<TR><TD width="100%" ALIGN=justify>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="100%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  magick -background lightblue -gravity center -size 180x \
          pango:"The &lt;b&gt;bold&lt;/b&gt; and &lt;i&gt;beautiful&lt;/i&gt;" \
          pango_formatting.gif
</samp></pre></TD></TR></TABLE></TD><TD>
  <A HREF="pango_formatting.gif"
     ><IMG SRC="pango_formatting.gif"
           ALIGN=middle VSPACE=0 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</TD></TR></TABLE></P>

The "<CODE>&lt;span ... &gt;</CODE>" tag is the main tag to use in pango mark
up.  It allows you to control the exact size, color, and position of the
contained text. For example..

<DIV ALIGN=center>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="90%" bgcolor="#f8f8f8">
<TR><TD><PRE><CODE EXECUTE SCRIPT>
  magick -background lightblue \
       pango:'  Some  &lt;span size="49152" rise="-20480"
                foreground="red" background="blue"
                 &gt; Big Red on Blue &lt;/span&gt;  Text  ' \
       pango_span.gif
</samp></pre></TD></TR></TABLE>
  <A HREF="pango_span.gif"
     ><IMG SRC="pango_span.gif"
           ALIGN=middle VSPACE=0 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</DIV></P>

Note that most numerical values are multiplied by a factor of 1024 as such the
the value of "<CODE>size="49152"</CODE>" in the above example, means a text
pointsize of 48 points. While the negative rise ("<CODE>rise="-20480"</CODE>)
means to lower the text position by 20 points (or pixels at 72dpi). </P>

But instead of specifing a pointsize for the text I can also use a special
size label such as "<CODE>size="x-large"</CODE>".  See the source code of the
next example. </P>

Watch out for the quotes within quotes in the above. The quotes within the
tags are required.  However newlines and extra space within tags will take no
part in the formatting of the text.  As such hiding extra newlines in a markup
tags, or in a markup comment "<CODE>&lt;!-- ... --&gt;</CODE>",
can be very useful.  Again see the source text of the next example. </P>

As a final example of the power of pango formatting here I use it to format
a pre-prepared file "<CODE><A HREF="../images/pango_test.txt"
>pango_test.txt</A></CODE>". This contains most of the common pango markup
tags you are likely to use.  Compare this markup file to the resulting image
below.

<DIV ALIGN=center>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="90%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  magick -gravity center pango:@pango_test.txt  pango_test.png
</samp></pre></TD></TR></TABLE>
  <A HREF="pango_test.png"
     ><IMG SRC="pango_test.png"
           ALIGN=middle VSPACE=5 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</DIV></P>

<A NAME="pango_notes"></A>
<H3>Pango Notes and Problems</H3>

<DL>
<DT><B>Gravity</B>
<DD>I have not been able to get pango to selectively center just a single
    line of text. You can only center everything, or nothing via the
    "<CODE><A HREF="../option_link.cgi?gravity" >-gravity</A></CODE>"
    setting. </P>

    The reason for this appears to be because pango is designed to generate
    separate text labels for applications.  That is titles are usually
    generated separately to the main body of displayed text. </P>

    Pango is is not meant to be a whole scale text page formatting engine.
    </P>

<DT><B>Fonts</B>
<DD>Pango can change fonts in the middle of rendering.  It already does so
    easily for bold and italic text.  However the font specification is from
    GTK, and as such uses a different system to ImageMagick in general.  </P>

    You can find out more about fonts using GTK, by running the "gtk-demo"
    program, and double clicking "Pickers" and the "Text Widget". </P>

<DT><B>Defines</B>
<DD>There are lots of special <A HREF="../basics/#define" >Defines</A> that
    can be used to globally control various aspects of pango text formatting.
    These are currently listed on the <A
    HREF="https://imagemagick.org/script/formats.php#pseudo" >Pseudo File
    Formats</A>, though I have not explored all of them myself. </P>

    These are the ones I have used...

    <DL>
    <DT><CODE>-define pango:markup=false</CODE>
    <DD>Turn off the markup language tags. Any tags are then included in
        the output.  No pango formatting within the text is possible.  this is
        especially useful in debugging, letting you see exactly what pango sees
        for its input. </P>

    <DT><CODE>-define pango:justify=true</CODE>
    <DD>Justify text across the width of the image size. That is add extra
        intra-word spacing so both left and right edges of a block of text
        lines up. </P>

    </DL>

</DL>

<A NAME="pango_more"></A>
<H3>More Information on Pango</H3>

To see just what is posible see <A
HREF="http://www.pango.org/ScriptGallery" >Pango Script Gallery</A> </P>

If you do something interesting with pango, please contribute. Either mail me
(Address in page footer), or post it on the <A HREF="../forum_link.cgi?f=1"
>IM Discussion Forum</A>. </P>

<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH=90% ALIGN=center>
<TR valign="top">
<TD><IMG SRC="../img_www/expert.gif"   WIDTH=23 HEIGHT=26
    ><IMG SRC="../img_www/space.gif"   WIDTH=17 HEIGHT=16></TD>
<TD ALIGN=justify width="100%"><FONT SIZE=-1><I>
  On systems with pango installed you can also use the command
  "<CODE>pango-view</CODE>" for generate pango formated images.
  However its default 'density' or 'dpi' setting is your display
  (IM uses 72 dpi by default) and as such may vary from host to host.
</I></FONT></TD></TR></TABLE></P>

<HR><!-- ---------------------------------------------------------------- -->

<A NAME="text"></A>
<H2>Text - Pages of Plain Text </H2>

The "<CODE>text:</CODE>" input format is designed to magick plain text into
images consisting one image per page of text.  It is the 'paged text' input
operator of ImageMagick. </P>

In other words its purpose is to magick the larger preformatted text files into
pages in much the same way that printers print plain text onto separate pieces
of paper. </P>

<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH=90% ALIGN=center>
<TR valign="top">
<TD><IMG SRC="../img_www/reminder.gif" WIDTH=20 HEIGHT=16
    ><IMG SRC="../img_www/space.gif"   WIDTH=20 HEIGHT=16></TD>
<TD ALIGN=justify width="100%"><FONT SIZE=-1><I>
  Do <B>not</B> confuse the "<CODE>text:</CODE>" file input format with the
  similar "<CODE><A HREF="../files/#txt" >txt:</A></CODE>" input format.
  The latter will first attempt to read the file as a '<CODE>IM pixel
  enumeration</CODE>' image format. </P>

  That doesn't mean that a plain text file with a "<CODE>.txt</CODE>" will
  fail.  In fact such a file will probably be converted as you would expect,
  as the "<CODE><A HREF="../files/#txt" >txt:</A></CODE>" file format will
  automatically fall back to the "<CODE>text:</CODE>" format if an enumerated
  image is not recognised.  </P>

</I></FONT></TD></TR></TABLE></P>

Handling text in this way however had a number of problems.  First the text is
drawn onto a large canvas, leaving you with the problem of removing the unused
space, if such space is not wanted.  The other is that lines are not
'word-wrapped' but will overflow canvas and get truncated if they are too
long.  And finally, for very long text files, multiple pages (images) will be
generated unless some extra precautions are taken. </P>

On the other hand, "<CODE>text:</CODE>" will handle just about any text file,
without modifying the final image size produced, or word-wrapping very long
lines.  You also do not need to pre-process and special characters as you
would if you used the text on the command line.  Finally and more
importantly if a fixed width font (like Courier) is used, files with spaced
out columns of data, will still have that data in spaced out columns. </P>

Basically "<CODE>text:</CODE>" will magick the input file 'AS IS'. </P>

<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH=90% ALIGN=center>
<TR valign="top">
<TD><IMG SRC="../img_www/expert.gif"   WIDTH=23 HEIGHT=26
    ><IMG SRC="../img_www/space.gif"   WIDTH=17 HEIGHT=16></TD>
<TD ALIGN=justify width="100%"><FONT SIZE=-1><I>
  The input text data read from the file is essentially passed directly to the
  font library to draw the UTF text.  As a consequence of this some control
  characters may be drawn using unusual 'glyphs'.  This includes
  <CODE>TAB</CODE> and <CODE>FORMFEED</CODE> characters, which, at the time of
  writing, the 'freetype' library gets wrong. </P>

  If this is a concern, you may like to pre-process your text file using a
  filter program, such as "<CODE>expand</CODE>", to magick <CODE>TAB</CODE>
  characters into the appropriate number of spaces.
</I></FONT></TD></TR></TABLE></P>

When drawing text, a large 'letter' sized page is created (or the page size or
type specified with a "<CODE><A HREF="../option_link.cgi?page"
>-page</A></CODE>" )at the current resolution (set with "<CODE><A
HREF="../option_link.cgi?density" >-density</A></CODE>").  By default (at 72
dpi) this will be '<CODE>612x792</CODE>' pixels in size, which for most
purposes is very large.  </P>

For example here is a direct conversion of the plain text formatted manual for
the "<code>magick</code>" command, into an image (it is large so to see it
select the 'page' image on the right to see it)...

<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 width="100%">
<TR><TD width="100%" ALIGN=justify>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="100%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  man magick | col -b | expand | \
    magick -font CourierNew  text:- -delete 1--1 text_manpage.gif
</samp></pre></TD></TR></TABLE></TD><TD>
  <A HREF="text_manpage.gif"
     ><IMG SRC="../img_www/doc_page.png"
           ALIGN=middle VSPACE=5 HSPACE=5 BORDER=0 ALT="[IM Output]"></A>
</TD></TR></TABLE></P>

<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH=90% ALIGN=center>
<TR valign="top">
<TD><IMG SRC="../img_www/reminder.gif" WIDTH=20 HEIGHT=16
    ><IMG SRC="../img_www/space.gif"   WIDTH=20 HEIGHT=16></TD>
<TD ALIGN=justify width="100%"><FONT SIZE=-1><I>
  The above manual to image conversion however generates multiple pages
  (images), so I <A HREF="../basics/#delete" >Deleted</A> the second and
  later ones to leave me with just the first page, instead of a GIF
  animation of all the pages. </P>

  I could also have appended a <A HREF="../files/#read_mods" >Read
  Modifier</A>, '<CODE>[0]</CODE>' input filename, such as
  "<CODE>text:-'[0]'</CODE>", to tell IM only to read the first image
  generated.  Though at this time all the page selection is still handled by
  generating all pages and deleting the unwanted pages.

</I></FONT></TD></TR></TABLE></P>

I purposely used the 'fixed-width' font '<CODE>CourierNew</CODE>' in the above
so as to preserve the character spaced formatting that is present in the
printed page. </P>

Note how this output varies from that of <A HREF="#caption" >caption:</A>
above. The overall look of this image can also be improved by using the same
techniques given in <A HREF="#ps" >Postscript</A> section next.  </P>

If you just want to know how big say a 'A5' page is at 100 dpi, then this
command generates a single blank page, of that size and returns its size in
pixels.  The filename, "<CODE>/dev/null</CODE>", is a special UNIX file that
is always empty.

<DIV ALIGN=center>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="90%" bgcolor="#f8f8f8">
<TR><TD><PRE><CODE EXECUTE OUT=page_size.txt>
  magick -page A5 -density 100 -units PixelsPerInch  text:/dev/null \
          -format 'Page Size at %x = %w x %h pixels'  info:
</samp></pre></TD></TR></TABLE>
<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=5 width="90%" bgcolor="#f8f8f8">
<TR><TD>
  <A HREF="page_size.txt"
     ><IMG SRC="page_size.txt.gif"
           ALIGN=middle VSPACE=0 HSPACE=0 BORDER=0 ALT="[IM Text]"></A>
</TD></TR></TABLE>
</DIV></P>


<A NAME="text_trim"></A>
<H3>Trimming Text Pages</H3>

Because the text is being 'drawn' onto a large canvas, you will likely want to
remove all the unused space produced.  This can be done by using the image
operations "<CODE><A HREF="../option_link.cgi?trim" >-trim</A></CODE>",
"<CODE><A HREF="../option_link.cgi?repage" >+repage</A></CODE>", then to make
it look reasonable, re-adding some edge space using "<CODE><A
HREF="../option_link.cgi?border" >-border</A></CODE>".  Of course you will
also need to match the "<CODE><A HREF="../option_link.cgi?background"
>-background</A></CODE>" color you used as the "<CODE><A
HREF="../option_link.cgi?bordercolor" >-bordercolor</A></CODE>" you are
re-adding. </P>

Sounds complex?  It isn't really, for example...
<DIV ALIGN=center>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="90%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  echo "    Hello Cruel World    " |\
    magick -background  lightblue  -fill blue  -pointsize 18 \
            text:-    -trim +repage  -bordercolor lightblue  -border 3 \
            text_trimmed.gif
</samp></pre></TD></TR></TABLE>
  <A HREF="text_trimmed.gif"
     ><IMG SRC="text_trimmed.gif"
           ALIGN=middle VSPACE=5 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</DIV></P>

In the above example "<CODE><A HREF="../option_link.cgi?trim"
>-trim</A></CODE>" is used to remove the vast amount of extra white space in
the "<CODE>text:</CODE>" page image. This however will also remove any leading
spaces in front of a line!  </P>

There is however an interesting technique which will allow you to "<CODE><A
HREF="../option_link.cgi?trim" >-trim</A></CODE>" the image down to the size
of the actual text drawn onto the page, including any leading and trailing
spaces in the input. This uses a special "<CODE><A
HREF="../option_link.cgi?undercolor" >-undercolor</A></CODE>" setting (looked
at in detail later).

<DIV ALIGN=center>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="90%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  echo "    Hello Cruel World    " |\
    magick -background  white -undercolor lightblue  -fill blue \
            -pointsize 18   text:-  -trim +repage \
            -bordercolor white  -border 3    text_boxed.gif
</samp></pre></TD></TR></TABLE>
   <A HREF="text_boxed.gif"
      ><IMG SRC="text_boxed.gif"
            ALIGN=middle VSPACE=5 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</DIV></P>

The extra space at bottom of the text is a result of the last 'newline'
character in the text input, creating an extra blank line in the image.  But
as you can see the leading and trailing spaces of the input text was
preserved.  </P>

If you use a transparent background color in the above, you can then flatten
the trimmed image to magick the undrawn areas into the same color as the
'undercolor' used.

<DIV ALIGN=center>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="90%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  echo "    Hello Cruel World    " |\
    magick -background  none  -undercolor lightblue  -fill blue \
            -pointsize 18   text:-  -trim +repage  \
            -bordercolor lightblue  -border 3 \
            -background lightblue  -flatten    text_box_trimmed.gif
</samp></pre></TD></TR></TABLE>
   <A HREF="text_box_trimmed.gif"
      ><IMG SRC="text_box_trimmed.gif"
            ALIGN=middle VSPACE=5 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</DIV></P>

The result of the above (except for the added "<CODE><A
HREF="../option_link.cgi?border" >-border</A></CODE>" is actually almost exactly
what IM now produces using a "<CODE><A HREF="#label" >label:</A></CODE>" and
reading from a '<CODE>@</CODE>' escaped filename.  However "<CODE><A
HREF="#label" >label:</A></CODE>" does it in a faster, and far cleaner way
(via the "<CODE>freetype</CODE>" library rather than a postscript conversion).
</P>

You can specify a smaller "<CODE><A HREF="../option_link.cgi?page"
>-page</A></CODE>" size, either in pixels (see next example), or using a media
page size (such as '<CODE>A5</CODE>'), using the "<CODE><A
HREF="../option_link.cgi?density" >-density</A></CODE>" or pixel resolution
setting.  You can also specify the offset at which to start drawing the text
on the page, relative to the top left corner.  For example...

<DIV ALIGN=center>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="90%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  echo "This is a long line that shows that 'text:' does not word wrap." |\
     magick -background  lightblue  -pointsize 18 \
             -fill blue  -page 320x95+50+10  text:-'[0]' +repage  text_page.gif
</samp></pre></TD></TR></TABLE>
   <A HREF="text_page.gif"
      ><IMG SRC="text_page.gif"
            ALIGN=middle VSPACE=5 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</DIV></P>

<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH=90% ALIGN=center>
<TR valign="top">
<TD><IMG SRC="../img_www/reminder.gif" WIDTH=20 HEIGHT=16
    ><IMG SRC="../img_www/space.gif"   WIDTH=20 HEIGHT=16></TD>
<TD ALIGN=justify width="100%"><FONT SIZE=-1><I>
  Almost all other image creation operators use the "<CODE><A
  HREF="../option_link.cgi?page" >-page</A></CODE>" setting to set a larger
  virtual 'canvas' and an 'offset' for the image on that canvas, generally for
  the purpose of layering images or generating animations.  Because of this it
  is probably a good idea to reset your page setting using "<CODE><A
  HREF="../option_link.cgi?page" >+page</A></CODE>" after any
  "<CODE>text:</CODE>" or "<CODE>ps:</CODE>" operation, or you may get
  unexpected results for any secondary images you may latter read in on the
  same command line.  </P>

  This also is why I added a "<CODE><A HREF="../option_link.cgi?repage"
  >+repage</A></CODE>" operator to the above example otherwise the text is
  offset, and the image generated is also offset! </P>

  For more details of using this offset see <A HREF="../basics/#page" >Page
  Image Attributes</A>.
</I></FONT></TD></TR></TABLE></P>

Note how in the last example, any text line that is too long to fit the width
of the page will overflow the page, and not be 'wrapped'. This will
effectively crop and junk the end of the lines.  Also if there are too many
lines, then "<CODE>text:</CODE>" will generate <I>multiple pages</I> and thus
<I>multiple images</I>, one for each page generated by the postscript
translation of the text file.  </P>

If you are only interesting in the first page of text, or just want to avoid
the possibility of multiple images, add a '<CODE>[0]</CODE>' to the
"<CODE>text:</CODE>" filename, to tell IM to only read the first page
generated <I>after</I> the text has been converted to images (see previous
example). </P>


<A NAME="ps"></A>
<A NAME="postscript"></A>
<H2>Postscript/PDF - Pre-formatted Text and Graphics Input
<FONT SIZE=-1><BR>(or other vector image formats)</FONT></H2>

The following gives a standard vector image handling technique that can not
only be used for "<CODE>PS:</CODE>" (postscript) images  but all other images
handled using vector graphics. This includes image formats such as:
"<CODE>PDF:</CODE>" (portable document format), "<CODE><A HREF="#text"
>TEXT:</A></CODE>" (paged plain text), and even "<CODE><A HREF="../draw/#svg"
>SVG:</A></CODE>" (scaled vector graphic) and "<CODE><A HREF="../formats/#wmf"
>WMF:</A></CODE>". </P>

This method can be expanded to give you a very fine control of exactly how the
text will look as an image.   For example with the right 'text to postscript'
filter, you can control the word wrapping, justifications, multiple font
handling, bolding, borders, titles, filenames, dates, and other fluff in the
postscript image. </P>

However as this section is about text to image, it means you need to first
magick your text to a formatted postscript file. There are lots of external
programs that can be used to do this. For example "<CODE>a2ps</CODE>",
"<CODE>enscript</CODE>" or "<CODE>pstext</CODE>". </P>

Essentially you can use a word processor (like '<CODE>OpenOffice</CODE>' or
'<CODE>Word</CODE>', or even '<CODE>Notepad</CODE>'), OR if you want a batch
text processing system you could use at '<CODE>TeX</CODE>' and
'<CODE>LaTeX</CODE>' to generate your pre-formatted text (see <A HREF="#tex"
>A Complete Text Processing System</A> below).  These programs are all
designed to handle the complexity of mixing plain, bold, different size, and
font text together, along with word-wrapping, justification and paragraphing
controls.  The output from these programs can then be passed to IM to convert
it to an image of the size and quality you desire.  </P>

So lets first generate some postscript (converting text from a personal fortune
program).

<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 width="100%">
<TR><TD width="100%" ALIGN=justify>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="100%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  mesgs LN-ManKzinWars | \
    a2ps -q -1 --rows=10 --prologue=bold \
         --center-title="Postscript via 'a2ps'" \
         --header='' --left-footer='' --right-footer='' \
         -o ps_version.ps
</CODE><!--<CODE NO_EXECUTE>
  mesgs LN-ManKzinWars | \
    enscript -q -G -f CourierBold12 -t "Postscript via 'enscript'" -o - |\
      perl -pe 'print "%%LanguageLevel: 3\n" if 2..2' > ps_version.ps
</CODE>--></PRE></TD></TR></TABLE></TD><TD>
  <A HREF="ps_version.ps"
     ><IMG SRC="../img_www/doc_ps.png"            WIDTH=48 HEIGHT=48
           ALIGN=middle VSPACE=5 HSPACE=5 BORDER=0 ALT="[IM Output]"></A>
</TD></TR></TABLE></P>

<!--
<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH=90% ALIGN=center>
<TR valign="top">
<TD><IMG SRC="../img_www/expert.gif"   WIDTH=23 HEIGHT=26
    ><IMG SRC="../img_www/space.gif"   WIDTH=12 HEIGHT=16></TD>
<TD ALIGN=justify width="100%"><FONT SIZE=-1><I>
  The "<CODE>perl</CODE>" command in the above example adds a
  '<CODE>%%LanguageLevel: 3</CODE>' line to the generated postscript file.
  This is needed so that the later transparent postscript options to work
  correctly to preserve the transparency. </P>

  The real problem here is that the "<CODE>ghostscript</CODE>" delegate
  program does not provide a single conversion method for IM to use, requiring
  IM to try and figure out correct call style to use to generate a correct
  image for the given postscript.  The 'Language Level' gives IM the hint it
  needs to figure it out correctly.

</I></FONT></TD></TR></TABLE></P>
-->

Now we can magick that into an image, trimming the result (as per
"<CODE>text:</CODE>" examples above) to remove the excess blank areas from the
default page/canvas generated.

<DIV ALIGN=center>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="90%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  magick ps_version.ps'[0]' \
          -trim +repage   -bordercolor white -border 3  ps_version_raw.gif
</samp></pre></TD></TR></TABLE>
  <A HREF="ps_version_raw.gif"
     ><IMG SRC="ps_version_raw.gif"
           ALIGN=middle VSPACE=5 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</DIV></P>

Note the use of '<CODE>[0]</CODE>' to limit the input to just the first page.
If your postscript image generates multiple pages, it will still be completely
processed by the "<CODE>ghostscript</CODE>" delegate, but IM will only read
the first image returned, rather than generate multiple images, one image per
page. If you postscript is very large, you may like to use other postscript
utilities to limit the number of pages before processing it with IM and
"<CODE>ghostscript</CODE>". </P>

As you can see postscript converted to the default "<CODE><A
HREF="../option_link.cgi?density" >-density</A></CODE>" of 72 dpi, often does
not look as good as it should, with only a minimal amount of anti-aliasing.
This is particularly the case when dealing with postscript fonts, which are
not designed to work at these low-resolutions. </P>

To improve this, you can use a <A HREF="../distorts/#super_sample" >Super
Sampling</A> technique to generate a better image.  In this case you ask
"<CODE>ghostscript</CODE>" draw the page at a higher resolution (or image
"<CODE><A HREF="../option_link.cgi?density" >-density</A></CODE>"). You can
then "<CODE><A HREF="../option_link.cgi?resample" >-resample</A></CODE>" (a <A
HREF="../resize/#resample" >specalized resize</A>) to bring this larger image
back to a more 'normal' screen resolution density.

<DIV ALIGN=center>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="90%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  magick -density 196   ps_version.ps'[0]' -resample 72 \
          -trim +repage   -bordercolor white -border 3  ps_version.gif
</samp></pre></TD></TR></TABLE>
  <A HREF="ps_version.gif"
     ><IMG SRC="ps_version.gif"
           ALIGN=middle VSPACE=5 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</DIV></P>

The value '<CODE>196</CODE>' is 3 times the final 72dpi, which means when
"<CODE><A HREF="../option_link.cgi?resample" >-resample</A></CODE>" is used
approximately 3&times;3 pixels are merged down into each pixel. This produces
better anti-aliasing pixels along the edges of the text improving the overall
look of the result. </P>

Also note that using a larger density or resolution is not quite the same as
just enlarging a font. The font definitions could have adjustments for
handling low resolution situations.  For example compare the hole in the
letter '<CODE>e</CODE>' in the two images.  The original version is sharper
due to special handling within the font, even though over all the latter super
sampled version is clearer.  For more information see <A HREF="#pointsize"
>Resolution, Pointsize, and Actual Font Size</A> below. </P>

You don't have to use the values above, as sometimes slightly different value
may produce a better or more desirable result.

Of course having "<CODE>ghostscript</CODE>" generate an image 2, 3, or even 4
times larger also means IM will take 4, 9 or 16 times longer to generate the
image!  It will also use that much more memory and temporary disk space!  But
the results are generally worth it. The best idea is to just try it out for
your own document, and see what gives you the best results. </P>

Also if you need more anti-aliasing, rather than using an even larger input
resolution, you could try blurring the image by a sub-pixel amount (say
'<CODE>-blur 0x0.7</CODE>') before you reduce its size.  I have also sometimes
found that a very small amount of unsharpening after the resize (a common
photoshop technqiue), can improve the overall final result.

<DIV ALIGN=center>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="90%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  magick -density 196   ps_version.ps'[0]' \
          -blur 0x0.7 -resample 72 -unsharp 0x0.7 \
          -trim +repage   -bordercolor white -border 3  ps_unsharp.gif
</samp></pre></TD></TR></TABLE>
  <A HREF="ps_unsharp.gif"
     ><IMG SRC="ps_unsharp.gif"
           ALIGN=middle VSPACE=5 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</DIV></P>

But I would be careful of these adjustments, as it could make things worse.
</P>

<BR>

If you like to have a transparent background instead of white, you can specify
a "<CODE><A HREF="../option_link.cgi?channel" >-channel</A></CODE>" setting of
'<CODE>RGBA</CODE>', to include the alpha channel in the image.  Of course you
will need to use an image format that can handle semi-transparent colors.

<DIV ALIGN=center>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="90%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  magick -channel RGBA -density 196  ps_version.ps'[0]' -resample 72 \
          -trim +repage   -bordercolor none -border 3  ps_transparent.png
</samp></pre></TD></TR></TABLE>
  <A HREF="ps_transparent.png"
     ><IMG SRC="ps_transparent.png"
           ALIGN=middle VSPACE=5 HSPACE=5 BORDER=0 ALT="[IM Output]"></A>
</DIV></P>

Notice that the banner still uses an off white color for its backgrounds,
rather than also being made transparent or semi-transparent.  That is because
the postscript generated actually draws that background, replacing the default
background of the page (be it white or transparent). </P>

Making the background transparent like this will allow you to overlay your
postscript image on a specific background color.

<DIV ALIGN=center>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="90%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  magick ps_transparent.png -background skyblue -flatten  ps_bgnd_color.gif
</samp></pre></TD></TR></TABLE>
  <A HREF="ps_bgnd_color.gif"
     ><IMG SRC="ps_bgnd_color.gif"
           ALIGN=middle VSPACE=5 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</DIV></P>

Using a <A HREF="../compose/#compose" >Alpha Compositing Method</A> you can
even overlay it onto a specific background image, or a tiled background.

<DIV ALIGN=center>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="90%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  magick composite -tile bg.gif  ps_transparent.png  -compose DstOver \
            ps_bgnd_tiled.gif
</samp></pre></TD></TR></TABLE>
  <A HREF="ps_bgnd_tiled.gif"
     ><IMG SRC="ps_bgnd_tiled.gif"
           ALIGN=middle VSPACE=5 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</DIV></P>

As almost all postscript printers only can darken paper or an overhead
transparency, (this includes color printers), when the above is printed the
banner would be made semi-transparent automatically. </P>

If you also want IM do the same thing, as what a printer would do, you can use
a special '<CODE><A HREF="../compose/#multiply" >Multiply</A></CODE>' alpha
composition, to overlay the 'white background' image, onto the desired 'paper'
background.

<DIV ALIGN=center>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="90%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  magick composite -tile bg.gif  ps_version.gif  -compose Multiply  ps_multiply.gif
</samp></pre></TD></TR></TABLE>
  <A HREF="ps_multiply.gif"
     ><IMG SRC="ps_multiply.gif"
           ALIGN=middle VSPACE=5 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</DIV></P>

If you have a color postscript image, you also can simulate a pure black and
white printer onto colored paper by using the special '<CODE><A
HREF="../compose/#bumpmap" >BumpMap</A></CODE>' compose method.  This will
grey-scale the source overlay image, before it uses uses multiply to composite
the images together.  </P>

You can also generate the grey-scale image equivalent of an overhead
transparency slide.  This basically uses the opaque, white background image
(from above) as a 'mask' which to set shaped transparent image using the <A
HREF="../basics/#alpha_shape" >Alpha Shape Operator</A> </P>

<DIV ALIGN=center>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="90%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  magick ps_version.gif -negate -background black -alpha shape  ps_overhead.png
</samp></pre></TD></TR></TABLE>
  <A HREF="ps_overhead.png"
     ><IMG SRC="ps_overhead.png"
           ALIGN=middle VSPACE=5 HSPACE=5 BORDER=0 ALT="[IM Output]"></A>
</DIV></P>

Like the "<CODE><A HREF="#text" >text:</A></CODE>" converter above, the
"<CODE>ps:</CODE>" converter also makes use of the "<CODE><A
HREF="../option_link.cgi?page" >-page</A></CODE>" setting to set the canvas
size of the image 'media' onto which the page is drawn. Though offset supplied
will be ignored.  However as most postscript files define the drawing media
size internally, this is usually not necessary.  </P>

<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH=90% ALIGN=center>
<TR valign="top">
<TD><IMG SRC="../img_www/reminder.gif" WIDTH=20 HEIGHT=16
    ><IMG SRC="../img_www/space.gif"   WIDTH=20 HEIGHT=16></TD>
<TD ALIGN=justify width="100%"><FONT SIZE=-1><I>
  Most other image creation operators use the "<CODE><A
  HREF="../option_link.cgi?page" >-page</A></CODE>" setting to set a 'virtual
  canvas' and an ofset on that virtual canvas (for example to generate GIF
  animations).  As such it is probably a good idea to reset it using "<CODE><A
  HREF="../option_link.cgi?page" >+page</A></CODE>" after using it for
  a "<CODE>text:</CODE>" or "<CODE>ps:</CODE>" image read operation, otherwise
  you may get unexpected results with the later images.  </P>

  For more details of using this offset see <A HREF="../basics/#page" >Page
  Image Attributes</A>.

</I></FONT></TD></TR></TABLE></P>

As a final practical example, have a look at my <A
HREF="http://www.ict.griffith.edu.au/anthony/graphics/polyhedra/platonic/tetrahedron.jpg"
>Ray Traced Tetrahedron</A> image. Other similar images can be seen in <A
HREF="http://www.ict.griffith.edu.au/anthony/graphics/polyhedra/" >Studies
into Polyhedra</A>. </P>

The background page was generated from the same data used to produce the
displayed 3D mathematical object. The text data was converted using
"<CODE>a2ps</CODE>", then IM was used to magick this to an image. Onto this
image other pre-prepared line drawings of the same mathematical object was
added to the page.  This final image (saved in 'targa' or TGA format) was then
passed to the "<CODE><A HREF="http://www.povray.org/" >PovRay</A></CODE>"
ray-tracer for inclusion in the final image or ray traced scene. </P>

<A NAME="ghostscript"></A>
<H3>Using GhostScript Directly</H3>

While this not strictly IM, <I>Richard Bollinger</I> has reported that running
the "<CODE>ghostscript</CODE>" delegate directly is much more efficient,
producing an order of magnitude faster processing due to less file handling,
by IM.</P>

For example instead of running...
<DIV ALIGN=center>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="90%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  magick -density 300x300 -compress Group4 file.ps  file.tif
</samp></pre></TD></TR></TABLE>
</DIV></P>

You can get GhostScript to do it directly.

<DIV ALIGN=center>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="90%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  gs -dBATCH -dNOPAUSE -sDEVICE=tiffg4 -r300x300 \
     -sOutputFile=file.tif  file.ps
</samp></pre></TD></TR></TABLE>
</DIV></P>

This prevents the need for IM to generate a large temporary file (for security
and pipelined image handling). As a result of this, direct use of GhostScript
can save quite a lot of file handling and IO processing, and can produce
a major performance boost when processing postscript and PDF files.  </P>

However "<CODE>ghostscript</CODE>" can not resize images, (other than adjust
the output density or resolution) and will probably not be able to output the
image in the image file format you require, or at the quality you want. But
you can always then feed the GhostScript output to ImageMagick to finish the
task. </P>

That is especially the case if you want to super-sample the results (higher
resolution input, to resized smaller output). </P>

GhostScript can be a difficult program to figure out how to use, or fix for
specific types of postscript.  Cristy constantly battles with these issues on
behalf of IM users, and in this he has done a super effort.  Unfortunately in
dealing with the many things that can (and does) happen, IM can not provide a
simplified method for postscript/PDF via GhostScript. </P>

<!-- ------ -->

<A NAME="draw"></A>
<H2>Draw - Draw Text on Existing Canvas</H2>

By using the low level "<CODE><A HREF="../option_link.cgi?draw"
>-draw</A></CODE>" operator to draw the font we get a lot more control,
especially as to the exact position of the font, and the size of the image it
is drawn into.

<DIV ALIGN=center>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="90%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  magick -size 320x100 xc:lightblue  -font Candice -pointsize 72 \
          -fill blue  -draw "text 25,65 'Anthony'" text_draw.gif
</samp></pre></TD></TR></TABLE>
  <A HREF="text_draw.gif"
     ><IMG SRC="text_draw.gif"                      WIDTH=320 HEIGHT=100
           ALIGN=middle VSPACE=5 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</DIV></P>

However to use it we need to generate a background image of the appropriate
size to draw the font, which can be tricky when drawing some unknown text. See
<A HREF="#size" >Auto Sizing of Font Images</A> for ways to solve this
problem. </P>

A lot of extra options, beyond the standard text options also effect how
"<CODE><A HREF="../option_link.cgi?draw" >-draw</A></CODE>", actually draws
text on an image.  Not only can you specify a "<CODE><A
HREF="../option_link.cgi?fill" >-fill</A></CODE>" color, but you can also
specify a "<CODE><A HREF="../option_link.cgi?undercolor"
>-undercolor</A></CODE>", as well
as an edge or "<CODE><A HREF="../option_link.cgi?stroke" >-stroke</A></CODE>"
color, both of which are turned off by default (set to a color of
'<CODE>none</CODE>'. </P>

The "<CODE><A HREF="../option_link.cgi?fill" >-fill</A></CODE>" color can also
be replaced by a "<CODE><A HREF="../option_link.cgi?tile" >-tile</A></CODE>"
image pattern, while the stroke edge width can be changed using "<CODE><A
HREF="../option_link.cgi?strokewidth" >-strokewidth</A></CODE>". Then the
relative position of the drawn text can be changed a with "<CODE><A
HREF="../option_link.cgi?gravity" >-gravity</A></CODE>" setting. </P>

For example here I used many of the extra features I just mentioned.

<DIV ALIGN=center>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="90%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  magick -size 320x100 xc:lightblue  -font Candice -pointsize 72 \
          -tile bg.gif  -undercolor dodgerblue  -stroke navy  -strokewidth 2 \
          -gravity center  -draw "text 0,0 'Anthony'" text_options.gif
</samp></pre></TD></TR></TABLE>
  <A HREF="text_options.gif"
     ><IMG SRC="text_options.gif"             WIDTH=320 HEIGHT=100
           ALIGN=middle VSPACE=5 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</DIV></P>

<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH=90% ALIGN=center>
<TR valign="top">
<TD><IMG SRC="../img_www/warning.gif"  WIDTH=28 HEIGHT=28
    ><IMG SRC="../img_www/space.gif"   WIDTH=12 HEIGHT=16></TD>
<TD ALIGN=justify width="100%"><FONT SIZE=-1><I>
  As of IM version 6.2.4, the "<CODE><A HREF="../option_link.cgi?draw"
  >-draw</A></CODE> text" operation no longer understands the use of
  '<CODE>\n</CODE>' as meaning newline, or the use of percent
  '<CODE>%</CODE>' image information escapes. (See <A
  HREf="../bugs/draw_percent/" >Drawing a Percent Bug</A>). </P>

  These abilities, and problems, however remain available in the new IM v6
  operator "<CODE><A HREF="../option_link.cgi?annotate"
  >-annotate</A></CODE>".  See the <A HREF="#annotate" >Annotate Text
  Drawing Operator</A> below.

</I></FONT></TD></TR></TABLE></P>

All the above options can also be used within the "<CODE><A
HREF="../option_link.cgi?draw" >-draw</A></CODE>" (MVG - Magick Vector Graphic)
string. However if you set the above option within the draw argument, that
option will only apply to that specific draw MVG string. </P>

On top of this the draw MVG format can do much much more, such a text rotation
and font 'decorating' and of course you can also draw various shapes like
circles onto the image.  </P>

For example here we draw underlined, and rotated text, overlaid on a couple of
background circles.

<DIV ALIGN=center>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="90%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  magick -size 320x120 xc:lightblue \
          -draw "fill tomato  circle 250,30 310,30 \
                 fill limegreen  circle 55,75 15,80 \
                 font Candice  font-size 72  decorate UnderLine \
                 fill dodgerblue  stroke navy  stroke-width 2 \
                 translate 10,110 rotate -15 text 0,0 ' Anthony '" \
          draw_mvg.gif
</samp></pre></TD></TR></TABLE>
  <A HREF="draw_mvg.gif"
     ><IMG SRC="draw_mvg.gif"             WIDTH=320 HEIGHT=120
           ALIGN=middle VSPACE=5 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</DIV></P>

If you really want to make maximum use of "<CODE><A
HREF="../option_link.cgi?draw" >-draw</A></CODE>" for creating your image, I
suggest you look at the <A HREf="../draw/" >Drawing Examples Page</A>. </P>


<A NAME="undercolor" ></A>
<H3>Undercolor Box</H3>

The "<CODE><A HREF="../option_link.cgi?undercolor" >-undercolor</A></CODE>"
color setting, as demonstrated above, and later below, will color the defined
drawing area for that character and font.  generally it just fits the drawn
character.  This is particularly the case the left and right edges of the
drawn font, as the top and bottom edges are usually larger enough to
accommodate all the characters. The drawing area basically represents the
character 'cell' boundaries surrounding the area in which the font is drawn.
</P>

The major use of using the "<CODE><A HREF="../option_link.cgi?undercolor"
>-undercolor</A></CODE>" option, is as a simple and quick way to clear a
'noisy' background from around the text. For example look at <A
HREF="../annotating/#anno_on" >Annotating on Top Images</A>. However it is
recommended you also add an extra space character at the start and end of the
string being drawn in that case. </P>


<A NAME="overflow"></A>
<H3>Bounding Box Overflow</H3>

One of the biggest problems you will probably come across when drawing text,
or just generally handling fonts, is that not all fonts obey the normal rules.
</P>

A font designer can 'draw' individual characters (or 'glyphs') anywhere
relative to the current text position (known as the caret).  The font position
does not even have to move forward, and in some international fonts could even
move backward!. </P>

The result of this freedom of design is that some 'glyphs' do not fit inside
the defined drawing area which the font declares the character fits into,
especially on slanted, or script-like fonts where some parts of the letters
extend well outside the bounds and into the areas used by later (or previous)
characters. </P>

The worst font I have seen in this regards is the '<CODE>LokiCola</CODE>'
font, which draws around half of its capital letters with long wavy tails,
well beyond the bounds of the individual character cells.  The font basically
assumes each capital letter will be followed by 3 or more lowercase letters.
</P>

To show this I'll draw a number of the font's capital letters separately,
allowing you to see just how far the letters could extend beyond the cell
'undercolor' or drawing bounds.  I also use a couple of them to form the fonts
name, so you can see just as they were designed to be used, and why they
overflow their bounding boxes.

<DIV ALIGN=center>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="90%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  magick -size 500x200  xc:lightblue \
          -font LokiCola  -pointsize 72  -undercolor dodgerblue \
          -draw "text  15,65 'L'"   -draw "text 130,65 'C'" \
          -draw "text 245,65 '1'"   -draw "text 360,65 'H'" \
          -gravity South -draw "text 0,10 'Loki Cola'"    draw_undercolor.gif
</samp></pre></TD></TR></TABLE>
  <A HREF="draw_undercolor.gif"
     ><IMG SRC="draw_undercolor.gif"        WIDTH=500 HEIGHT=200
           ALIGN=middle VSPACE=5 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</DIV></P>

Also note how the '<CODE>H</CODE>' actually overflows on the left side as well
as the right side of its drawing area. This can make it difficult to use at
the beginning of lines.  </P>

<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH=90% ALIGN=center>
<TR valign="top">
<TD><IMG SRC="../img_www/reminder.gif" WIDTH=20 HEIGHT=16
    ><IMG SRC="../img_www/space.gif"   WIDTH=20 HEIGHT=16></TD>
<TD ALIGN=justify width="100%"><FONT SIZE=-1><I>
  Remember this problem is NOT a bug in IM, but caused by the interaction of
  the font library IM uses, and the settings within the font itself,
  usually on purpose by the font designer.  IM just uses the results as they
  are programmed in the font, which does not always produce what the user
  intended.  Caution is thus advised with unusual fonts.
</I></FONT></TD></TR></TABLE></P>

<!-- ------ -->

<A NAME="annotate"></A>
<H2>Annotate - Text Drawing Operator</H2>

With IM version 6, a new font drawing operator, "<CODE><A
HREF="../option_link.cgi?annotate" >-annotate</A></CODE>", was made available.
This operator is in may ways much simpler that using a "<CODE><A
HREF="../option_link.cgi?draw" >-draw</A></CODE> text" operation, but as it
uses the '<CODE>annotate()</CODE>' API (Application Program Interface), it is
also more powerful. </P>

While the operator does make use of the "<CODE><A
HREF="../option_link.cgi?draw" >-draw</A></CODE>" primitives, it does so in a
more complex way, such as expanding special <A HREF="#escape_chars" >escape
characters</A> to add extra image information and even multiple lines, and
applying a coordinate system transform to the drawn text to produce slants and
rotations.  </P>

Because of this, the operator is now the preferred text drawing operator for
all ImageMagick text drawing and image annotation, and this is now reflected
in these example pages. </P>

Here is a basic example using this operator.

<DIV ALIGN=center>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="90%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  magick -size 320x100 xc:lightblue -font Candice -pointsize 72 \
          -fill blue  -annotate +25+70 'Anthony'    annotate.gif
</samp></pre></TD></TR></TABLE>
  <A HREF="annotate.gif"
     ><IMG SRC="annotate.gif"            WIDTH=320 HEIGHT=100
           ALIGN=middle VSPACE=5 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</DIV></P>

One of the extra features of the "<CODE><A HREF="../option_link.cgi?annotate"
>-annotate</A></CODE>" operator is that it can rotate the X and Y axis of the
drawn text completely separately to each other.   This is done by providing the
angle in which to rotate each axis as a 'image size' in the operators
argument. </P>

Just to show how complex a single "<CODE><A HREF="../option_link.cgi?annotate"
>-annotate</A></CODE>" operation can be, here is a boxed, stroked, and slanted
image...

<DIV ALIGN=center>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="90%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  magick -size 320x100 xc:lightblue -font Candice -pointsize 72 \
          -tile bg.gif  -undercolor dodgerblue   -stroke navy -strokewidth 2 \
          -annotate 0x20+20+67 'Anthony' annotate_opts.gif
</samp></pre></TD></TR></TABLE>
  <A HREF="annotate_opts.gif"
     ><IMG SRC="annotate_opts.gif"            WIDTH=320 HEIGHT=100
           ALIGN=middle VSPACE=5 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</DIV></P>

In this example all four annotate arguments are given.  Specifically,
X axis rotation, Y axis rotation, and the fonts X and Y position on the
background image. </P>

Also note that the fill pattern (set with "<CODE><A
HREF="../option_link.cgi?tile" >-tile</A></CODE>") is also slanted with the
font.  That is because it is drawn using a sheared/rotated coordinate system,
which also shears and fill pattern tiled within the drawn  text. </P>

Further example of this shearing capability is the <A HREF="../fonts/#slewed"
>Sheared Shadow Font</A> example.  Compare that with the <A
HREF="../fonts/#slanted" >Slanted Font</A> created with the equivalent
"<CODE><A HREF="../option_link.cgi?draw" >-draw</A></CODE>" MVG string. </P>

For a table summarizing the effects of the "<CODE><A
HREF="../option_link.cgi?annotate" >-annotate</A></CODE>" shearing operation,
see <A HREF="../misc/#annotate" >Annotate Argument Usage</A>. </P>

For example here is some slightly rotated text ...

<DIV ALIGN=center>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="90%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  magick -size 320x100 xc:lightblue -font Candice -pointsize 72 \
          -annotate 350x350+20+90 'Anthony' annotate_rotated.gif
</samp></pre></TD></TR></TABLE>
   <A HREF="annotate_rotated.gif"
      ><IMG SRC="annotate_rotated.gif"            WIDTH=320 HEIGHT=100
            ALIGN=middle VSPACE=5 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</DIV></P>

<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH=90% ALIGN=center>
<TR valign="top">
<TD><IMG SRC="../img_www/reminder.gif" WIDTH=20 HEIGHT=16
    ><IMG SRC="../img_www/space.gif"   WIDTH=20 HEIGHT=16></TD>
<TD ALIGN=justify width="100%"><FONT SIZE=-1><I>
  Note that the angle given to "<CODE><A HREF="../option_link.cgi?annotate"
  >-annotate</A></CODE>" must be positive for IM to understand it correctly).
  The exception to this is if a comma-separated 4 number form of <A
  HREF="../basics/#arg_geometry" >Geometry Argument</A> is used.  For example
  "</I><CODE>-annotate '-10,-10,20,90' 'Anthony'</CODE><I>", could have been
  used in the last example.

</I></FONT></TD></TR></TABLE></P>


This can be used to generate angled condensed labeling.  For example...

<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 width="100%">
<TR><TD width="100%" ALIGN=justify>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="100%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  magick -size 100x60 xc:skyblue \
          -annotate 300x300+20+50 "First" \
          -annotate 300x300+35+50 "Second" \
          -annotate 300x300+50+50 "Third" \
          -annotate 300x300+65+50 "Fourth" \
          -annotate 300x300+80+50 "Fifth" \
          annotated_labels.jpg
</samp></pre></TD></TR></TABLE></TD><TD>
  <A HREF="annotated_labels.jpg"
     ><IMG SRC="annotated_labels.jpg"   WIDTH=100  Height=60
           ALIGN=middle VSPACE=0 HSPACE=2 BORDER=1 ALT="[IM Output]"></A>
</TD></TR></TABLE>

You can also add other information about the current image to the Annotated
string using escape characters.  For example lets overwrite the built-in
"<CODE>rose:</CODE>" image with information about the images size.  To center
the text on the image we use a "<CODE><A HREF="../option_link.cgi?gravity"
>-gravity</A></CODE>" setting, and turn off any and all rotations and offsets
by using an "<CODE><A HREF="../option_link.cgi?annotate"
>-annotate</A></CODE>" argument of '<CODE>0</CODE>'.

<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 width="100%">
<TR><TD width="100%" ALIGN=justify>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="100%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  magick rose: -fill white -stroke black  -font Candice -pointsize 20 \
          -gravity center   -annotate 0 '%wx%h\nPixels'    annotate_rose.gif
</samp></pre></TD></TR></TABLE></TD><TD>
  <A HREF="annotate_rose.gif"
      ><IMG SRC="annotate_rose.gif"
            ALIGN=middle VSPACE=5 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</TD></TR></TABLE></P>

For more information see <A HREF="#escape_chars"
>Special Escape Characters in Text Arguments</A>  below. </P>

For other examples of annotating text onto a larger image in various ways
(such as centered on the side, or rotated in the bottom-right corner) see
<A HREF="../annotating/#practical" >Practical Text Annotation Examples</A>.
</P>

<A NAME="annotate_size"></A>
<H3>Automatically Sized Annotated Text Canvases</H3>

Often you need much more control than what "<CODE><A HREF="#label"
>label:</A></CODE>" can provide.  For example you want to use a tile or
gradient image, requiring you to <A HREF="#annotate" >Annotate</A> the text.
Unfortunately you then need to know in advance the size of the canvas you need
for your <A HREF="#annotate" >Annotated Text</A>. </P>

Here is a typical example of the problem.  When I first set up this command I
set my size to the results I wanted, and at first it worked quite well.
But then I got this...

<DIV ALIGN=center>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="90%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  magick -size 480x80   gradient:yellow-green \
          -font ArialBkI -pointsize 70 -tile gradient:blue-red \
          -annotate +10+65 'Gradient Fun'    funfont_gradients.jpg
</samp></pre></TD></TR></TABLE>
 <A HREF="funfont_gradients.jpg"
    ><IMG SRC="funfont_gradients.jpg"
          ALIGN=middle VSPACE=5 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</DIV>

Unfortunately when guessing at the canvas size I had miss-spelt the word
'<CODE>Gradient</CODE>' in that above (missing the letter '<CODE>i</CODE>').
Of course when I fixed that spelling, my image size was now wrong, producing
incorrect result shown above. </P>

What we need is to be able to use the "<CODE><A
HREF="../option_link.cgi?annotate" >-annotate</A></CODE>" operator, but with
the canvas sized to fit the <A HREF="#annotate" >Annotated Text</A>.   </P>

One solution is to use a much larger canvas, then  "<CODE><A
HREF="../crop/#trim" >Trim</A></CODE>" the background to the right size.  I
also added a "<CODE><A HREF="../crop/#border" >Border</A></CODE>" to add a
little extra space around the font and the final edge of the image, for a
better look.

<DIV ALIGN=center>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="90%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  magick -size 800x120 xc:black -font Corsiva -pointsize 100 \
          -tile tile_disks.jpg   -annotate +20+80 'Psychedelic!' \
          -trim +repage  -bordercolor black  -border 10   funfont_groovy.jpg
</samp></pre></TD></TR></TABLE>
  <A HREF="funfont_groovy.jpg"
     ><IMG SRC="funfont_groovy.jpg"
           ALIGN=middle VSPACE=5 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</DIV></P>

This method is much better than trying to make a guess at just how big your
final image should be, however "<CODE><A HREF="../crop/#trim" >Canvas
Trim</A></CODE>", will not trim a tiled multi-colored background. </P>

The better solution is to create the canvas using "<CODE><A HREF="#label"
>label:</A></CODE>", to generate the canvas of the right size.  A <A
HREF="../draw/#color" >Draw Color Fill</A> is then used to tile an image over
the canvas (and the label text), and finally we <A HREF="#annotate"
>Annotate</A> our text using another tiling image.

<DIV ALIGN=center>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="90%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  magick -font Ravie -pointsize 72  label:'Get Wet!' -border 10 \
          -tile tile_aqua.jpg   -draw "color 0,0 reset"  \
          -tile tile_water.jpg -gravity center -annotate +0+0 'Get Wet!' \
          autosize_wet.jpg
</samp></pre></TD></TR></TABLE>
  <A HREF="autosize_wet.jpg"
     ><IMG SRC="autosize_wet.jpg"
           ALIGN=middle VSPACE=5 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</DIV>

<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH=90% ALIGN=center>
<TR valign="top">
<TD><IMG SRC="../img_www/reminder.gif" WIDTH=20 HEIGHT=16
    ><IMG SRC="../img_www/space.gif"   WIDTH=20 HEIGHT=16></TD>
<TD ALIGN=justify width="100%"><FONT SIZE=-1><I>
  Note that position of the text in a centered "<CODE><A HREF="#label"
  >label:</A></CODE>" image may not exactly match the position of a centered
  "<CODE><A HREF="../option_link.cgi?annotate" >-annotate</A></CODE>"
  operation.  The two methods follow completely different processing
  algorithms, and as such may not match. Especially when unusual fonts are
  involved.
</I></FONT></TD></TR></TABLE></P>


<A NAME="autosize_box"></A>
<H3>Auto Sized using 'Undercolor Box'</H3>

Rather than using a "<CODE><A HREF="#label" >label:</A></CODE>" image, you can
draw the font on a large canvas using an <A HREF="#undercolor" >Undercolor
Box</A> and a <A HREF="../draw/#stroke" >large stroke width</A>, before
trimming the canvas to fit.  </P>

For example
<DIV ALIGN=center>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="90%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  magick -size 500x100 xc:lightblue -font SheerBeauty -pointsize 72 \
     -gravity center -undercolor white -stroke none -strokewidth 3 \
     -annotate +0+0 ' Invitation ' -trim +repage -shave 1x1 \
     invitation_box.jpg
</samp></pre></TD></TR></TABLE>
  <A HREF="invitation_box.jpg"
     ><IMG SRC="invitation_box.jpg"
           ALIGN=middle VSPACE=5 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</DIV>

The amount of space around the font can be adjusted using the "<CODE><A
HREF="../option_link.cgi?strokewidth" >-strokewidth</A></CODE>" setting.  The
only important requirement is that the initial canvas be a color different to
the background color, ('<CODE>lightblue</CODE>' in this case) and is
larger than the final result.  </P>

Just a word of warning, some fonts draw characters well outside the individual
character drawing area. (For example see <A HREF="#undercolor" >Undercolor
Box</A> above).  In this case the above result will work, but may require you
to use a transparent canvas, and then overlay the result over white (using an
operation like "<CODE>-background white -flatten</CODE>" for example), to
magick the unused and still transparent areas to white.  However that
character will likely be touching an edge of the resulting image.  Basically
you can't really win, in all situations, just try your best. </P>

<A NAME="coloring_text"></A>
<H3>Coloring a Gray-scale Text Image</H3>

I purposefully generated the above image as a grey-scale black and white image,
as this can be used as a masking template.  From a pure image like this you
can then color the background and the foreground of image either separately
or both at the same time. </P>

Here for example I use the <A HREF="../color_mods/#level-colors" >Level by
Colors Operator</A>, "<CODE><A HREF="../option_link.cgi?level-color"
>+level-color</A></CODE>", to globally modify the image colors so as to assign
the foreground and background colors with specific values.

<DIV ALIGN=center>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="90%" bgcolor="#f8f8f8">
<TR><TD><PRE><CODE EXECUTE RANDOM>
  magick invitation_box.jpg -colorspace sRGB \
          +level-colors navy,lightblue invitation_colored.jpg
</samp></pre></TD></TR></TABLE>
  <A HREF="invitation_colored.jpg"
     ><IMG SRC="invitation_colored.jpg"
           ALIGN=middle VSPACE=5 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</DIV> </P>

For example here I use <A HREF="../compose/#mask" >Composite Masking</A>
to replace background and foreground with pattern images.

<DIV ALIGN=center>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="90%" bgcolor="#f8f8f8">
<TR><TD><PRE><CODE EXECUTE RANDOM>
  magick invitation_box.jpg -colorspace sRGB \
          \( +clone -size 300x150 -tile gradient:LightYellow \
                                             -draw "color 0,0 reset" \) \
          \( +clone -size 300x150 -tile plasma:tomato \
                                             -draw "color 0,0 reset" \) \
          -reverse  -composite      invitation_rose.jpg
</samp></pre></TD></TR></TABLE>
  <A HREF="invitation_rose.jpg"
     ><IMG SRC="invitation_rose.jpg"
           ALIGN=middle VSPACE=5 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</DIV></P>

The <A HREF="../basics/#reverse" >Reverse Operator</A> in the above is used to
reorder the images, so the first image becomes the third 'masking' image of
the composition.  The foreground ("<CODE>plasma:</CODE>") image then becomes
first, and the background in the middle. </P>

For other techniques of coloring a gray-scale image like this, see <A
HREF="../compose/#mask" >Using a Mask to Limit the Composed Area</A>. And more
generally <A HREF="../masking/#masks" >Using Masks with Images</A>. </P>

For other methods of generating gradients for tiling see <A
HREF="../canvas/#gradient" >Gradients of Color</A>, <A
HREF="../canvas/#sparse-color" >Sparse Points of Color</A>, and <A
HREF="../canvas/#plasma" >Randomized Canvases</A>. </P>

<HR><!-- ---------------------------------------------------------------- -->


<A NAME="font"></A>
<H2>Fonts</H2>

<DIV ALIGN=center><FONT SIZE=+2><B>
<IMG SRC="../img_www/const_barrier.gif" WIDTH=39 HEIGHT=35 ALIGN=top>
Under Construction
<IMG SRC="../img_www/const_hole.gif" WIDTH=144 HEIGHT=50 ALIGN=middle>
</B></FONT></DIV></P>

<PRE>

As for ordering the font paths, that is simply ordering the fonts specified in
the XML files.

The start point is the system fonts, followed by the system installed
"type.xml" file, on my system this is "/etc/ImageMagick-6/type.xml".

This system installed "type.xml" file is typically just a list of 'include'
other type-* files.  And the order of the includes will specify the order of
Extra System Fonts, verses Ghostscript Fonts.

After that file other "type.xml" files are looked for, such as in 'home'
directories, or even current directory.

Later fonts will NOT replace earlier fonts, as such if two fonts have that
same name, only the first one will be noted by IM. (a security measure).

To see the fonts loaded use
    magick -list font

It lists "Path:" of the type file each font list was found in, but the
paths are listed in REVERSE order, with system fonts at the end.

I have for example a personal Font named "Courier", but it is not listed in
the above list as it was defined after the "Courier" that was found in the
"System Fonts" area, (which is listed at the end of the above output).

On the other hand my own personal font "CourierNew", is listed, as it does not
clash with any system or system config defined font.

To see what font glyph file is selected for soem specific request
use...
  magick -debug annotate xc: -font Courier \
          -annotate 0 'Test' null: 2>&1 |
    grep '^ *Font '
</PRE>


<A NAME="font_info"></A>
<H2>Determining Font Metrics,
<FONT SIZE=-1>without using an API</FONT></H2>

<IMG SRC="../img_diagrams/glyph_metrics.gif"   WIDTH=388 HEIGHT=253
     ALIGN=right VSPACE=0 HSPACE=0 ALT="[diagram]"></A>

A particular font and its individual characters contain a lot of information.
Such information can be very useful to have, especially if you are wanting to
use IM for piecing together the text of many different fonts. </P>

It is also important to remember that most fonts are proportional fonts,
meaning that each individual character will have a different width, and
a different 'natural' advance of the caret (or origin).  As such each specific
'string' of characters will be rendered (drawn) a different length without any
real regard to the actual number of characters used in the string. </P>

The exception to this are 'Fixed-Width' fonts, such as "<CODE>Courier</CODE>",
"<CODE>Typewriter</CODE>", or "<CODE>Terminal</CODE>" fonts, in which all
characters have the same width, allowing you to generate columns of text
easily. </P>

The <A HREF="../basics/#debug" >Debugging Setting</A> "<CODE><A
HREF="../option_link.cgi?debug" >-debug</A> annotate</CODE>" can be used to
get IM to directly report a TTF font's metrics, for a specific string.  For
example...

<DIV ALIGN=center>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="90%" bgcolor="#f8f8f8">
<TR><TD><PRE><CODE EXECUTE NOIMAGE OUT=font_metrics.txt>
  magick -debug annotate  xc: -font Candice -pointsize 24 \
          -annotate 0 'Test' null: 2>&1 |\
    grep Metrics: | fmt -w80
</samp></pre></TD></TR></TABLE>
<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=5 width="90%" bgcolor="#f8f8f8">
<TR><TD>
  <A HREF="font_metrics.txt"
     ><IMG SRC="font_metrics.txt.gif"
           ALIGN=middle VSPACE=0 HSPACE=0 BORDER=0 ALT="[IM Text]"></A>
</TD></TR></TABLE>
</DIV></P>

As you can see you get a mixed bag of information you can use: from the
declared bounds of the drawn string (which is not nessarilly the strings
actual bounds), relative to the origin; to the amount the 'carat' (origin)
should advance before drawing the next string. </P>

The full debug output (which is rather verbose, and not shown in the above)
also reports the actual font file used (twice) so you can also use it to check
that you have the right font too. </P>

<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH=90% ALIGN=center>
<TR valign="top">
<TD><IMG SRC="../img_www/warning.gif"  WIDTH=28 HEIGHT=28
    ><IMG SRC="../img_www/space.gif"   WIDTH=12 HEIGHT=16></TD>
<TD ALIGN=justify width="100%"><FONT SIZE=-1><I>
  The "<CODE><A HREF="../option_link.cgi?debug" >-debug</A>
  annotate</CODE>" method was added to IM v6.3.9-2
</I></FONT></TD></TR></TABLE></P>

<BR>

<H3>Older techniques</H3>

This debug output however may not be convenient, or you may have to handle
IM's that are older than this version.   The following are older examples
where the text is actually drawn in various ways and colors, and then
information (as integers) extracted from the resulting image. </P>

For example lets find out the dimensions of the '<CODE>Ravie</CODE>' font
relative to a fixed baseline, at 72 point. </P>

<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 width="100%">
<TR VALIGN=bottom><TD width="100%" ALIGN=justify>

Here is the image we will be studying, as a reference.  You don't actually
need to drawn and save it as an image, as we are only extracting data, not an
image.  the colors of this image will be modified so we can look at the white
and black parts separately using "<CODE><A HREF="../option_link.cgi?trim"
>-trim</A></CODE>" to extract the metrics used.

<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="100%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  magick -size 100x150 xc:lightblue -font Ravie -pointsize 72 \
          -fill black -undercolor white  -annotate +20+100 'A' font_drawn.gif
</samp></pre></TD></TR></TABLE></TD><TD>
  <A HREF="font_drawn.gif"
     ><IMG SRC="font_drawn.gif"
           ALIGN=middle VSPACE=0 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</TD></TR></TABLE></P>

For the basic basic font metrics, we first draw the font itself with a
transparent color ('<CODE>None</CODE>'), so that we can measure find the size
and location of the bounding box or drawing area of this specific character,
for this font.  Note that for height information you can just draw anything.

<DIV ALIGN=center>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="90%" bgcolor="#f8f8f8">
<TR><TD><PRE><CODE EXECUTE OUT=font_boxinfo.txt>
  magick -size 100x150 xc:lightblue -font Ravie -pointsize 72 \
          -fill none -undercolor white  -annotate +20+100 'A' -trim  info:
</samp></pre></TD></TR></TABLE>
<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=5 width="90%" bgcolor="#f8f8f8">
<TR><TD>
  <A HREF="font_boxinfo.txt"
     ><IMG SRC="font_boxinfo.txt.gif"
           ALIGN=middle VSPACE=0 HSPACE=0 BORDER=0 ALT="[IM Text]"></A>
</TD></TR></TABLE>
</DIV></P>

From the results above we can see that a '<CODE>Ravie</CODE>' font at 72
points, will have a total bounding box height of 74 pixels. The top of the box
is 42 pixels from the top of the image, as the baseline which was positioned
at a 100 pixels y coordinate, the box starts is  100 - 42 or 58 pixels above
the baseline.  That leaves 74 - 58 or 16 pixels for the bounding box below the
baseline for the descenders.   </P>

<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH=90% ALIGN=center> <TR
       valign="top">
<TD><IMG SRC="../img_www/expert.gif"   WIDTH=23 HEIGHT=26 ><IMG
    SRC="../img_www/space.gif"   WIDTH=17 HEIGHT=16></TD> <TD ALIGN=justify
    width="100%"><FONT SIZE=-1><I> Note that not all fonts limit their drawing
    to within their defined drawing bounding box! However some letters can
    extend far outside those boundaries.  That is why the above example sets
    a "<CODE><A HREF="../option_link.cgi?fill" >-fill</A></CODE>" color of
    '<CODE>none</CODE>'. That way ill behaved fonts will not effect the above
    measurements.
</I></FONT></TD></TR></TABLE></P>

Also note that the distance separating lines (baselines actually) should be
purely determined by the point size of the font, and has nothing to do with how
the font is drawn. In out example, as the font has a point size of 72 points,
and a point is defined as 1/72th of an inch, then the baselines should be 1
inch apart.  With a current output resolution (density) of 72 pixels per inch,
that means the baselines will be 72 pixels apart. </P>

Interestingly enough that means that for this font, with a 74 pixel bounding
box, the font has a two pixel overlap for the drawing area between the
lines of properly single spaced text! </P>

Also from the above measurements we can see that in drawing the string
"<CODE>A</CODE>" in this font at this point size, the next character should be
drawn 66 pixels to the right of the starting point (known as the caret).  This
is the strings 'logical' length.

That is the 'caret' or start point for the next character should start at 20 +
66, or at '<CODE>+86+100</CODE>' (the baseline does not change vertically). Be
warned that some Arabic fonts can in fact draw right to left, so the 'caret'
offset will be negative. </P>

That gives use the font metrics for the character 'A' but what about physical
dimensions of drawn 'A' relative to the 'caret' or start point.  Well just
swap the two color settings...

<DIV ALIGN=center>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="90%" bgcolor="#f8f8f8">
<TR><TD><PRE><CODE EXECUTE OUT=font_drawn.txt>
  magick -size 100x150 xc:lightblue -font Ravie -pointsize 72 \
          -fill black -undercolor none  -annotate +20+100 'A'  -trim   info:
</samp></pre></TD></TR></TABLE>
<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=5 width="90%" bgcolor="#f8f8f8">
<TR><TD>
  <A HREF="font_drawn.txt"
     ><IMG SRC="font_drawn.txt.gif"
           ALIGN=middle VSPACE=0 HSPACE=0 BORDER=0 ALT="[IM Text]"></A>
</TD></TR></TABLE>
</DIV></P>

Height-wise the character was within its defined drawing boundaries, with its
height going from 100 - 43 or 57 pixels above the baseline (hard against its
bounding box) to 60 - 57 or only 3 pixels below the fonts baseline.  In other
words this letter does not have a 'descender' drawn in area below the baseline.
</P>

From this we can see that the 'A' draws from 3 pixels <I>before</I> the caret
(positioned at +20, but final image is at +17), to 70 - 3 or 67 pixels after
the caret position.  In other words this font is slightly wider than its
horizontal bonding box, when drawn. </P>

Note that while this gives you the actual drawn string length, this is
different to the caret offset needed when appending text, (which is defined by
the strings bounding box, and not its drawn length).   In other words text
should be appended together using their bounding boxes, and not their actual
drawn length size as we have do in other examples. </P>

Of course if you get a very ill-behaved font, you may like to check how far a
specific string draws beyond its bounds so that you can still provide space
for it, say at the end of a line. </P>

<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH=90% ALIGN=center>
<TR valign="top">
<TD><IMG SRC="../img_www/expert.gif"   WIDTH=23 HEIGHT=26
    ><IMG SRC="../img_www/space.gif"   WIDTH=17 HEIGHT=16></TD>
<TD ALIGN=justify width="100%"><FONT SIZE=-1><I>
  The dimensions extracted from a font will also vary with the current
  "<CODE><A HREF="../option_link.cgi?strokewidth" >-strokewidth</A></CODE>"
  used for drawing the font.  If you increase the size of the outline
  stroke, then the dimensions (and bounding box size) needed to draw the
  font is also expanded by the same amount to accommodate the thicker outline.
</I></FONT></TD></TR></TABLE></P>

<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH=90% ALIGN=center>
<TR valign="top">
<TD><IMG SRC="../img_www/expert.gif"   WIDTH=23 HEIGHT=26
    ><IMG SRC="../img_www/space.gif"   WIDTH=17 HEIGHT=16></TD>
<TD ALIGN=justify width="100%"><FONT SIZE=-1><I>
  Dimensions also vary with the operating system, (type and version) and the
  version of the delegate font drawing library IM is using on that system,
  even when the exact same font library and IM version has not changed.
  Caution is recommended when different computers could be used for text
  drawing, as results can vary even for the same font.
</I></FONT></TD></TR></TABLE></P>

For more information see the document <A
HREF="http://www.microsoft.com/typography/otspec/TTCH01.htm" >TrueType
Fundamentals (PDF)</A>.  This shows that even my generalizations above may not
always hold true, though is generally the case. </P>

Note the above examples will only return dimensions in whole pixels, where all
the dimensions used by fonts are floating point numbers. In fact whether a
font is even drawn from a whole pixel (caret) starting point, can be
application dependant, and effect the resulting look of the font. </P>

<HR><!-- ------------------------------------------------------------------ -->

<A NAME="mixed_font_lines"></A>
<H2>Creating Lines of Mixed Font Styles</H2>

Creating a single line using multiple fonts, point sizes, and styles is not
something IM is really designed to do.  It gets even worse when you also start
to consider things like text justification, word wrapping, and wrapping around
images and other things. </P>

This is the sort of thing that programs like Word Processors, Web Browsers,
Document Printers do very well, usually under user interaction, but few can do
so well under program control. </P>

One exception to this is "<CODE>TeX</CODE>", and its family of programs (see
<A HREF="#tex" >A Complete Text Processing System</A> below), so if you are
serious about processing text graphically, I suggest you look at this program
family.  </P>

Another alternative is to look at various document 'pretty' printing programs
such as a HTML converter. You can use these to magick program generated
documents into postscript which IM can then happily post-process into whatever
image format or style you want. </P>

An API solution (using the C MagickWand API interface) has been created by "El
Supremo" (from the IM discussion forums) in his <A
HREF="http://members.shaw.ca/el.supremo/MagickWand/fontmetrics.htm"
>FontMetrics</A> program. and here is <A
HREF="http://members.shaw.ca/el.supremo/MagickWand/metric1.htm" >Example
Output of "FontMetrics"</A>. </P>

<BR>

Now while IM command-line is not designed for 'word processing', it does not
mean you can't use it for such.  It is just more difficult.  Here I will give
some examples of mixing text in different fonts and styles, to give people
a starting point.  </P>

The simplest solution people usually think of is to just append "<CODE><A
HREF="../fonts/#label" >label:</A></CODE>" images together...

<DIV ALIGN=center>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="90%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  magick -font LokiCola     -pointsize 36  label:'LokiCola ' \
          -font Candice      -pointsize 24  label:'Candice ' \
          -font SheerBeauty  -pointsize 48  label:'SheerBeauty' \
          +append   wp_label_append.jpg
</samp></pre></TD></TR></TABLE>
  <A HREF="wp_label_append.jpg"
     ><IMG SRC="wp_label_append.jpg"
           ALIGN=middle VSPACE=5 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</DIV></P>

However as you can see all the images are vertically aligned to the top of the
image, and unless you use similar fonts, will not look very good. </P>

Alternatively, you can use an append justification trick to align them along the
bottom.

<DIV ALIGN=center>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="90%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  magick -size 1x50 xc:none +size \
          \( -background white -font LokiCola -pointsize 36 \
             label:'LokiCola ' \
             -clone 0 +swap  -background none -append \) \
          \( -background white -font Candice  -pointsize 24 \
             label:'Candice ' \
             -clone 0 +swap  -background none -append \) \
          \( -background white -font SheerBeauty  -pointsize 48 \
             label:'SheerBeauty' \
             -clone 0 +swap  -background none -append \) \
          -delete 0   -gravity South -crop 0x50+0+0   +append \
          -bordercolor none  -border 1 -trim  +repage \
          -background white -flatten    wp_label_bottom.jpg
</samp></pre></TD></TR></TABLE>
  <A HREF="wp_label_bottom.jpg"
     ><IMG SRC="wp_label_bottom.jpg"
           ALIGN=middle VSPACE=5 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</DIV></P>

What this did was to add some extra padding to the top of each label, and
cropping them all to the same height before appending them horizontally.
After that a simple "<CODE><A HREF="../option_link.cgi?trim"
>-trim</A></CODE>" and a "<CODE><A HREF="../option_link.cgi?flatten"
>-flatten</A></CODE>" was used to set the height of the line to the highest
label, and fill in the background. </P>

As you can see this produces a better job, but a small font tends to produce
subscript like behaviour, rather than properly aligned text. </P>

What we really need to do is align all the text strings by their 'baselines'
and that is very difficult without access to more textual information.  This
information is easily obtainable under a program API, but much more difficult
from the command line. One method is shown in the previous example section. </P>

However it is possible to align words by their baseline without actually
collecting baseline information.  While "<CODE><A HREF="../fonts/#label"
>label:</A></CODE>" text images do not provide any clue as to the images
baseline, you can specifically draw images at a fixed baseline. </P>

Without an API you also can not directly find out how long or high drawn text
is, so you first need  to use a canvas that is large enough to ensure that we
don't loose any information about text image. Then to preserve trailing spaces
and text height you also have to make good use of the ("<CODE><A
HREF="../option_link.cgi?undercolor" >-undercolor</A></CODE>") feature
available to text annotation and provide a boundary for image trimming. </P>

So lets see how you can do it from the command line.

<DIV ALIGN=center>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="90%" bgcolor="#f8f8f8">
<TR><TD><pre class="bg-light text-dark mx-4"><samp>
  magick -size 500x100 xc:none  -fill blue  -draw 'line 15,0 15,99' \
          -undercolor white -fill black \
          \( -clone 0   -font LokiCola    -pointsize 36 \
             -annotate +5+60 'Loki Cola ' \) \
          \( -clone 0   -font Candice     -pointsize 24 \
             -annotate +5+60 'Candice ' \) \
          \( -clone 0   -font SheerBeauty -pointsize 48 \
             -annotate +5+60 'Sheer Beauty' \) \
          -delete 0 -trim +repage  +append \
          -transparent blue  -trim +repage \
          -background white -flatten   wp_draw_baseline.jpg
</samp></pre></TD></TR></TABLE>
  <A HREF="wp_draw_baseline.jpg"
     ><IMG SRC="wp_draw_baseline.jpg"
           ALIGN=middle VSPACE=5 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</DIV></P>

As before the trimming of the images is done in two steps. </P>

First draw the text on a base image which contains a vertical blue line.  Thus
when we trim the text, only the width of the text image will be trimmed,
leaving all the words at the same baseline height. </P>

After appending them together, we can now remove the blue construction line by
making it fully-transparent. If you are generating just a black and white
image, the better way would be to just extract one of the non-blue channels
instead, which ensures you really do get all of the construction line. A
second trim will then trim the top and bottom sections, shrinking it to the
largest bounding box. </P>

A final flatten to the same color as the as the bounding box then removes all
evidence of its use in constructing the line. </P>

As you can see all the text is now properly baseline aligned, regardless of
the font or the pointsize used. </P>

Of course in these examples I only used black on white text.  Other colors can
be used, as long at they don't interfere with the construction line and
transparent background used for text alignment. </P>

With this technique you can now generate mixed font text lines, and vertically
append them all together into a larger document. </P>

You can also see that doing all this is a lot of work, work that is normally
hidden from the user by word processors and web browsers.  If you do plan to
do a lot of this sort of stuff, I do suggest you look into the alternatives I
previously mentioned. </P>


<HR><!-- ---------------------------------------------------------------- -->

<A NAME="form_filling"></A>
<H2>Form Filling</H2>

You have an image of some standard fill in form and you want to fill in the
fields which are in well known positions.

So you have a data file such as "<CODE><A HREF="../images/text_data.txt"
>text_data.txt</A></CODE>" shown here...

<!-- <CODE EXECUTE>txt2gif text_data.txt</CODE> -->
<DIV ALIGN=center>
<TABLE BORDER=0 CELLSPACING=0 CELLPADDING=5 width="90%" bgcolor="#f8f8f8">
<TR><TD>
  <A HREF="../images/text_data.txt"
    ><IMG SRC="text_data.txt.gif"
          ALIGN=middle VSPACE=0 HSPACE=0 BORDER=0 ALT="[IM Text]"></A>
</TD></TR></TABLE>
</DIV></P>
The fields are text width, gravity (justification), color, position x, y
and the actual text to place for this field. </P>

Now you can use a simple looped shell script to generate a text label as
described by the above, assigning the appropriate text in the defined text
positions in a form (background) image.

<DIV ALIGN=center>
<table class="table table-sm table-hover" CELLSPACING=0 CELLPADDING=5 width="90%" bgcolor="#f8f8f8">
<TR><TD><PRE><CODE EXECUTE SCRIPT IMAGE=text_layered.jpg >
  cat text_data.txt |
  while read width gravity color  pointsize x y text
  do
    magick -size ${width}x -gravity $gravity -fill $color -background wheat \
                -pointsize $pointsize  -page +${x}+${y}  label:"${text}"  miff:-
  done |
    magick -size 200x100 xc:   -   -flatten    text_layered.jpg
</samp></pre></TD></TR></TABLE>
  <A HREF="text_layered.jpg"
     ><IMG SRC="text_layered.jpg"
           ALIGN=middle VSPACE=5 HSPACE=5 BORDER=1 ALT="[IM Output]"></A>
</DIV></P>

The 'form image' in this case is just a blank image, but really could be
anything.  I also set the background color of the labels to 'wheat' so the
area filled in is visible, but you would normally set this to none. </P>

The above does not use temporary files, but instead uses a pipeline of <A
HREF="../files/#miff" >MIFF</A> format images. This is an example of using
a <A HREF="../files/#miff_stream" >Image Streaming Format</A>, in which
individual images are simply appended together, on after the other in a file or
pipeline. </P>

This is only a starting point.  The form fields can come from some definition
file, while the text to fill in from a database or other data source. Other
attributes can also be set such as the font to use, text rotations and so on.
You could also include both width and height, or if the text should be
word-wrapped using <A HREF="#caption" >Caption</A> should be used rather than
a <A HREF="#label" >Label</A>. </P>

See also <A HREF="../layers/#layer_pins" >Pins in a Map</A> for
another example of this technique, much like the above. </P>

<HR><!-- ---------------------------------------------------------------- -->

<A NAME="tex"></A>
<H2>Text Processing Alternatives</H2>

The ideal way of generating fully formatted text files and documents is
to use ImageMagick as part of a larger image and text processing system.
</P>

<TABLE>
<TR><TD><B>Tool</B><TD><B>used for...</B>
<TR><TD>ImageMagick&nbsp;&nbsp;&nbsp;
                  <TD> Image batch processing and preparations
<TR><TD>Gimp      <TD> GUI image editing for one off problem fixing
<TR><TD>&nbsp;
<TR><TD>LyX       <TD> GUI word processing, built to generate...
<TR><TD>LaTeX     <TD> Text processor for documents, and books...
<TR><TD><A HREF="http://en.wikipedia.org/wiki/TeX" >TeX</A>
                  <TD> Underlying Text format
                  <BR> (positions symbols and fonts on pages)
<TR><TD>Metafont  <TD> TeX Font generator
</TABLE></P>

Basically ImageMagick can do a lot of things, that does not mean it is the
best tool for those things.  For larger document preparations you are better
off treating it as only one part of a larger whole. </P>

The various 'TeX' tools given above are usually a standard install for most
Linux systems, and can combine text and images into an unified whole.  More
importantly it keeps text as text, and formats the text appropriately, as
you specify, doing almost all the hard work of word and page wrapping, and
arrangement with the images. But without filling a 'doc' file with useless
formatting garbage.  You have full control, or can leave it to make the
decisions. </P>

They provides a way of generating any type of document, from a simple page,
newsletter or even a full book If you are serious about document generation,
then these tools are well worth looking at and learning. </P>

<BR>

Pango (Linux and MacOSX only) also provides an alternative. It provides many
text to image processing features not available in ImageMagick. For example
TABs, justification, margins, headers, and so on. It even has a markup language
of some kind to allow font changes in the middle of text. </P>

<BR>

Other solutions also include the many text to postscript conversion programs,
such as "a2ps" which I demonstrate in generating an example postscript file in
<A HREF="#postscript" >Postscript Handling</A> above.  This converts and
formats may different types of text files, with word wrapping, bolding and tab
control, as well as a reasonably nice header, footer, border, and multi-page
options. Of course this is indirect image processing via a <A
HREF="../format/#ps" >Postscript or PDF</A> intermediate language. </P>

Another is to layout the text using SVG, or the ImageMagick <A
HREF="../draw/#draw" >Drawing Command</A>, though you will then need to deal
with the layout.

There are lots of tools out there to magick text into images, and most can be
combined with ImageMagick to post-process the text image and merge it into
your image.  This lets ImageMagick get on with what it does best, image
processing. </P>

</DIV></P>
<HR><!-- ---------------------------------------------------------------- -->
</div></main><footer class="magick-footer"><div class="container-fluid">
Created: 25 October 2005 (separated from 'fonts' page) <BR>
Updated: 26 October 2011 <BR>
Author: <A HREF="https://antofthy.gitlab.io/anthony.html"
        >Anthony Thyssen</A>, &lt;Anthony.Thyssen&#64;gmail.com&gt;<BR>
Examples Generated with:
        <IMG SRC="version.gif" ALIGN=absmiddle ALT="[version image]"><BR>
URL: <CODE>https://imagemagick.org/Usage/text/</CODE>
</div></footer></body></HTML>
